try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d07130fd-29fe-481f-a9e6-f257e4bb3686",e._sentryDebugIdIdentifier="sentry-dbid-d07130fd-29fe-481f-a9e6-f257e4bb3686")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2550],{32550:(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var n=r(6029),a=r(80411),l=r(86747),i=r(69702),o=r(4765),s=r(67549),u=r(81278),d=r(6772),c=r.n(d),m=r(55729),f=r(58578),b=r(29512),p=r(44356),g=r(86603),h=r(10471),v=r(96233),y=r(76959);let x=e=>{let{path:t,onSubmit:r,fontFamily:a,value:i,onChange:o,errorMessage:u,onBlur:d}=e,c=(0,h.qM)(),m=(0,s.md)(v.F.stageDimensions).layout===l.ViewerLayout.MobileExpanded,f="single-select"===t.variant?(0,n.jsx)(y.A,{checked:i===t.buttonText,className:"pointer-events-none w-[1.5em] h-[1.5em]",onChange:()=>null}):"multi-select"===t.variant?(0,n.jsx)("input",{type:"checkbox",checked:!!(t.buttonText&&i.includes(t.buttonText))}):null;return(0,n.jsx)(g.A,{isDark:!1,flow:c,textAreaClassName:"text-left font-normal min-h-[1.5em] items-center",parentClassName:(0,p.cn)("shadow-input items-center hover:!bg-white/90 focus-within:!bg-white/90 focus-within:shadow-inputHover",f?"flex items-center justify-center gap-[0.625em] pointer group/input":"",m?"w-full":"w-[20em]"),buttonStyle:{color:"#111827",backgroundColor:"#fff",fontFamily:a},placeholder:t.required?"".concat(t.buttonText,"*"):t.buttonText,value:"single-select"===t.variant?t.buttonText:i,onSubmit:r,onChange:e=>o(e.target.value),isViewer:!0,disabled:!!f,onBlur:d,onClick:e=>{e.preventDefault(),"single-select"===t.variant&&o(t.buttonText)},children:e=>{let{children:r}=e;return(0,n.jsxs)(n.Fragment,{children:["single-select"===t.variant?(0,n.jsxs)(n.Fragment,{children:[f,(0,n.jsx)("div",{className:(0,p.cn)("font-normal outline-none bg-transparent border-0 border-transparent ring-0 p-0 resize-none focus:ring-0 flex w-full min-h-[1.5em] items-center",{"text-center":!f}),children:t.buttonText})]}):r,!f&&u&&(0,n.jsx)("div",{className:"flex mt-[1em] p-[1em] bg-critical-surface rounded-[0.375em] justify-start items-center text-critical-action text-[0.75em] font-normal",children:u})]})}})};var w=r(89734),C=r(6625),j=r(15631),k=r(82092),T=r(2631),I=r(29911),N=r(31078),S=r(56760);function P(e){let{targetRef:t,children:r}=e,[n,a]=(0,m.useState)(!1);return(0,m.useEffect)(()=>a(!0),[]),n&&t.current?(0,S.createPortal)(r,t.current):null}let A={email:"Please provide a valid email address.",required:"Please provide your answer.",number:"Please provide a valid number.",date:"Please provide a valid date.",phone:"Please provide a valid phone number.",text:null,hidden:null,"multi-select":null,"single-select":null},D="There was an error submitting the form.",O=(0,I.A)(),E=e=>{let{step:t,isSmallScreenOrTile:r,onButtonClick:d,onOverlayUrlClick:p,navigationElementWithSound:g,enterNavigationElement:y,leaveNavigationElement:C,previewContext:I,isActive:S,formFieldsPortal:E,mediaIsPlaying:_,percentComplete:F}=e,L=(0,h.qM)(),V=(0,T.A)(),B=(0,u.useRouter)(),M=(0,s.md)(v.F.stageDimensions).layout===l.ViewerLayout.MobileExpanded,{customValues:q,fontFamily:R}=(0,m.useContext)(j.c),{formFields:z}=t,W=(z||[]).filter(w.H).filter(e=>{let{fieldLabel:t}=e;return!!t}),H=W.filter(e=>{let{variant:t}=e;return"hidden"!==t}),J=(null==z?void 0:z.filter(w.N))||[],[U,K]=(0,s.fp)(v.F.viewerFormResponses),Q=(0,m.useRef)(U[t.id]||void 0);Q.current||(Q.current=(z||[]).filter(w.H).reduce((e,t)=>({...e,[t.fieldLabel]:"hidden"===t.variant?t.buttonText:""}),{}));let[G,X]=(0,m.useState)({data:Q.current,isDirty:!1,isSubmitted:!1}),[Y,Z]=(0,m.useState)({}),$=H.reduce((e,t)=>{var r;let{fieldLabel:n,required:a,variant:l}=t,i=null==(r=G.data[n])?void 0:r.trim();return i?("email"!==l||N.z.string().email().safeParse(i).success)&&("number"!==l||N.z.coerce.number().safeParse(i).success)?e:{...e,[n]:A[l]}:a?{...e,[n]:A[l]||A.required}:e},{}),ee=0===Object.keys($).length,et=e=>async r=>{if(X(e=>({...e,isSubmitted:!0})),ee){if(G.isDirty){let e=H.find(e=>{let{variant:t}=e;return"email"===t}),r=e&&G.data[e.fieldLabel];r&&V.setUser(O,r),V.report("Form Answered",{stepId:t.id,flowId:L.id});let n=(()=>{if(window._doNotTrack)return{anonymousId:"",userId:""};let e=localStorage.getItem("ajs_anonymous_id"),t=localStorage.getItem("ajs_user_id");return{anonymousId:e?JSON.parse(e):void 0,userId:t?JSON.parse(t):void 0}})(),a=W.filter(e=>{let{variant:t}=e;return"hidden"===t}).reduce((e,t)=>{let{fieldLabel:r,buttonText:n}=t;return{...e,[r]:{variant:"hidden",value:n}}},{}),l=H.reduce((e,t)=>{let{fieldLabel:r,variant:n}=t;return{...e,[r]:{variant:n,value:G.data[r]||""}}},{}),i=(0,k.R3)(B.query);try{let e=await fetch("/api/viewer/form",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPreview:(0,k.cl)(I),sessionId:V.getSessionId()||O,anonymousId:n.anonymousId,viewerIp:window._doNotTrack?null:void 0,createdBy:n.userId||"anonymous",teamId:L.teamId,flowId:L.id,flowName:L.name,flowCreatedBy:L.createdBy,stepTitle:t.title,stepSubtitle:t.subtitle,answers:{...a,...l},...i})});if(!e.ok){let t=400===e.status?await e.json():null;f.Ay.error((null==t?void 0:t.error)||D);return}}catch(e){(0,o.Cp)(e),f.Ay.error(D);return}f.Ay.success("Thanks for filling out our form!"),K(e=>({...e,[t.id]:G.data}))}return null==e?void 0:e(r)}},[er,en]=(0,m.useState)(!1),ea=H.some(e=>"email"===e.variant);(0,m.useEffect)(()=>{en(!window._doNotTrack&&ea)},[ea]);let el=H.map(e=>(0,n.jsx)(x,{fontFamily:R,path:e,value:G.data[e.fieldLabel]||"",isSubmitted:G.isSubmitted,errorMessage:Y[e.fieldLabel]||G.isSubmitted?$[e.fieldLabel]:void 0,onBlur:()=>Z(t=>({...t,[e.fieldLabel]:!0})),onChange:t=>X({...G,isDirty:!0,data:{...G.data,[e.fieldLabel]:t}}),onSubmit:()=>{let[e]=J||[];e&&("step"===e.pathType&&d?et(d)(e):"url"===e.pathType&&et(p)(e))}},e.id));return(0,n.jsxs)("div",{className:(0,a.cn)("flex flex-col gap-[0.5em]",{"mt-[1.5em]":(t.title||t.subtitle)&&!M,"anim-overlay-title-sequence-3":S}),"aria-label":"Form overlay","aria-live":"polite",children:[er&&(0,n.jsx)(c(),{src:"https://risk.clearbit.com/v1/risk.js"}),E?(0,n.jsx)(P,{targetRef:E,children:el}):el,J.map((e,t,a)=>(0,n.jsx)(i.OverlayPathViewer,{path:ee?e:{...e,url:void 0},isOnlyPath:1===a.length,isSmallScreenOrTile:r,onButtonClick:et(d),onOverlayUrlClick:et(p),customVariables:L.customVariables,customValues:q,buttonBg:e.buttonColor||(0,b.jC)(),textColor:e.buttonTextColor||(0,b.Qe)(),navigationElementWithSound:g,enterNavigationElement:y,leaveNavigationElement:C,fontFamily:R,mediaIsPlaying:_,percentComplete:F},e.id))]})};function _(e){var t;let{step:r,isSmallScreenOrTile:o,onButtonClick:u,onOverlayUrlClick:d,navigationElementWithSound:c,enterNavigationElement:f,leaveNavigationElement:p,mediaIsPlaying:g,percentComplete:y}=e,x=(0,h.qM)(),w=(0,s.md)(v.F.stageDimensions).layout===l.ViewerLayout.MobileExpanded,{customValues:k,fontFamily:T}=(0,m.useContext)(j.c),{paths:I,variant:N}=r,S=(0,C.T)()&&(null!=(t=x.mobileLayout)?t:"wide")==="fit";return N===l.OverlayVariant.Form?(0,n.jsx)(E,{...e}):(0,n.jsx)("div",{className:(0,a.cn)("portrait flex flex-col gap-[0.25em] sm:gap-[0.5em]",{"mt-[1.5em]":r.subtitle||r.title,"anim-overlay-title-sequence-3":e.isActive,"anim-overlay-title-sequence-2":!w&&(e.isActive&&r.title&&!r.subtitle||e.isActive&&!r.title&&r.subtitle),"anim-overlay-title-sequence-1":e.isActive&&!w&&!r.subtitle&&!r.title,"flex-row":("left"===r.textAlign||"right"===r.textAlign||r.showPreviewImage&&"center"===r.textAlign)&&!S&&!w}),children:null==I?void 0:I.map((e,t,r)=>(0,n.jsx)(i.OverlayPathViewer,{path:e,isOnlyPath:1===r.length,isSmallScreenOrTile:o,onButtonClick:u,onOverlayUrlClick:d,customVariables:x.customVariables,customValues:k,buttonBg:e.buttonColor||(0,b.jC)(),textColor:e.buttonTextColor||(0,b.Qe)(),navigationElementWithSound:c,enterNavigationElement:f,leaveNavigationElement:p,fontFamily:T,mediaIsPlaying:g,percentComplete:y},e.id))})}},76959:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(6029),a=r(80411);let l=e=>{let{className:t,...r}=e;return(0,n.jsx)("input",{type:"radio",className:(0,a.cn)("transition-all ease-jelly duration-300 h-6 w-6 text-white bg-transparent border border-gray-900/[.24] cursor-pointer checked:!bg-gray-700 checked:!border-gray-900 unchecked:bg-transparent group-hover/input:border-gray-900/[.32] group-hover/input:bg-white/20","focus:ring-0 focus:ring-offset-0","appearance-none",t),...r})}},86603:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(6029),a=r(80411),l=r(86747),i=r(55729),o=r(15522);let s=(e,t)=>t?t({children:e}):e,u=(0,i.forwardRef)((e,t)=>{var r;let{isDark:i,theme:u,isSmallScreenOrTile:d,textAreaClassName:c,parentClassName:m,buttonStyle:f,children:b,onClick:p,onSubmit:g,flow:h,isViewer:v=!1,maxChar:y,readOnlyMode:x,...w}=e;return(0,n.jsxs)("div",{className:"portrait flex group/chapterBtn relative w-full",ref:t,children:[!v&&(0,n.jsx)("div",{className:(0,a.cn)("border rounded-[0.75em] absolute -inset-[0.25em] opacity-0 group-hover/chapterBtn:opacity-100 bg-transparent transition-all",{"border-white":u===l.OverlayTheme.Dark||u===l.OverlayTheme.Custom,"border-gray-900":u===l.OverlayTheme.Light})}),(0,n.jsx)("div",{className:(0,a.cn)("font-semibold relative rounded-[0.5em] transition-all opacity-100","bg-transparent text-gray-900 hover:bg-gray-100 active:bg-gray-200 shadow-hotBox w-full min-h-[2em]",{"cursor-pointer":v},d?"text-[0.875em] leading-[1.125em] px-[0.75em] py-[0.5em]":"min-h-[3em] text-[1em] leading-[1.125em] px-[1.25em] py-[0.75em]","px-3 cursor-pointer",m),style:f,onClick:p,tabIndex:-1,role:"button",children:s((0,n.jsx)(o.A,{disabled:x,...w,className:(0,a.cn)("inherit font-semibold outline-none bg-transparent border-0 border-transparent ring-0 p-0 resize-none select-text focus:ring-0 text-center flex w-full [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none]",{"placeholder-[rgba(255,255,255,.3)]":f.backgroundColor&&f.color.toLowerCase().startsWith("#fff"),"placeholder-[rgba(0,0,0,.3)]":f.backgroundColor&&f.color.startsWith("#000"),"leading-[1.5em]":!v},c),onMouseDown:e=>{var t;e.stopPropagation(),null==(t=w.onMouseDown)||t.call(w,e)},onKeyDown:e=>{var t;"Enter"===e.code&&(e.preventDefault(),e.stopPropagation(),null==g||g(e)),null==(t=w.onKeyDown)||t.call(w,e)},onChange:e=>{var t,r;if(e.stopPropagation(),e.preventDefault(),void 0!==y){let r=e.target.value,n=w.value;(r.length<=y||r.length<n.length)&&(null==(t=w.onChange)||t.call(w,e))}else null==(r=w.onChange)||r.call(w,e)},cols:Math.min(Math.max(5,Math.ceil(.85*((null==(r=w.value)?void 0:r.length)||4))),23),maxRows:3}),b)})]})})}}]);