<!DOCTYPE html>
<!-- saved from url=(0071)https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/ -->
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="true" data-theme="light" data-rh="lang,dir,class,data-has-hydrated" style="--navbar-height: 136px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="Docusaurus v3.4.0">
<title>The Vulnerabilities You’ll Write With Anchor | Zellic — Research</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="The Vulnerabilities You’ll Write With Anchor | Zellic — Research"><meta data-rh="true" name="description" content="Anchor is no silver bullet for avoiding mistakes in Solana code"><meta data-rh="true" property="og:description" content="Anchor is no silver bullet for avoiding mistakes in Solana code"><meta data-rh="true" property="og:image" content="https://blog-cdn.zellic.io/blog/assets/images/vulnerabilities-youll-write-with-anchor-d69960ec54c8b89027bc9d8291df0d9f.png"><meta data-rh="true" name="twitter:image" content="https://blog-cdn.zellic.io/blog/assets/images/vulnerabilities-youll-write-with-anchor-d69960ec54c8b89027bc9d8291df0d9f.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-08-16T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Solana,Primer"><link data-rh="true" rel="icon" href="https://assets.zellic.io/favicon.svg"><link rel="alternate" type="application/rss+xml" href="https://www.zellic.io/blog/rss.xml" title="Zellic — Research RSS Feed">
<link rel="alternate" type="application/atom+xml" href="https://www.zellic.io/blog/atom.xml" title="Zellic — Research Atom Feed">

<link rel="stylesheet" href="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/katex.min.css" crossorigin="anonymous">
<link rel="stylesheet" href="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/stylesheet.css" crossorigin="anonymous"><link rel="stylesheet" href="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/styles.26ed4534.css">
<script src="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/runtime~main.308452e7.js.download" defer="defer"></script>
<script src="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/main.fbd665ce.js.download" defer="defer"></script>
<style id="mttstyle">
    #mttContainer {
      left: 0 !important;
      top: 0 !important;
      width: 1000px !important;
      margin: 0px !important;
      margin-left: -500px !important;
      position: fixed !important;
      z-index: 2147483647 !important; /* Maximum z-index to overcome overlays */
      background: none !important;
      pointer-events: none !important;
      display: inline-block !important;
      visibility: visible  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"], .tippy-box[data-theme~="ocr"], .tippy-content *{
      font-size: 18px  !important;
      text-align: center !important;
      overflow-wrap: break-word !important;
      color: #ffffffff !important;
      font-family: 
        -apple-system, BlinkMacSystemFont,
        "Segoe UI", "Roboto", "Oxygen",
        "Ubuntu", "Cantarell", "Fira Sans",
        "Droid Sans", "Helvetica Neue", sans-serif  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"]{
      max-width: 200px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
      opacity: 1.0; /* Adjusted opacity for transparency */
    }
    .tippy-box[data-theme~="ocr"]{
      max-width: $1000px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
      opacity: 1.0; /* Adjusted opacity for transparency */
    }
    .tippy-box[data-theme~="transparent"] {
      max-width: $1000px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
      opacity: 0.0; /* Adjusted opacity for transparency */
      transition: opacity 0.3s ease-in-out; /* Added transition for opacity */
    }
    [data-tippy-root] {
      display: inline-block !important;
      visibility: visible  !important;
      position: absolute !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='top'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='top'] > .tippy-arrow::before { 
      border-top-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='bottom'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='bottom'] > .tippy-arrow::before {
      border-bottom-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='left'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='left'] > .tippy-arrow::before {
      border-left-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='right'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='right'] > .tippy-arrow::before {
      border-right-color: #00000080 !important;
    }

    .mtt-highlight{
      background-color: #21dc6d40  !important;
      position: absolute !important;   
      z-index: 2147483646 !important; /* Slightly lower than tooltip */
      pointer-events: none !important;
      display: inline !important;
      border-radius: 3px !important;
    }
    .mtt-image{
      width: 180px  !important;
      border-radius: 3px !important;
    }
    .ocr_text_div{
      position: absolute;
      opacity: 0.4;
      color: transparent !important;
      border: 2px solid CornflowerBlue;
      background: none !important;
      border-radius: 3px !important;
    }</style><style id="mttstyleSubtitle">
    #ytp-caption-window-container .ytp-caption-segment {
      cursor: text !important;
      user-select: text !important;
      font-family: 
      -apple-system, BlinkMacSystemFont,
      "Segoe UI", "Roboto", "Oxygen",
      "Ubuntu", "Cantarell", "Fira Sans",
      "Droid Sans", "Helvetica Neue", sans-serif  !important;
    }
    .caption-visual-line{
      display: flex  !important;
      align-items: stretch  !important;
      direction: ltr
    }
    .captions-text .caption-visual-line:first-of-type:after {
      content: '⣿⣿';
      border-radius: 3px !important;
      color: white !important;
      background: transparent !important;
      box-shadow: rgba(50, 50, 93, 0.25) 0px 30px 60px -12px inset, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px inset;
      display: inline-block;
      vertical-align: top;
      opacity:0;
      transition: opacity 0.7s ease-in-out;
    }
    .ytp-caption-segment{
      color: white !important;
      text-shadow: 1px 1px 2px black !important;
      backdrop-filter: blur(3px) !important;
      background: rgba(8, 8, 8, 0.1)  !important;
    }
    .captions-text:hover .caption-visual-line:first-of-type:after {
      opacity:1;
    }
    .ytp-pause-overlay {
      display: none !important;
    }
    .ytp-expand-pause-overlay .caption-window {
      display: block !important;
    }
  </style><link rel="canonical" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/" data-rh="true"><link rel="alternate" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/" hreflang="en" data-rh="true"><link rel="alternate" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/" hreflang="x-default" data-rh="true"><meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><meta property="og:url" content="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/" data-rh="true"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/6875c492.a6f39034.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/36994c47.318b847f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/814f3328.7cecc42d.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/b0637596.20e1946a.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/1bb245a5.1bfdfaa0.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/10634a7b.45ee2ea2.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/f1ddfc38.745bed36.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/4237cb8a.92b770bd.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/32815880.6ae55495.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/203d4738.7578cd40.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/e0c9b05b.0f015112.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/5ea94b3b.30c4bf77.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/1936ff49.99544f74.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/a6aa9e1f.54627ef2.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/36994c47.318b847f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/814f3328.7cecc42d.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/3f954a73.9f05bbc1.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/141710e1.5c6a65f2.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/69cd0049.0cdc11fe.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/1cba9ab0.ed9d431b.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/176dc4e5.72b5150f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/0119168e.81909fb9.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/b8081dd3.8b5a51e6.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/ab3b4dc3.a7bbe550.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/9f5bfb1d.74b70511.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/15196319.1d98b4ed.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/93deec87.0c12a8f9.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/845cf45d.b66e4e7e.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/bdd05757.79989233.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/a3186a72.b8cbc28e.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/a7b40352.f64f31d1.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/3f131433.e2d00a2a.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/60978f45.1b977d6d.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/9fe4a1a3.9a611e1f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/f6bcfca8.5497cda4.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/d852ee65.c2ab7061.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/8cc801ac.d0377afb.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/4d583630.58d2cd42.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/66784d74.17f42eb8.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/7f5aa89d.8da79685.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/d0795a20.36e13ca6.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/606b8c62.6b63f0d0.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/b0637596.20e1946a.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/d5d099d9.8f04a76f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/6080aa60.a0e6e712.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/3b130422.e5ee7ee4.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/e565dbfd.d7fc83ff.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/1bb245a5.1bfdfaa0.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/7ca9d3a7.7de278c3.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/aff6511c.24c224d1.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/d7fec7d4.dea16f97.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/10634a7b.45ee2ea2.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/10631895.cdfef2a9.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/03013c1e.e70e25e0.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/4c7b73bd.26825fb8.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/f1ddfc38.745bed36.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/ace3e801.e7122253.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/73dcb9f6.b7d2efa0.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/4237cb8a.92b770bd.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/54a6efda.8ae253ce.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/9b55cb1c.3c578b1b.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/c82b9623.4903ab8c.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/3a97f650.714b6dd5.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/9fc6cd42.f35283de.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/32815880.6ae55495.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/203d4738.7578cd40.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/a41e4cce.720bcd37.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/3cd5e691.c044cc55.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/89657297.06fdc62e.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/dbca8b21.cbcdd041.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/f3c73aa7.da4f48d6.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/e0c9b05b.0f015112.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/5ea94b3b.30c4bf77.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/9a4b9f19.bbef1a56.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/9f76be1d.f05122d6.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/e89918bb.76621884.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/08af526d.6c026489.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/6875c492.a6f39034.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/36994c47.318b847f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/814f3328.7cecc42d.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/5ea94b3b.30c4bf77.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/e1f2134a.cb0a1ca8.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/ccc49370.a3287037.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/acecf23e.d00c7ea4.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/36994c47.318b847f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/814f3328.7cecc42d.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/46611912.2ef8a018.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/ccc49370.a3287037.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/acecf23e.d00c7ea4.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/36994c47.318b847f.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/814f3328.7cecc42d.js"><link rel="prefetch" href="https://blog-cdn.zellic.io/blog/assets/js/b7b79e09.aa819322.js"></head>
<body class="" data-rh="class">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#__docusaurus_skipToContent_fallback">Skip to main content</a></div><header class="navbar zellicNavbar NavHeader_KWYz"><div class="NavContainer_RnHJ"><nav aria-label="Main" class="NavbarLayout_Gd7U"><a class="NavBrand_Jd7j" href="https://www.zellic.io/"><img class="NavBrandImage_hNwQ" src="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/zellic-symbol-type-logo.svg" loading="eager" width="144" alt=""></a><div class="NavContentWrapper_J7lA"><div class="NavbarNav_J6Ak"><nav class="NavbarMenu_D1lO"><a class="NavbarMenuLink_YUFc" href="https://www.zellic.io/services">Services</a><a class="NavbarMenuLink_YUFc" href="https://www.zellic.io/our-work">Our Work</a><a class="NavbarMenuLink_YUFc ActiveNavbarMenuLink_mAsj" href="https://www.zellic.io/blog">Research</a><a class="NavbarMenuLink_YUFc" href="https://www.zellic.io/team">Team</a><a class="NavbarMenuLink_YUFc NavbarMenuLastLink_RHOy" href="https://www.zellic.io/contact">Contact</a></nav></div><div class="NavbarButtonContainer_fyDz"><a class="NavbarButton_xW_X" href="https://www.zellic.io/contact"><div>Request a quote</div><div class="BlogPostButtonIcon_CLkN"><span class="BlogPostButtonIconSpan_wa1A">↗</span></div></a></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#" class="NavbarMobileMenuButton_RKvp inactive_c0io"><div class="NavbarMobileMenuIcon_tx5E"><div class="IconListBar_tyrB"><div class="ListBar_KBPr"></div><div class="ListBar_KBPr"></div><div class="ListBar_KBPr"></div></div></div></a></div><div class="SiteHeaderOffCanvas__z1R"><div class="OffCanvasPad_u1uO"><div class="OffCanvasContainer_oUr4"><div class="OffCanvasBody_0YaS"><nav class="NavbarMenu_D1lO"><a class="NavbarMenuLink_YUFc" href="https://www.zellic.io/services">Services</a><a class="NavbarMenuLink_YUFc" href="https://www.zellic.io/our-work">Our Work</a><a class="NavbarMenuLink_YUFc ActiveNavbarMenuLink_mAsj" href="https://www.zellic.io/blog">Research</a><a class="NavbarMenuLink_YUFc" href="https://www.zellic.io/team">Team</a><a class="NavbarMenuLink_YUFc NavbarMenuLastLink_RHOy" href="https://www.zellic.io/contact">Contact</a></nav></div></div></div></div></nav></div></header><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="LargeContainer_Zneg" style="padding-bottom:1rem;margin-bottom:0;height:0"><nav class="theme-doc-breadcrumbs breadcrumbsContainer__a2V" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" target="_self" href="https://www.zellic.io/blog/">Research</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">The Vulnerabilities You’ll Write With Anchor</span><meta itemprop="position" content="1"></li></ul></nav></div><div class="LargeContainer_Zneg" style="padding-left:1rem;padding-right:0"><div class="BlogGrid_TfkJ"><div class="TOC_iepQ"><div class="tableOfContents_jeP5 thin-scrollbar"><div class="tocHeader_ieHc"><div>Table of contents</div></div><ul class="table-of-contents"><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#background" class="table-of-contents__link toc-highlight itemlink_BYCY">Background</a></div></li><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#seed-collisions" class="table-of-contents__link toc-highlight itemlink_BYCY">Seed Collisions</a></div></li><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#misuse-of-anchors-ctxremaining_accounts" class="table-of-contents__link toc-highlight itemlink_BYCY">Misuse of Anchor’s ctx.remaining_accounts</a></div></li><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#confused-deputy-with-cpi" class="table-of-contents__link toc-highlight itemlink_BYCY table-of-contents__link--active">Confused Deputy with CPI</a></div></li><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#account-reloading" class="table-of-contents__link toc-highlight itemlink_BYCY">Account Reloading</a></div></li><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#conclusion" class="table-of-contents__link toc-highlight itemlink_BYCY">Conclusion</a></div></li><li><div class="item_ce03"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="asterisk_Pmvg"><title>Asterisk</title><path fill="currentColor" d="M9 4.5v6.9l-2.1-1.2V4.5zM3.5 10.6l6 3.5-2.1 1.2-5-2.9zM6.2 18.5l6-3.5v2.4l-5 2.9zM14.3 20.1v-6.9l2.1 1.2v5.7zM19.8 14l-6-3.5 2.1-1.2 5 2.9zM17.1 6.1l-6 3.5V7.2l5-2.9z"></path></svg></div><a href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#about-us" class="table-of-contents__link toc-highlight itemlink_BYCY">About Us</a></div></li></ul></div></div><main class="BlogMain_Zyk5" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://blog-cdn.zellic.io/blog/assets/images/vulnerabilities-youll-write-with-anchor-d69960ec54c8b89027bc9d8291df0d9f.png"><header><div class="Cluster_XUzU" style="--gap:1rem;--justifyContent:left;--alignItems:center"><div class="Cluster_XUzU" style="--gap:1rem;--justifyContent:left;--alignItems:center"><div class="SmallText_OA2p">The Zellic Team</div><div class="MetaSquare_jwXi"></div><time class="SmallText_OA2p" datetime="2022-08-16T00:00:00.000Z" itemprop="datePublished">August 16, 2022</time></div><a style="text-decoration:none" target="_self" href="https://www.zellic.io/blog/tags/solana"><label class="filterLabel_r4bE wCheckbox_Jqip checkboxButton_B2js button_uKeQ isOutline_zTD0 isFilter_lDVy" for="Checkbox" style="padding:.125rem .25rem"><input type="checkbox" id="Checkbox-0" name="Checkbox" data-name="Checkbox" class="hideDefaultInput_jySQ"><span>#Solana</span></label></a><a style="text-decoration:none" target="_self" href="https://www.zellic.io/blog/tags/primer"><label class="filterLabel_r4bE wCheckbox_Jqip checkboxButton_B2js button_uKeQ isOutline_zTD0 isFilter_lDVy" for="Checkbox" style="padding:.125rem .25rem"><input type="checkbox" id="Checkbox-0" name="Checkbox" data-name="Checkbox" class="hideDefaultInput_jySQ"><span>#Primer</span></label></a></div><h1 class="title_xvU1" itemprop="headline">The Vulnerabilities You’ll Write With Anchor</h1><div class="summary_sM28">Anchor is no silver bullet for avoiding mistakes in Solana code</div><img src="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/article_heading.svg" class="heading_ZK4z" alt="Article heading"><div class="line_Ez5w"></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Solana development is error-prone. Often, people cite Anchor as a remedy
to this problem: “write it in Anchor, and your Solana programs will be
secure.” Not so fast! There are still many gotchas even when using
Anchor. Let’s explore some of them.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" aria-label="Direct link to Background" title="Direct link to Background" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#background">​</a></h2>
<p>Writing secure Solana programs is no easy task. There are many foot guns
one may encounter while creating Solana programs. To safely operate in
this ecosystem, a developer needs to be intimately familiar with
invariants upheld by the runtime, under what conditions are those
invariants no longer guaranteed, and a myriad of account confusion,
confused deputy, integer over and underflow, and a dozen more classic
security vulnerability classes.</p>
<p>Anchor was created because barebones Solana is extremely error-prone.
Anchor is a Solana framework designed to make the process of writing
programs significantly easier and safer than writing them without.
Anchor addresses many of the most common and impactful issues that
you’ll face when writing Solana smart contracts. Here are just a few:</p>
<ul>
<li>Account confusion</li>
<li>Account types</li>
<li>Account addresses</li>
<li>Account liveness</li>
<li>Ownership</li>
<li>Missing account constraints</li>
</ul>
<p>As a smart-contract auditing firm we’ve reviewed a lot of Solana
programs, especially those written with Anchor. Even though Anchor
addresses many of the major issues found in Solana programs, there are
plenty of issues that crop up regardless.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="seed-collisions">Seed Collisions<a class="hash-link" aria-label="Direct link to Seed Collisions" title="Direct link to Seed Collisions" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#seed-collisions">​</a></h2>
<p>Program Derived Addresses (PDA) are a way to programmatically derive an
off-curve account address. They’re commonly used for Cross Program
Invocations (CPI), as well as creating accounts that hold stateful
information. For example, a liquidity pool program may create a PDA to
track funds allocated for a particular purpose or use a PDA to hold the
protocol’s global configuration.</p>
<p>Using PDAs in Anchor is simple - we define the elements that make up the
seed used in deriving the account address and we’re off to the races.
Here’s an
<a href="https://book.anchor-lang.com/anchor_in_depth/PDAs.html" target="_blank" rel="noopener">example<span class="external-arrow">↗</span></a>:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #28281E; --prism-background-color: #EFEFEB;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color: rgb(40, 40, 30); background-color: rgb(239, 239, 235);"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[derive(Accounts)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">struct</span><span class="token plain"> </span><span class="token type-definition class-name">ChangeUserName</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Signer</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    #</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token function" style="color: rgb(75, 150, 225);">account</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(150, 50, 150);">mut</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        seeds </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token string" style="color: rgb(75, 150, 75);">b"user-stats"</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">key</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">as_ref</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        bump </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> user_stats</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">bump</span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> user_stats</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">UserStats</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// &lt;-- PDA account</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here we’re using a static string <strong>user-stats</strong> and the fixed length (32
bytes) public key address from the user account to validate the address
for the provided UserStats account. This is a typical example of how
seeds are often defined and used on PDAs.</p>
<p>Because no two distinct users share a public key, their UserStats
accounts will also have unique addresses. This isn’t always the case for
PDAs, though! Collisions can result in a Denial of Service vulnerability
in the best cases and complete compromise on the other end of the
spectrum.</p>
<p>Take this example of a <strong>CreateNewProduct</strong> instruction account guard,
which creates a product PDA based on the product name and a leading
static string.</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #28281E; --prism-background-color: #EFEFEB;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color: rgb(40, 40, 30); background-color: rgb(239, 239, 235);"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[derive(Accounts)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[instruction(product_name: String)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">struct</span><span class="token plain"> </span><span class="token type-definition class-name">CreateNewProduct</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">   </span><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[account(mut)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">   </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Signer</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">   #</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token function" style="color: rgb(75, 150, 225);">account</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">       init</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">       payer </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">       space </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token number" style="color: rgb(200, 30, 30);">8</span><span class="token plain"> </span><span class="token operator" style="color: rgb(138, 138, 5);">+</span><span class="token plain"> </span><span class="token class-name">Product</span><span class="token punctuation" style="color: rgb(138, 138, 5);">::</span><span class="token constant" style="color: rgb(200, 30, 30);">SIZE</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">       seeds </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token string" style="color: rgb(75, 150, 75);">b"product"</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> product_name</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">as_ref</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">   </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">   </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> product</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">Product</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// &lt;-- PDA account</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">   </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> system_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It might not appear to have any issues, but we begin to see problems
when considering the other PDAs in our program.</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #28281E; --prism-background-color: #EFEFEB;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color: rgb(40, 40, 30); background-color: rgb(239, 239, 235);"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[instruction(product_name: String)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">struct</span><span class="token plain"> </span><span class="token type-definition class-name">CreateNewBid</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[account(mut)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Signer</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    #</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token function" style="color: rgb(75, 150, 225);">account</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(150, 50, 150);">mut</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        seeds </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token string" style="color: rgb(75, 150, 75);">b"product"</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> product_name</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">as_ref</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        bump </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> product</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">bump</span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> product</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">Product</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// &lt;-- PDA account</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    #</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token function" style="color: rgb(75, 150, 225);">account</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        init</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        payer </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        space </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token number" style="color: rgb(200, 30, 30);">8</span><span class="token plain"> </span><span class="token operator" style="color: rgb(138, 138, 5);">+</span><span class="token plain"> </span><span class="token class-name">Bid</span><span class="token punctuation" style="color: rgb(138, 138, 5);">::</span><span class="token constant" style="color: rgb(200, 30, 30);">SIZE</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        seeds </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token plain">product_name</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">as_ref</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">key</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">as_ref</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> bid</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">Bid</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// &lt;-- PDA account</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> system_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here we add a <strong>Bid</strong> PDA account that is meant to hold a user’s bid on
a product. The bid is scoped to a product and a user. While this might
appear safe at first, because this <strong>Bid</strong> and this <strong>Product</strong> cannot
collide with each other, an attacker can leverage this to prevent users
from submitting bids or products from being created.</p>
<p>In certain circumstances, an attacker can create a product that
generates the same program address as a <strong>Bid</strong> account. This would
prevent a specific user from creating a bid for that product.</p>
<p>This is because elements from a seed array are effectively treated as
one large collection of bytes and processed in 32 byte chunks. Therefore
this seed (used by the attacker’s Product account)</p>
<p>[b”product”, b”youshouldbuythisproductfast”]</p>
<p>and this seed (used by the victim’s Bid account)</p>
<p>[b”pr”, 0x6f64756374796f7573686f756c646275797468697370726f6475637466617374]</p>
<p>generate the same PDA public key. There is an underwhelming warning
about this specific behavior in the <strong>solana-program</strong> crate
documentation for Pubkey.</p>
<p><img decoding="async" loading="lazy" src="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/6350273a2af779bd95a8bb48_seed-collisions-diagram-fccc36f7064871e4caacbd963317f391.png" width="1600" height="870" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="misuse-of-anchors-ctxremaining_accounts">Misuse of Anchor’s ctx.remaining_accounts<a class="hash-link" aria-label="Direct link to Misuse of Anchor’s ctx.remaining_accounts" title="Direct link to Misuse of Anchor’s ctx.remaining_accounts" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#misuse-of-anchors-ctxremaining_accounts">​</a></h2>
<p>As we’ve seen in the code samples in the seed collision examples above,
Anchor’s instruction account guards define a fixed number of accounts
and the constraints between them. These constraints are important to
upholding invariants in your protocol, but the limitation that we use a
fixed number of accounts can be limiting.</p>
<p>Oftentimes a variable number of accounts need to be passed to
instructions for processing. For instance, when attempting to cash out
participants in a pool or dynamically CPI to another program. To support
this, Anchor exposes <strong>ctx.remaining_accounts</strong> to access any additional
accounts not included in the original instruction account guard.</p>
<p>It is important to note that absolutely none of the protections that
Anchor typically provides are present on the accounts in
<strong>ctx.remaining_accounts</strong>. That means that if you intend to use these
accounts for anything sensitive you’ll need to perform some of the
following checks:</p>
<ul>
<li>Account Ownership</li>
<li>Account Type (anchor uses an 8 byte discriminator for this)</li>
<li>Account Liveness (anchor’s discriminator solves this - basically ‘is
the data field set to 0x00…00’)</li>
<li>Account Address</li>
<li>For PDA’s ensure the bump is correct as well!</li>
</ul>
<p>There are plenty of ways that using <strong>ctx.remaining_accounts</strong> can go
wrong. It’s important to treat all interactions with <strong>AccountInfo</strong>
types from <strong>ctx.remaining_accounts</strong> as dangerous.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="confused-deputy-with-cpi">Confused Deputy with CPI<a class="hash-link" aria-label="Direct link to Confused Deputy with CPI" title="Direct link to Confused Deputy with CPI" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#confused-deputy-with-cpi">​</a></h2>
<p>Solana is a composable ecosystem of programs. From calling out to the
System program, creating new accounts, to forwarding liquidity to Solend
generating yield, Cross Program Invocations are a normal part of writing
Solana programs.</p>
<p>For all the good CPIs bring, they also hide a danger. When a CPI is
performed, accounts forwarded along that also signed the transaction
carries with them their <strong>is_signer</strong> status. This means that if Program
A calls Program B with some account having signed the transaction,
Program B can use that account as a signer. This is very important to
understand. This means that Program B can create new accounts, send
lamports and any associated tokens (provided the associated token
account is passed as well), and much more.</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #28281E; --prism-background-color: #EFEFEB;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color: rgb(40, 40, 30); background-color: rgb(239, 239, 235);"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[derive(Accounts)]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">struct</span><span class="token plain"> </span><span class="token type-definition class-name">RiskyInstruction</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> lending_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">AccountInfo</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// &lt;-- no validation of account</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    #</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token function" style="color: rgb(75, 150, 225);">account</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(150, 50, 150);">mut</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        seeds </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token plain"> </span><span class="token string" style="color: rgb(75, 150, 75);">b"pool"</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        bump </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> pool</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">bump</span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> pool</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Account</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">Pool</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token attribute attr-name" style="color: rgb(150, 50, 150);">#[account]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> caller</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Signer</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> system_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token lifetime-annotation symbol" style="color: rgb(200, 30, 30);">'info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">}</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token keyword" style="color: rgb(150, 50, 150);">pub</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color: rgb(75, 150, 225);">risky_instruction</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token class-name">Context</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token class-name">RiskyInstruction</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">u64</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color: rgb(138, 138, 5);">&lt;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token operator" style="color: rgb(138, 138, 5);">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">let</span><span class="token plain"> account_infos </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">caller</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">clone</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">lending_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">clone</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">pool</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">clone</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">system_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">clone</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token keyword" style="color: rgb(150, 50, 150);">let</span><span class="token plain"> instruction </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token function" style="color: rgb(75, 150, 225);">create_lending_instruction</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">lending_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">key</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// &lt;-- program we're calling out to</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">caller</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">key</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        ctx</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">accounts</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">pool</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">key</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        amount</span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// v----- this is dangerous if we don't fully trust the lending_program account</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token function" style="color: rgb(75, 150, 225);">invoke_signed</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token operator" style="color: rgb(138, 138, 5);">&amp;</span><span class="token plain">instruction</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token operator" style="color: rgb(138, 138, 5);">&amp;</span><span class="token plain">account_infos</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token operator" style="color: rgb(138, 138, 5);">&amp;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token operator" style="color: rgb(138, 138, 5);">&amp;</span><span class="token punctuation" style="color: rgb(138, 138, 5);">[</span><span class="token string" style="color: rgb(75, 150, 75);">b"pool"</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token punctuation" style="color: rgb(138, 138, 5);">]</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token operator" style="color: rgb(138, 138, 5);">?</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This issue compounds with invoke_signed which is commonly used when
interfacing with PDAs. PDA accounts are frequently used as an authority
account in protocols. If calls to <strong>invoke_signed</strong> pass this authority
in, alongside the required signer seeds, then a substantial third-party
risk is introduced. The target program could be dynamically passed in by
the caller allowing an attacker to call their malicious program
leveraging the authority PDA. Even statically defined programs introduce
risk if they can be upgraded.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="account-reloading">Account Reloading<a class="hash-link" aria-label="Direct link to Account Reloading" title="Direct link to Account Reloading" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#account-reloading">​</a></h2>
<p>The problems CPIs can introduce do not end there. While Anchor does a
lot for you automatically, one thing it doesn’t do is update
deserialized accounts after a CPI.</p>
<p>For example, imagine you have a Mint account and are just about to mint
some token for the caller to track their contribution to a liquidity
pool. You perform a CPI to the token program to mint these tokens and
then read the current supply from the Mint account for a calculation
later on. While, intuitively, you might expect the supply to be
accurate, accounts in Anchor don’t update their data after a CPI!</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #28281E; --prism-background-color: #EFEFEB;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="color: rgb(40, 40, 30); background-color: rgb(239, 239, 235);"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token keyword" style="color: rgb(150, 50, 150);">let</span><span class="token plain"> authority_seeds </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">/* seeds */</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token keyword" style="color: rgb(150, 50, 150);">let</span><span class="token plain"> mint_to </span><span class="token operator" style="color: rgb(138, 138, 5);">=</span><span class="token plain"> </span><span class="token class-name">MintTo</span><span class="token plain"> </span><span class="token punctuation" style="color: rgb(138, 138, 5);">{</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    mint</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">self</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">liquidity_mint</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    to</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">self</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">user</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    authority</span><span class="token punctuation" style="color: rgb(138, 138, 5);">:</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">self</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">liquidity_mint_authority</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">}</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token macro property" style="color: rgb(200, 30, 30);">msg!</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token string" style="color: rgb(75, 150, 75);">"Supply before: {}"</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">self</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">liquidity_mint</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">supply</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token namespace" style="opacity: 0.7;">anchor_spl</span><span class="token namespace punctuation" style="opacity: 0.7; color: rgb(138, 138, 5);">::</span><span class="token namespace" style="opacity: 0.7;">token</span><span class="token namespace punctuation" style="opacity: 0.7; color: rgb(138, 138, 5);">::</span><span class="token function" style="color: rgb(75, 150, 225);">mint_to</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token class-name">CpiContext</span><span class="token punctuation" style="color: rgb(138, 138, 5);">::</span><span class="token function" style="color: rgb(75, 150, 225);">new_with_signer</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        </span><span class="token keyword" style="color: rgb(150, 50, 150);">self</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">token_program</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token function" style="color: rgb(75, 150, 225);">to_account_info</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        mint_to</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">        authority_seeds</span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    </span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain">    amount</span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token operator" style="color: rgb(138, 138, 5);">?</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(40, 40, 30);"><span class="token plain"></span><span class="token macro property" style="color: rgb(200, 30, 30);">msg!</span><span class="token punctuation" style="color: rgb(138, 138, 5);">(</span><span class="token string" style="color: rgb(75, 150, 75);">"Supply after: {}"</span><span class="token punctuation" style="color: rgb(138, 138, 5);">,</span><span class="token plain"> </span><span class="token keyword" style="color: rgb(150, 50, 150);">self</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">liquidity_mint</span><span class="token punctuation" style="color: rgb(138, 138, 5);">.</span><span class="token plain">supply</span><span class="token punctuation" style="color: rgb(138, 138, 5);">)</span><span class="token punctuation" style="color: rgb(138, 138, 5);">;</span><span class="token plain"> </span><span class="token comment" style="color: rgb(150, 150, 150); font-style: italic;">// stays the same!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To get the expected behavior, make sure to call Anchor’s reload method
on the account. This will refresh the struct’s fields with the current
underlying data.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#conclusion">​</a></h2>
<p>Anchor is a fantastic way to level up your Solana program’s security,
but it isn’t a silver bullet. There are still several ways that
vulnerabilities can manifest in Anchor-based Solana programs. These
bugs’ impacts can range from denial-of-service to an attacker making off
with your funds.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="acknowledgements">Acknowledgements<a class="hash-link" aria-label="Direct link to Acknowledgements" title="Direct link to Acknowledgements" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#acknowledgements">​</a></h3>
<p>Thanks to <a href="https://twitter.com/dumbcontract2" target="_blank" rel="noopener">Hana<span class="external-arrow">↗</span></a> for helping
fact-check this article.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-us">About Us<a class="hash-link" aria-label="Direct link to About Us" title="Direct link to About Us" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor#about-us">​</a></h2>
<p>Zellic specializes in securing emerging technologies. Our security researchers have uncovered vulnerabilities in the most valuable targets, from Fortune 500s to DeFi giants.</p>
<p>Developers, founders, and investors trust our security assessments to ship quickly, confidently, and without critical vulnerabilities. With our background in real-world offensive security research, we find what others miss.</p>
<p>‍<a href="https://zellic.io/contact" target="_blank" rel="noopener">Contact us<span class="external-arrow">↗</span></a> for an audit that’s better than the rest. Real audits, not rubber stamps.</p>
<p>‍</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" target="_self" href="https://www.zellic.io/blog/move-fast-and-break-things-pt-1"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label PaginationWeight_kHdB">Move Fast &amp; Break Things, Part 1: Move Security (Aptos)</div></a><a class="pagination-nav__link pagination-nav__link--next" target="_self" href="https://www.zellic.io/blog/breaking-down-the-economics-of-defi-hacks"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label PaginationWeight_kHdB">TradFi, Meet DeFi: Breaking Down the Economics of DeFi Hacks</div></a></nav></main></div></div></div><footer class="SiteFooter_tC3X"><div class="SiteFooterWrapper_WHdZ"><div class="SiteFooterPadding_uM5k"><div class="SiteFooterContainer_L2Ui"><div class="SiteFooter01Section_oWiU"><div class="GridElement01_L0Qe"><div class="SiteFooterHeadLogo_Iumo"><a class="SiteFooterHeadLink_VBs2" href="https://www.zellic.io/"><div class="SiteImage_kW9I"><svg width="69" height="60" viewBox="0 0 69 60" fill="none" xmlns="http://www.w3.org/2000/svg" style="max-width:2.5rem"><path d="M20.5773 0.577148V24.3385L16.6543 22.073V0.577148H20.5773Z" fill="currentColor"></path><path d="M28.423 0.577148V28.8672L24.5 26.6017V0.577148H28.423Z" fill="currentColor"></path><path d="M1.96152 27.1797L22.5395 39.0604L18.6159 41.3251L0 30.5771L1.96152 27.1797Z" fill="currentColor"></path><path d="M5.88438 20.3848L30.3843 34.5298L26.4608 36.7945L3.92285 23.7822L5.88438 20.3848Z" fill="currentColor"></path><path d="M15.6924 56.6026L36.2704 44.7219L36.2698 49.2521L17.6539 60L15.6924 56.6026Z" fill="currentColor"></path><path d="M11.769 49.8076L36.269 35.6626L36.2685 40.1928L13.7306 53.2051L11.769 49.8076Z" fill="currentColor"></path><path d="M48.0386 59.4229V35.6615L51.9616 37.9271V59.4229H48.0386Z" fill="currentColor"></path><path d="M40.1924 59.4228V31.1328L44.1154 33.3983V59.4228H40.1924Z" fill="currentColor"></path><path d="M66.6541 32.8203L46.0762 20.9396L49.9997 18.6749L68.6157 29.4228L66.6541 32.8203Z" fill="currentColor"></path><path d="M62.7309 39.6152L38.231 25.4702L42.1545 23.2055L64.6924 36.2178L62.7309 39.6152Z" fill="currentColor"></path><path d="M52.9232 3.39746L32.3452 15.2782L32.3457 10.7479L50.9617 0L52.9232 3.39746Z" fill="currentColor"></path><path d="M56.8466 10.1924L32.3467 24.3374L32.3472 19.8072L54.8851 6.79492L56.8466 10.1924Z" fill="currentColor"></path></svg></div></a></div></div><div class="GridElement02_wC1J"><div><h4 class="SiteNavHeader_RIGK">About us</h4></div><div class="SiteFooterNavMenu_HKVq"><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://www.zellic.io/services"><div>Services</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://www.zellic.io/team"><div>Team</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://zellic-inc.notion.site/Jobs-at-Zellic-82cab8ab2be84a3b9fa443e56196fdfa"><div>Careers</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://www.zellic.io/contact"><div>Contact</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div></div></div><div class="GridElement03_WnBa"><div><h4 class="SiteNavHeader_RIGK">What we do</h4></div><div class="SiteFooterNavMenu_HKVq"><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://www.zellic.io/our-work"><div>Our work</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://www.zellic.io/team"><div>Research</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="http://reports.zellic.io/"><div>Reports</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="http://forky.zellic.io/"><div>Forky</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div></div></div><div class="GridElement04_yLDw"><div><h4 class="SiteNavHeader_RIGK">Follow us</h4></div><div class="SiteFooterNavMenu_HKVq"><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://t.me/zellic_io"><div>Telegram</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://twitter.com/zellic_io"><div>Twitter</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://github.com/zellic/"><div>GitHub</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div></div></div></div></div></div><div class="SiteFooterPadding_uM5k"><div class="SiteFooterContainer_L2Ui"><div class="FooterLine_o9F8"></div><div class="SiteFooter02Section_Nwo6"><div class="Attribution_dyY9">Zellic © 2024</div><div class="SiteFooterNavMenu_HKVq"><div class="SiteFooterNavMenuItem_gShy"><a class="SiteFooterNavMenuLink_CTL3" href="https://www.zellic.io/privacy-policy"><div>Privacy policy</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↗</span></div></a></div></div><div class="SiteFooterNavMenu_HKVq HideMobile_MsSG"></div><div class="SiteFooterNavMenu_HKVq"><div style="text-align:right"><a class="SiteFooterNavMenuLink_CTL3 SiteBackToTop_znOA" href="https://www.zellic.io/blog/the-vulnerabilities-youll-write-with-anchor/#MainPage"><div>Back to top</div><div class="FooterLinkIcon_pQr2"><span class="FooterLinkIconSpan_Vq5h">↑</span></div></a></div></div></div></div></div></div></footer></div>
<script defer="" src="./The Vulnerabilities You’ll Write With Anchor _ Zellic — Research_files/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;960f676f8b90180f&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfEdge&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.7.0&quot;,&quot;token&quot;:&quot;5e5d1d617c154a26b733e9cf662bffc3&quot;}" crossorigin="anonymous"></script>

</body></html>