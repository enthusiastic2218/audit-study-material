"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8350"],{7149:function(){},66824:function(e,t,n){n.d(t,{Z:()=>o});let o={container:"container-D8CZbL","videoContainer-clip":"videoContainer-clip-KcDC9v",videoContainerClip:"videoContainer-clip-KcDC9v",videoContainerWrapper:"videoContainerWrapper-VrqlAM",videoIcon:"videoIcon-JWfwBB",videoContainer:"videoContainer-S7toSI",video:"video-dep_Pc",fullScreenContainer:"fullScreenContainer-oPOI4W","playerContainer-vertical":"playerContainer-vertical-nqZGWC",playerContainerVertical:"playerContainer-vertical-nqZGWC","playerContainer-landscape":"playerContainer-landscape-R9mTfd",playerContainerLandscape:"playerContainer-landscape-R9mTfd","playerContainer-vertical_fit":"playerContainer-vertical_fit-j9atXq",playerContainerVerticalFit:"playerContainer-vertical_fit-j9atXq","videoContainer-vertical_fit":"videoContainer-vertical_fit-ku5xgX",videoContainerVerticalFit:"videoContainer-vertical_fit-ku5xgX","video-vertical_fit":"video-vertical_fit-aJ3XQJ",videoVerticalFit:"video-vertical_fit-aJ3XQJ","playerContainer-vertical_fill":"playerContainer-vertical_fill-As6E90",playerContainerVerticalFill:"playerContainer-vertical_fill-As6E90","videoContainer-vertical_fill":"videoContainer-vertical_fill-pCmPd2",videoContainerVerticalFill:"videoContainer-vertical_fill-pCmPd2","video-vertical_fill":"video-vertical_fill-UOGFke",videoVerticalFill:"video-vertical_fill-UOGFke",videoPlayer:"videoPlayer-ySwQUq",generateClips:"generateClips-qHOZUt",spinner:"spinner-FpLDBB",backDrop:"backDrop-EWGPYa",downloadModal:"downloadModal-SupuMR"}},36671:function(e,t,n){n.d(t,{Z:()=>a});var o=n(16584),r=n(30396);let a=e=>{let{min:t,max:n,step:a,value:i,onChange:l}=e,s=(0,r.sO)(null),c=(0,r.sO)(null),d=(0,r.I4)(e=>{if(!s.current)return;let{left:o,width:r}=s.current.getBoundingClientRect();l(Math.round((t+Math.max(Math.min(e.clientX-o,r),0)/r*(n-t))/a)*a)},[t,n,a,l]),u=(0,r.I4)(()=>{document.removeEventListener("mousemove",d)},[d]),p=()=>{document.addEventListener("mousemove",d)},h=(i-t)/(n-t)*100;return(0,o.tZ)("div",{className:"range-slider-bhPvhQ",ref:s,onMouseDown:p,onMouseUp:u,onBlur:u,children:(0,o.BX)("div",{className:"range-slider__rail-P4vlSM",children:[(0,o.tZ)("div",{className:"range-slider__track-Q9dod1",style:{width:"".concat(h,"%")}}),(0,o.tZ)("div",{className:"range-slider__thumb-SArpZE",style:{left:"".concat(h,"%")},ref:c,onMouseDown:p})]})})}},86374:function(e,t,n){n.d(t,{Z:()=>s});var o=n(7409),r=n(99282),a=n(98848),i=n(16584),l=n(64515);let s=e=>{var{size:t=18,color:n="var(--color-fg-primary)",className:s}=e,c=(0,a._)(e,["size","color","className"]);return(0,i.tZ)(l.l,(0,r._)((0,o._)({},c),{name:"DropdownIcon",svgParams:{viewBox:"0 0 20 20"},stroke:"none",width:t,height:t,fill:n,className:s,children:(0,i.tZ)("path",{d:"M5.72845 8.252C5.25083 7.59067 5.72336 6.6665 6.53913 6.6665H13.461C14.2767 6.6665 14.7493 7.59067 14.2716 8.25199L10.8107 13.044C10.4116 13.5967 9.58852 13.5967 9.18936 13.044L5.72845 8.252Z",stroke:"none"})}))}},43148:function(e,t,n){n.d(t,{H:()=>u,o:()=>d});var o=n(16584),r=n(98661),a=n(30396),i=n(15771),l=n(19081),s=n(58175),c=n(12811);let d=(0,r.forwardRef)((e,t)=>{let{onClick:n,children:r,disabled:a=!1,size:l="md"}=e;return(0,o.tZ)(i.GI,{ref:t,rounded:!0,onClick:n,disabled:a,size:l,children:r})}),u=e=>{let{label:t,children:n}=e,[r,i]=(0,a.eJ)(!1);return(0,o.BX)(l.gq,{gap:8,justifyContent:"center",alignItems:"center",children:[t&&(0,o.tZ)(l.gq,{bg:"glass-inverted-medium",justifyContent:"center",alignItems:"center",radius:"sm",paddingY:6,paddingX:8,className:c.Z.verticalMenuLabel,style:{opacity:+!!r},children:(0,o.tZ)(s.xv.B4,{color:"white",children:t})}),(0,o.tZ)("div",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:n})]})}},73410:function(e,t,n){n(98661)},63018:function(e,t,n){n.d(t,{OV:()=>s,_I:()=>l});var o=n(7409),r=n(98848),a=n(69241),i=n(48980);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;var{deps:l,auto:s=!0,massage:c=async e=>e,shouldRevalidate:d=!0}=t,u=(0,r._)(t,["deps","auto","massage","shouldRevalidate"]);return(0,a.ZP)(s?l?[...l,e]:e:null,()=>(0,i.rd)(e,u).then(c),(0,o._)({},d?null:{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1},n))}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var{deps:n}=t,o=(0,r._)(t,["deps"]);(0,a.MA)(n?[...n,e]:e,()=>(0,i.rd)(e,o))}},70717:function(e,t,n){n.d(t,{w:()=>l});var o=n(16584),r=n(19081),a=n(58175),i=n(84864);let l=e=>{let{duration:t,icon:n,position:l="bottom-left",previewDuration:s}=e;return(0,o.BX)(r.gq,{alignItems:"center",bg:"glass-inverted-medium",gap:6,paddingX:8,paddingY:2,position:"absolute",radius:"sm",style:"bottom-left"===l?{left:8,bottom:8}:{right:8,bottom:8},children:[n,(0,o.tZ)(a.xv.Meta,{color:"white",lineHeight:20,children:s?"".concat((0,i.secondsToHHMMSS)(s)," / ").concat((0,i.secondsToHHMMSS)(null!=t?t:0)):(0,i.secondsToHHMMSS)(null!=t?t:0)})]})}},87185:function(e,t,n){n.d(t,{m:()=>i});var o=n(16584),r=n(82876),a=n(17688);let i=e=>{let{details:t,helpText:n,label:i,name:l,options:s,paddingBottom:c,paddingTop:d,flex:u,value:p,disabled:h,onChange:f}=e;return(0,o.tZ)(r.g,{label:i,details:t,helpText:n,paddingTop:d,paddingBottom:c,flex:u,wrapWithLabel:!0,children:(0,o.tZ)(a.i,{name:l,value:p,onChange:e=>{let t=e.target;f(t.value,{name:t.name})},disabled:h,children:s.map(e=>(0,o.tZ)("option",{value:e.value,children:e.label},e.value))})})}},6630:function(e,t,n){n.d(t,{Z:()=>d});var o=n(16584),r=n(94184),a=n.n(r),i=n(15771),l=n(19081),s=n(58175),c=n(87089);let d=e=>{let{options:t,value:n,onChange:r}=e;return(0,o.tZ)(l.gq,{gap:4,children:t.map(e=>{let t="string"==typeof e?e:e.value;return(0,o.tZ)(u,{onClick:()=>{r(t)},selected:t===n,children:"string"==typeof e?e:(0,o.BX)(l.gq,{alignItems:"center",gap:8,paddingY:4,children:[e.icon?e.icon:null,e.label]})},t)})})},u=e=>{let{children:t,selected:n,onClick:r}=e;return(0,o.tZ)(i.kG,{resetCss:!0,onClick:r,children:(0,o.tZ)(s.xv.B4,{className:a()(c.Z.pill,{[c.Z.pillSelected]:n}),children:t})})}},61527:function(e,t,n){n.d(t,{Vo:()=>_,ql:()=>B,to:()=>S});var o=n(16584),r=n(30396),a=n(61649),i=n(68833),l=n(98422),s=n(19081),c=n(28797),d=n(49233),u=n(90630),p=n(63587),h=n(32782),f=n(84945),m=n(76671),v=n(68260),g=n(30730),b=n(27420),C=n(91189),Z=n(6511),y=n(73798);let _=e=>{var t,n,_,S;let{autoPlayMuted:B,forLiveStream:w=!1,disableSharing:T=!1,disableShortcuts:x=!1,disableTooltips:N=!1,disableCaptions:I=!1,duration:R,handle:L,hasPaywall:E=!1,hasTranscript:O=!1,hideNextVideoButton:X=!1,hidePip:U=!1,hideCaptions:k=!1,hideSettings:q=!1,isActive:F,isAudio:D=!1,isFocused:M,mediaRef:W,mediaUpload:A,podcastUpload:H,post:P,pub:Y,showPaywall:V,showTranscript:G,size:j="md",onShareMenuClose:J,onShareMenuOpen:z,onToggleShowTranscript:K,onBlur:Q,hoverOptions:$}=e,{transition:ee=.5,transitionDelay:et=.1}=null!=$?$:{},{isClipping:en}=(0,a.Sr)(),{isMobile:eo}=(0,l.v9)(),er=F&&!V,ea=(0,r.sO)(null),[ei,el]=(0,r.eJ)(!1),[es,ec]=(0,r.eJ)(!1),[ed,eu]=(0,r.eJ)(null),ep=e=>{let{current:t}=W;t&&(t.isShowingCaptionsElsewhere=e),ec(e)};(0,r.d4)(()=>{(en||B)&&eh({showCaptions:!0,userInitiated:!1})},[en,B]);let eh=e=>{let{showCaptions:t,userInitiated:n}=e;ep(t),t&&(null==ef?void 0:ef.length)&&ef[0]&&(eu(ef[0].language),n&&(0,i.j)(i.FP.VIDEO_CLOSED_CAPTIONS_BUTTON_CLICKED,{language:ef[0].language}))};(0,r.d4)(()=>{er||el(!1)},[er]);let ef=null!==(_=null==H?void 0:null===(t=H.transcription)||void 0===t?void 0:t.signed_captions)&&void 0!==_?_:[],em=!!(null==H?void 0:null===(n=H.transcription)||void 0===n?void 0:n.approved_at);return(0,o.BX)("div",{ref:ea,style:{zIndex:en?10:+!!ei},onBlur:Q,children:[(null==L?void 0:L.active)?(0,o.tZ)("div",{className:y.Z.topOverlaysContainer,style:{opacity:+!!er,transform:er||eo?"translateY(0)":"translateY(-20%)"},children:(0,o.BX)(s.gq,{justifyContent:"space-between",paddingBottom:32,children:[(0,o.tZ)(s.gq,{padding:16}),(0,o.tZ)(s.gq,{padding:16})]})}):null,(0,o.tZ)("div",{}),(0,o.tZ)("div",{className:y.Z.settingsControlsContainer,style:{opacity:ei&&er?1:0,pointerEvents:ei?"auto":"none"},children:(0,o.BX)(s.tu,{children:[(0,o.tZ)(s.gq,{className:y.Z.settingsControlsBox,children:(0,o.tZ)(g.Z,{hideSharePostAtCurrentTime:D,mediaRef:W,post:P,pub:Y,podcastUpload:H,subtitles:ed,setSubtitles:e=>{eu(e),!e&&es?ep(!1):e&&!es&&ep(!0)},setIsSettingsOpen:el})}),(0,o.tZ)("div",{style:{height:"60px"}})]})}),(0,o.BX)("div",{className:y.Z.bottomControlsContainer,style:{transform:er||eo?"translateY(0)":"translateY(40px)",transition:"transform ".concat(ee,"s ease"),transitionDelay:"".concat(et,"s")},children:[(0,o.tZ)("div",{className:y.Z.backDrop,style:{opacity:+!!er}}),(0,o.BX)(s.tu,{flex:"grow",gap:8,paddingY:4,children:[W.current&&H&&!E&&L&&A&&!I&&(0,o.tZ)("div",{className:y.Z.captionsContainer,children:(0,o.tZ)(c.Z,{handle:L,mediaUpload:H,showCaptions:es,size:j,subtitles:ed,videoEle:null!==(S=W.current.player)&&void 0!==S?S:null,withHighlight:en})}),(0,o.tZ)("div",{className:y.Z.bottomInnerControlsContainer,style:{opacity:+!!er,transition:void 0!=ee?"opacity ".concat(ee,"s ease"):"opacity 0.5s ease"},children:(0,o.BX)(s.tu,{flex:"grow",children:[!w&&(0,o.tZ)(s.gq,{flex:"grow",paddingBottom:4,children:(0,o.tZ)(b.T,{disableSharing:D||T,mediaRef:W,mediaUpload:A,post:P,pub:Y,size:j,onShareMenuClose:J,onShareMenuOpen:z})}),(0,o.BX)(s.gq,{paddingX:4,children:[(0,o.BX)(s.hs,{gap:8,alignItems:"center",children:[!w&&(0,o.tZ)(m.Z,{disableShortcuts:x,disableTooltips:N,isFocused:M,mediaRef:W}),!X&&(null==A?void 0:A.post_id)&&(0,o.tZ)(p.Z,{disableShortcuts:x,isFocused:M,postId:A.post_id,pub:Y}),(0,o.tZ)(Z.Z,{disableShortcuts:x,disableTooltips:N,isFocused:M,mediaRef:W}),!w&&(0,o.tZ)(f.Z,{duration:D&&null!=R?R:null,mediaRef:W})]}),(0,o.tZ)(s.hs,{flex:"grow"}),(0,o.BX)(s.hs,{gap:8,alignItems:"center",children:[!D&&K&&!w&&(0,o.tZ)(C.Z,{disableShortcuts:x,disableTooltips:N,disabled:E||!O,isFocused:M,showTranscript:null!=G&&G,onToggleShowTranscript:K}),!D&&!k&&!w&&(0,o.tZ)(d.Z,{disableShortcuts:x,disableTooltips:N,disabled:!em||E,isFocused:M,setShowCaptions:eh,showCaptions:es}),!D&&!U&&(0,o.tZ)(h.Z,{disableShortcuts:x,disableTooltips:N,isFocused:M,mediaRef:W}),!D&&L&&(0,o.tZ)(u.Z,{disableShortcuts:x,disableTooltips:N,handle:L,isFocused:M}),!w&&!q&&(0,o.tZ)(v.Z,{disableTooltips:N,isSettingsOpen:ei,setIsSettingsOpen:el})]})]})]})})]})]})]})},S=e=>{var t,n,a,p,h,v;let{mediaRef:g,mediaUpload:C,handle:_,isActive:S,pub:B,size:w="sm",startTime:T,duration:x,useCaptions:N=!1,captionsStyle:I,hoverOptions:R,onBlur:L}=e,{transition:E=.5,transitionDelay:O=.1}=null!=R?R:{},{isMobile:X}=(0,l.v9)(),U=(0,r.sO)(null),[k,q]=(0,r.eJ)(!1),[F,D]=(0,r.eJ)(null),M=null!==(h=null==C?void 0:null===(n=C.extractedAudio)||void 0===n?void 0:null===(t=n.transcription)||void 0===t?void 0:t.signed_captions)&&void 0!==h?h:[],W=!!(null==C?void 0:null===(p=C.extractedAudio)||void 0===p?void 0:null===(a=p.transcription)||void 0===a?void 0:a.approved_at);return(0,r.d4)(()=>{let e=()=>{var e;(null===(e=g.current)||void 0===e?void 0:e.player)&&!isNaN(g.current.player.duration)&&(g.current.player.currentTime=T)};if(g.current){var t;null===(t=g.current.player)||void 0===t||t.addEventListener("durationchange",e)}return()=>{if(g.current){var t;null===(t=g.current.player)||void 0===t||t.removeEventListener("durationchange",e)}}},[g]),(0,o.BX)("div",{ref:U,onBlur:L,children:[(null==_?void 0:_.active)?(0,o.tZ)("div",{className:y.Z.topOverlaysContainer,style:{opacity:+!!S,transform:S||X?"translateY(0)":"translateY(-20%)"},children:(0,o.BX)(s.gq,{justifyContent:"space-between",paddingBottom:32,children:[(0,o.tZ)(s.gq,{padding:16}),(0,o.tZ)(s.gq,{padding:16})]})}):null,g.current&&(null==C?void 0:C.extractedAudio)&&_&&N&&(0,o.tZ)("div",{className:y.Z.captionsContainer,style:{bottom:0},children:(0,o.tZ)(c.Z,{handle:_,mediaUpload:C.extractedAudio,showCaptions:k,size:w,subtitles:F,videoEle:null!==(v=g.current.player)&&void 0!==v?v:null,captionsStyle:I,withHighlight:!0})}),(0,o.BX)("div",{className:y.Z.bottomControlsContainer,style:{transform:S||X?"translateY(0)":"translateY(40px)",transition:void 0!=E?"transform ".concat(E,"s ease"):"transform 0.5s ease",transitionDelay:void 0!=O?"".concat(O,"s"):"0.1s"},children:[(0,o.tZ)("div",{className:y.Z.backDrop,style:{opacity:+!!S}}),(0,o.tZ)(s.tu,{flex:"grow",gap:8,paddingY:4,children:(0,o.tZ)("div",{className:y.Z.bottomInnerControlsContainer,style:{opacity:+!!S,transition:void 0!=E?"opacity ".concat(E,"s ease"):"opacity 0.5s ease"},children:(0,o.BX)(s.tu,{flex:"grow",children:[(0,o.tZ)(s.gq,{flex:"grow",paddingBottom:4,children:(0,o.tZ)(b.T,{disableSharing:!0,mediaRef:g,mediaUpload:C,post:void 0,pub:B,size:"sm",startTime:T,endTime:x?T+x:void 0})}),(0,o.BX)(s.gq,{paddingX:4,children:[(0,o.BX)(s.hs,{gap:8,alignItems:"center",children:[(0,o.tZ)(m.Z,{disableShortcuts:!0,disableTooltips:!0,isFocused:!1,mediaRef:g}),(0,o.tZ)(Z.Z,{disableShortcuts:!0,disableTooltips:!0,isFocused:!1,mediaRef:g}),(0,o.tZ)(f.L,{startTime:T,duration:null!=x?x:null,mediaRef:g})]}),(0,o.tZ)(s.hs,{flex:"grow"}),(0,o.tZ)(d.Z,{disableShortcuts:!0,disableTooltips:!0,disabled:!W,setShowCaptions:e=>{let{showCaptions:t,userInitiated:n}=e;q(t),t&&(null==M?void 0:M.length)&&M[0]&&(D(M[0].language),n&&(0,i.j)(i.FP.VIDEO_CLOSED_CAPTIONS_BUTTON_CLICKED,{language:M[0].language}))},showCaptions:k,isFocused:!1}),_&&(0,o.tZ)(u.Z,{disableShortcuts:!0,disableTooltips:!0,handle:_,isFocused:!1})]})]})})})]})]})},B=e=>{let{mediaRef:t,mediaUpload:n,isActive:a,pub:i,startTime:c,duration:d,hoverOptions:u,onBlur:p}=e,{transition:h=.5,transitionDelay:v=.1}=null!=u?u:{},{isMobile:g}=(0,l.v9)(),C=(0,r.sO)(null);return(0,r.d4)(()=>{let e=()=>{var e;(null===(e=t.current)||void 0===e?void 0:e.player)&&!isNaN(t.current.player.duration)&&(t.current.player.currentTime=c)};if(t.current){var n;null===(n=t.current.player)||void 0===n||n.addEventListener("durationchange",e)}return()=>{if(t.current){var n;null===(n=t.current.player)||void 0===n||n.removeEventListener("durationchange",e)}}},[t]),(0,o.tZ)("div",{ref:C,onBlur:p,children:(0,o.BX)("div",{className:y.Z.bottomControlsContainer,style:{transform:a||g?"translateY(0)":"translateY(40px)",transition:"transform ".concat(h,"s ease"),transitionDelay:"".concat(v,"s")},children:[(0,o.tZ)("div",{className:y.Z.backDrop,style:{opacity:+!!a}}),(0,o.tZ)(s.tu,{flex:"grow",gap:8,paddingY:4,children:(0,o.tZ)("div",{className:y.Z.bottomInnerControlsContainer,style:{opacity:+!!a,transition:void 0!=h?"opacity ".concat(h,"s ease"):"opacity 0.5s ease"},children:(0,o.BX)(s.tu,{flex:"grow",children:[(0,o.tZ)(s.gq,{flex:"grow",paddingBottom:4,children:(0,o.tZ)(b.T,{disableSharing:!0,mediaRef:t,mediaUpload:n,post:void 0,pub:i,size:"sm",startTime:c,endTime:d?c+d:void 0})}),(0,o.BX)(s.gq,{paddingX:4,children:[(0,o.BX)(s.hs,{gap:8,alignItems:"center",children:[(0,o.tZ)(m.Z,{disableShortcuts:!0,disableTooltips:!0,isFocused:!1,mediaRef:t}),(0,o.tZ)(Z.Z,{disableShortcuts:!0,disableTooltips:!0,isFocused:!1,mediaRef:t}),(0,o.tZ)(f.L,{startTime:c,duration:null!=d?d:null,mediaRef:t})]}),(0,o.tZ)(s.hs,{flex:"grow"})]})]})})})]})})}},86551:function(e,t,n){n.d(t,{BN:()=>w,F2:()=>B,Fp:()=>I,HQ:()=>_,Lb:()=>y,S_:()=>T,T6:()=>O,U0:()=>Z,Ui:()=>E,aZ:()=>R,op:()=>N,pw:()=>x,sj:()=>S,tX:()=>L});var o=n(58865),r=n(60826),a=n(68833),i=n(60308),l=n(63651),s=n(84864),c=n(47929),d=n(68303),u=n(39947);function p(){let e=(0,o._)(["Start writing today. Use the button below to create a Substack of your own"]);return p=function(){return e},e}function h(){let e=(0,o._)(["Share ",""]);return h=function(){return e},e}function f(){let e=(0,o._)(["Get ","% off a group subscription"]);return f=function(){return e},e}function m(){let e=(0,o._)(["Get a group subscription"]);return m=function(){return e},e}function v(){let e=(0,o._)(["Give a gift subscription"]);return v=function(){return e},e}function g(){let e=(0,o._)(["","! Subscribe for free to receive new posts and support my work."]);return g=function(){return e},e}function b(){let e=(0,o._)(["",". To receive new posts and support my work, consider becoming a free or paid subscriber."]);return b=function(){return e},e}function C(){let e=(0,o._)(["","! This post is public so feel free to share it."]);return C=function(){return e},e}let Z=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a={url:"".concat(r.W.CHECKOUT_URL,"&donate=true"),text:o("Donate Subscriptions")};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(a))),!0},y=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a={url:"".concat(r.W.LEADERBOARD_URL,"&utm_source=").concat(c.b3.post),text:o("Refer a friend")};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(a))),!0},_=e=>{let{writerReferralCode:t,publication:n,postId:o}=e;return(e,r)=>{let{iString:a,iTemplate:l}=I18N.i({pub:n});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!e.schema.nodes.captionedWriterReferralButton)return console.error("captionedWriterReferralButton node type not found in schema"),!1;if(!e.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,u.o)(e,e.schema.nodes.button))return!1;let s=l(p()),h={url:"".concat((0,i.Fnz)(t||""),"?utm_source=").concat(c.b3.substack,"&utm_context=").concat(c.gD.post,"&utm_content=").concat(o,"&utm_campaign=").concat(c.VX.writerReferralButton),text:a("Start a Substack")},f=e.schema.nodes.captionedWriterReferralButton.create(h,e.schema.nodes.ctaCaption.create(null,[e.schema.text(s)]));return r&&r((0,d.o4)(e,f)),!0}},S=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a={url:r.W.HALF_MAGIC_COMMENTS_URL,text:o("Leave a comment")};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(a))),!0},B=(e,t,n)=>(o,r)=>{if((0,a.j)(a.FP.READER_SURVEY_LINKED_IN_POST,{editorVersion:"1",surveyId:t.id}),!o.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(o,o.schema.nodes.button))return!1;let i={url:"".concat((0,l.h8g)(e,t.id)),text:n};return r&&r((0,d.o4)(o,o.schema.nodes.button.create(i))),!0},w=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a={url:r.W.SHARE_URL,text:o("Share")};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(a))),!0},T=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a={url:r.W.SHARE_PUB_URL,text:o(h(),e.name)};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(a))),!0},x=e=>{let{couponPub:t,scrollParent:n,parentClass:o,get_coupons:r,insert_coupon:a,SelectField:l,openPrompt:s,closePrompt:c,getNetworkErrorMessage:d}=e;return(e,p,h)=>{let{iString:f}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(e,e.schema.nodes.button))return!1;let m={parentClass:o,root:n?document.querySelector(".".concat(n)):h.dom.parentNode,scrollParent:n,offsetTop:10},v=Object.assign({title:f("Loading..."),no_buttons:!0,language:t.language},m);return s(v),r().then(n=>{c(v);let o=n.map(e=>{var t;return{label:null!==(t=e.name)&&void 0!==t?t:"",value:e}}).concat([{label:f("Create new offer"),value:{create_new:!0}}]),r={coupon:new l({label:f("Select offer..."),required:!0,options:o,onChange:e=>{e&&"create_new"in e&&e.create_new&&(c(d),window.open("".concat((0,i.SVA)(t),"/publish/offers"),"_blank"))}})},d=Object.assign({title:f("Special Offer"),fields:r,language:null==t?void 0:t.language,onSubmit:t=>{let{coupon:n}=t;a({coupon:n,state:e,dispatch:h.dispatch,schema:e.schema})},onClose:()=>{h.focus()}},m);s(d)}).catch(e=>{c(v),alert(d(e))}),!1}},N=e=>{let{scrollParent:t,parentClass:n,TextField:o,openPrompt:r,publication:a}=e;return(e,i,l)=>{let{iString:s}=I18N.i({pub:a});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(e,e.schema.nodes.button))return!1;let c={parentClass:n,title:s("Create a button"),root:t?document.querySelector(".".concat(t)):l.dom.parentNode,scrollParent:t,offsetTop:10,language:null==a?void 0:a.language,fields:{text:new o({label:s("Enter text..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(e.length>40)return s("Too long")}}),href:new o({label:s("Enter URL..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(!/^%%.*%%$/.test(e)){try{let t=new URL(e);if(["http:","https:","mailto:"].includes(t.protocol))return}catch(e){}return s("Invalid URL")}}})}};return c.onSubmit=t=>{let n={url:t.href,text:t.text};if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;i&&l.dispatch((0,d.o4)(e,e.schema.nodes.button.create(n)))},c.onClose=()=>{l.focus()},r(c),!0}},I=e=>{let{publication:t}=e;return(e,n)=>{let{iTemplate:o}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(e,e.schema.nodes.button))return!1;let a=t.default_group_coupon,i={url:"".concat(r.W.CHECKOUT_URL,"group=true").concat(a?"&coupon=".concat(a):""),text:(0,s.getSubscriptionSentenceWithCustomWords)(t,()=>{var e;return a&&t.default_group_coupon_percent_off?o(f(),null!==(e=t.default_group_coupon_percent_off.split(".")[0])&&void 0!==e?e:""):o(m())},e=>a&&t.default_group_coupon_percent_off?"Get ".concat(t.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(e.subscription):"Get a group ".concat(e.subscription))};return n&&n((0,d.o4)(e,e.schema.nodes.button.create(i))),!0}},R=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a={url:"".concat(r.W.CHECKOUT_URL,"&gift=true"),text:(0,s.getSubscriptionSentenceWithCustomWords)(e,()=>o(v()),e=>"Give a gift ".concat(e.subscription))};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(a))),!0},L=e=>(t,n)=>{if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let o={url:r.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e,{now:!0}),language:e.language};return n&&n((0,d.o4)(t,t.schema.nodes.button.create(o))),!0},E=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.subscribeWidget)return console.error("subscribeWidget node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let a="enabled"!==e.payments_state?o(g(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)):o(b(),e.author_name===e.name?"This Substack is reader-supported":"".concat(e.name," is a reader-supported publication")),i={url:r.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e),language:e.language},l=t.schema.nodes.subscribeWidget.create(i,[t.schema.nodes.ctaCaption.create(null,[t.schema.text(a)])]);return n&&n((0,d.o4)(t,l)),!0},O=e=>(t,n)=>{let{iString:o,iTemplate:a}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.captionedShareButton)return console.error("captionedShareButton node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,u.o)(t,t.schema.nodes.button))return!1;let i=a(C(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)),l={url:r.W.SHARE_URL,text:o("Share")},s=t.schema.nodes.captionedShareButton.create(l,t.schema.nodes.ctaCaption.create(null,[t.schema.text(i)]));return n&&n((0,d.o4)(t,s)),!0}},57208:function(e,t,n){n.d(t,{f2:()=>a});var o=n(68303);let r=e=>!(0,o.DY)(e.doc.toJSON(),e=>"paywall"===e.type),a=e=>(t,n)=>{if(!r(t))return!1;let{schema:o,tr:a}=t,l=o.nodes.paywall.create();return 1===a.selection.anchor?i(e)(t,n):(a.insert(a.selection.anchor,l),n&&(n(a),e()),!0)},i=e=>(t,n)=>{if(!r(t))return!1;let{schema:o,tr:a}=t,i=o.nodes.paywall.create(),l=0,s=0;for(;l<10&&s<3;){let e=t.doc.resolve(l).nodeAfter;if(!e)break;l+=e.nodeSize,s++}return a.insert(l,i),n&&(n(a),e()),!0}}}]);