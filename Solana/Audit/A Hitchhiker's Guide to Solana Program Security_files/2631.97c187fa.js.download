"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["2631"],{75983:function(e,t,n){n.d(t,{Z:()=>i});let i={avatarButton:"avatarButton-lZBlGB",dropdownBadge:"dropdownBadge-CARUw5",dropdown:"dropdown-caGYVq"}},30351:function(e,t,n){n.d(t,{Z:()=>i});let i={signInAppUpsell:"signInAppUpsell-u9SVL0",isDesktop:"isDesktop-_mI6rc",appDownloadButton:"appDownloadButton-Lbsixg",qrContainer:"qrContainer-ApUIIX",qrCode:"qrCode-f8T8_u"}},7083:function(e,t,n){n.d(t,{Z:()=>i});let i={avatarLink:"avatarLink-M6ZJnW",inlineComposer:"inlineComposer-v8PLSi",disabled:"disabled-YAsoUi",mobileInlineComposer:"mobileInlineComposer-jKgh_1",isDragging:"isDragging-TcoucF",floatingComposer:"floatingComposer-np5rUF",inputSpacer:"inputSpacer-x19EDg",wordCountIndicator:"wordCountIndicator-KkYqEv",exceded:"exceded-x1z6ce",composerModal:"composerModal-q2ZgZt",setupProfileModalContent:"setupProfileModalContent-IhiQBI",modalColumn:"modalColumn-qiWdAx",editorContainer:"editorContainer-Lfneza",dropdownIcon:"dropdownIcon-HzL2Jt",dropdownMenu:"dropdownMenu-RAjGgB",pubRow:"pubRow-ZqkbZG",pubName:"pubName-DndaDy",linkImage:"linkImage-VNRJEM",imageContainer:"imageContainer-sSgwnk",imageActions:"imageActions-J_pVYc",removeAttachment:"removeAttachment-lybT5W",shareImageButton:"shareImageButton-O3Fvsx",notifyConformModalPubRow:"notifyConformModalPubRow-929y7D"}},14942:function(e,t,n){n.d(t,{Z:()=>i});let i={modalBody:"modalBody-yrSvJm",captcha:"captcha-awCBm5"}},15345:function(e,t,n){n.d(t,{Pp:()=>k,Gi:()=>x});var i=n(16584),r=n(6400);n(98661);var o=n(30396),a=n(19425),l=n(94184),d=n.n(l),c=n(25380),s=n(71375),u=n(57560),p=n(23254),h=n(20888),m=n(95441),g=n(68833),f=n(15771),Z=n(19081),v=n(58175),y=n(75419),w=n(60308),C=n(9799);let _={shimmer:"shimmer-DF054A",icon:"icon-kVFYHC",errorIcon:"errorIcon-yltUsD"},b=()=>(0,i.tZ)(Z.gq,{radius:"full",className:_.shimmer,style:{height:"var(--size-6)",width:"100%"}}),I=(0,r.createContext)({addMediaUpload:e=>{let{}=e;throw Error("Adding a download requires a DownloadProvider.")},markAsDownloaded:()=>{throw Error("Marking as downloaded requires a DownloadProvider.")},hasBeenDownloaded:()=>{throw Error("Checking download status requires a DownloadProvider.")}}),B=e=>{var t;let{context:n,download:{mediaUpload:r,title:a,thumbnailUrl:l,source:I},pub:B,onRemoveItem:k}=e,{markAsDownloaded:P,hasBeenDownloaded:D}=x(),{iString:S}=(0,m.M1)(),{mediaUpload:M,downloadUrl:X}=(0,p.f8)(r.id),A=(0,y.i3)(),L=(null==M?void 0:M.state)==="error";(0,o.d4)(()=>{X&&M&&!D(r.id)&&((0,C.I)(M,a),P(r.id),(0,g.j)(g.FP.MEDIA_CLIP_DOWNLOAD_COMPLETED,{video_upload_id:r.id,is_post_editor:!1,type:I}))},[r.id,X,M,D,P,I,a]);let N=(0,o.I4)(e=>{e.preventDefault(),(0,g.j)(g.FP.MEDIA_CLIP_BUTTON_CLICKED,{button:"share_to_notes",source:"download_toast"});let t="publisher"===n?"".concat(S("Subscribe to get the full video when it's released."),"\n"):"";A.open({initialText:"".concat(t),videoUploadId:r.id,onCompose:e=>{(0,g.j)(g.FP.MEDIA_CLIP_SHARED,{destination:"notes",note_id:e.id,video_upload_id:r.id,is_post_editor:"publisher"===n})}})},[A,n,S,r.id,B]);return(0,i.BX)(Z.gq,{gap:16,children:[(0,i.tZ)("div",{children:(0,i.BX)(Z.gq,{position:"relative",children:[(0,i.tZ)(h.e,{src:null!==(t=null!=l?l:(0,w.kOB)(r))&&void 0!==t?t:"",maxWidth:40,radius:"xs",imageProps:{height:Math.round(40),smartCrop:!0}}),X&&(0,i.tZ)(Z.hs,{bg:"white",radius:"full",width:20,height:20,position:"absolute",alignItems:"center",justifyContent:"center",className:_.icon,children:(0,i.tZ)(c.Z,{color:"black",strokeWidth:2,size:14})}),L&&(0,i.tZ)(Z.hs,{radius:"full",width:20,height:20,position:"absolute",alignItems:"center",justifyContent:"center",className:d()(_.icon,_.errorIcon),children:(0,i.tZ)(s.Z,{color:"white",strokeWidth:2,size:14})})]})}),(0,i.BX)(Z.tu,{gap:8,children:[(0,i.BX)(Z.gq,{gap:12,children:[(0,i.BX)(Z.gq,{style:{width:"250px"},alignItems:"center",gap:8,children:[(0,i.BX)(Z.tu,{flex:"grow",children:[(0,i.tZ)(v.xv.B4,{color:"white",weight:"semibold",style:{overflowWrap:"anywhere"},children:a}),X?(0,i.tZ)(v.xv.B4,{color:"white",children:S("Complete")}):(0,i.BX)(v.xv.B4,{color:"white",children:[S("Downloading clip"),"â€¦"]}),L&&(0,i.tZ)(v.xv.B4,{color:"error",weight:"semibold",style:{overflowWrap:"anywhere"},children:S("Download failed")})]}),X&&(0,i.tZ)(f.zx,{leading:(0,i.tZ)(u.Z,{size:16}),priority:"primary",size:"sm",onClick:N,children:S("Share")})]}),(0,i.tZ)(Z.gq,{cursor:"pointer",onClick:e=>{e.stopPropagation(),k()},children:(0,i.tZ)(s.Z,{color:"gray"})})]}),X||L?null:(0,i.tZ)(b,{})]})]})};function k(e){let{children:t,pub:n,context:r}=e,[l,d]=(0,o.eJ)([]),[c,s]=(0,o.eJ)(new Set);return(0,i.BX)(I.Provider,{value:{addMediaUpload:e=>{d(t=>[...t,e])},markAsDownloaded:e=>{s(t=>{let n=new Set(t);return n.add(e),n})},hasBeenDownloaded:e=>c.has(e)},children:[t,!!l.length&&(0,i.tZ)("div",{style:{position:"fixed",right:"var(--size-24)",bottom:"var(--size-24)",zIndex:20},children:(0,i.tZ)(a.u,{show:!0,appear:!0,enter:"tw-transition-all tw-duration-fast transform-gpu",enterFrom:"tw-opacity-0 tw-translate-y-4",enterTo:"tw-opacity-100 tw-translate-y-0",leave:"tw-transition-all tw-duration-fast transform-gpu",leaveFrom:"tw-opacity-100 tw-translate-y-0",leaveTo:"tw-opacity-0 tw-translate-y-4",children:(0,i.tZ)(Z.tu,{style:{backgroundColor:"#232525"},radius:"md",padding:16,gap:8,children:l.map((e,t)=>(0,i.tZ)(B,{context:r,download:e,pub:n,onRemoveItem:()=>d(l.filter(t=>{let{mediaUpload:n}=t;return n.id!==e.mediaUpload.id}))},"".concat(t,"_").concat(e.mediaUpload.id)))})})})]})}function x(){return(0,o.qp)(I)}},51938:function(e,t,n){n.d(t,{V:()=>s});var i=n(16584),r=n(30396),o=n(94184),a=n.n(o),l=n(24202),d=n(19081),c=n(54796);function s(e){let{className:t,assets:n,readOnly:o,onClick:s,maxHeight:p=420,children:h}=e,m=(0,l.dz)(n),[g,f]=(0,r.eJ)(null),Z=(0,r.sO)(null),v=(0,l.yU)(Z,0),[y,w]=m;if(!y||!w)return null;let C=y.width&&y.height?y.width/y.height:1,_=w.width&&w.height?w.width/w.height:1,b=C+_,I=v-6,B=Math.min(p,I/b),k=[I*C/b,I*_/b];return(0,i.BX)(d.hs,{ref:Z,className:a()(c.Z.imageDiptych,t),gap:6,overflow:"hidden",children:[m.map((e,t)=>(0,i.tZ)(u,{asset:e.src,explicit:e.explicit,readOnly:o,width:k[t],height:B,index:t,onClick:o?void 0:n=>{n.preventDefault(),s&&s({attachmentId:e.id,attachmentType:"image"}),f({index:t})},children:h},e.src)),!o&&(0,i.tZ)(l.$9,{assets:m,imageViewer:g,setImageViewer:f,readOnly:o})]})}function u(e){let{asset:t,explicit:n,onClick:r,readOnly:o,width:d=500,height:s,children:u,index:p}=e;return(0,i.tZ)(l.Z4,{asset:t,explicit:n,onClick:r,readOnly:o,width:d,height:s,className:a()(c.Z.diptychImage,c.Z["index-".concat(p+1)]),children:u})}},47348:function(e,t,n){n.d(t,{j:()=>a});var i=n(27412),r=n(7409),o=n(12281);class a extends o.Z{trackMedia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={content_type:"livestream",entity_type:"livestream",primary_entity_type:"livestream",entity_key:String(this.props.liveStreamId),primary_entity_key:String(this.props.liveStreamId)};super.trackMedia(e,(0,r._)({},t,n))}constructor(...e){super(...e),(0,i._)(this,"getBaseVideoSrc",e=>{let t="/api/v1/live_stream/".concat(this.props.liveStreamId),n=new URLSearchParams;return e&&n.append("type",e),n.append("src","true"),this.props.noJoin&&n.append("noJoin","true"),this.props.portrait&&n.append("portrait","true"),"".concat(t,"?").concat(n.toString())}),(0,i._)(this,"onPreviewClick",e=>{var t;this.player&&this.player.duration&&this.player.duration>1&&!isNaN(this.player.duration)&&(null===(t=this.player)||void 0===t?void 0:t.paused)&&(this.player.currentTime=this.player.duration-1),this.player&&this.player.paused&&(this.player.playbackRate=1),super.onPreviewClick(e)}),(0,i._)(this,"refreshVideoSrc",()=>{var e;this.setState({autoPlay:!(null===(e=this.player)||void 0===e?void 0:e.paused)}),n.e("2244").then(n.bind(n,99196)).then(e=>{this._initHlsjsWrapped(e.default)})})}}o.Z},10605:function(e,t,n){n.d(t,{Z:()=>D});var i=n(16584);n(65205);var r=n(15345),o=n(96726),a=n(42347),l=n(57391),d=n(37168),c=n(98585),s=n(95441),u=n(99259),p=n(36848),h=n(93155),m=n(36518),g=n(30372),f=n(85095),Z=n(14952),v=n(39648),y=n(56629),w=n(44471),C=n(40647),_=n(45261),b=n(60807),I=n(70379),B=n(97434),k=n(75419),x=n(64172),P=n(25479);function D(e){let{user:t=null,pub:n=null,children:D,siteConfigs:S={},hasThemedBackground:M=!1,language:X="en",preferredLanguage:A=null,locale:L,country:N,experimentInfo:z={variantOverrides:{},experimentFeatures:{},experimentExposures:{}},portalRoot:E,shouldLoad:T,shouldPollNotifications:q=!1,publicationSettings:j={},userSettings:U,publicationUserSettings:O={},activityToken:F,loadPubClientSearch:Y,enablePubClientSearchShortcuts:J=!0,loadGlobalSearch:V,includePodcasts:R=!1,context:W="reader",isMarketingPage:H=!1,browser:G}=e;void 0===T&&(T=!!t);let K=(0,x.lV)({isLoggedIn:!!t,includePodcasts:R});return(0,i.tZ)(a.At,{browser:G,children:(0,i.tZ)(p.Qu,{country:N||"US",children:(0,i.tZ)(s._7,{language:X||"en",preferredLanguage:A,locale:L,children:(0,i.tZ)(_.ze,{value:{hasThemedBackground:M},children:(0,i.tZ)(C.vC,{siteConfigs:S,children:(0,i.tZ)(l.Vt,{siteConfigs:S,experimentInfo:z,children:(0,i.tZ)(d.ZN,{siteConfigs:S,experimentInfo:z,children:(0,i.tZ)(y.Iz,{settings:j,children:(0,i.tZ)(w.m$,{preloadPubUserSettings:O,children:(0,i.tZ)(m.N$,{shouldLoad:T,shouldPoll:q,activityToken:F,children:(0,i.tZ)(o.X,{root:E,children:(0,i.tZ)(b.dr,{defaultValue:t,userSettings:U,children:(0,i.tZ)(f.am,{children:(0,i.tZ)(u.Nj,{children:(0,i.tZ)(I.VW,{children:(0,i.tZ)(h.DY,{children:(0,i.tZ)(k.Au,{children:(0,i.tZ)(r.Pp,{context:W,pub:n,children:(0,i.tZ)(x.e.Provider,{value:K,children:(0,i.tZ)(B.c,{children:(0,i.tZ)(Z.G5.Provider,{value:n,children:(0,i.tZ)(P.yk,{user:t,children:(0,i.tZ)(c.Ml,{load:V,useLocalNavigation:!H,children:(0,i.tZ)(v.Nx,{load:Y,pub:n,enableShortcuts:J,children:(0,i.tZ)(g.Pi,{children:D})})})})})})})})})})})})})})})})})})})})})})})})})}},29493:function(e,t,n){n.d(t,{Z:()=>l});var i=n(27412),r=n(16584),o=n(6400);let a=!1;"undefined"!=typeof window&&(window.__captchaOnloadCallback=function(){if(a&&Array.isArray(a)){let e=a;for(let t of(a=!0,e))t()}});class l extends o.Component{async componentDidMount(){await new Promise(e=>{!0===a?e():!1===a?(a=[e],function(){var e;let t=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0,n.defer=!0,n.src="https://www.google.com/recaptcha/api.js?render=explicit&onload=__captchaOnloadCallback",null==t||null===(e=t.parentNode)||void 0===e||e.insertBefore(n,t)}()):a.push(e)}),this.captchaId=window.grecaptcha.render(this.base,{sitekey:window._preloads.captcha_site_key,size:"compact"})}getResponse(){var e;return null===(e=window.grecaptcha)||void 0===e?void 0:e.getResponse(this.captchaId)}render(e){let{className:t}=e;return(0,r.tZ)("div",{className:t})}constructor(...e){super(...e),(0,i._)(this,"captchaId",void 0)}}},76721:function(e,t,n){n.d(t,{Z:()=>a});var i=n(30396),r=n(45563),o=n(81821);function a(e){let{truncationProfile:t="medium"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.Ye)(()=>(0,r.X)(e,{truncationProfile:t,isMobile:(0,o.tq)()}),[null==e?void 0:e.body,null==e?void 0:e.body_json])}},33668:function(e,t,n){n.d(t,{e:()=>r});var i=n(30396);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,i.sO)(e);return(0,i.d4)(()=>{var e;null===(e=t.current)||void 0===e||e.focus()},[]),t}},8635:function(e,t,n){n.d(t,{Z:()=>r});var i=n(30396);let r=(e,t)=>{let n=(0,i.sO)();(0,i.d4)(()=>{n.current=e},[e]),(0,i.d4)(()=>{if(null!==t){let e=setInterval(function(){var e;null===(e=n.current)||void 0===e||e.call(n)},t);return()=>clearInterval(e)}},[t])}},17625:function(e,t,n){n.d(t,{o$:()=>Z});var i=n(16584),r=n(94184),o=n.n(r);n(20042);var a=n(83034);n(62956),n(28161),n(32351),n(57391),n(40647);var l=n(68833),d=n(80878);n(59480),n(91700),n(99027);var c=n(19081),s=n(58175);n(91400),n(6070);var u=n(60308),p=n(81821),h=n(47929),m=n(30351);let g=h.VX.appMarketing,f=h.fZ.signInPage;function Z(e){let{abTestingId:t}=e,n=(0,p.s)()?"ios":(0,p.Dt)()?"android":"desktop",r="desktop"===n?180:120;return(0,i.tZ)(c.hs,{padding:20,paddingTop:32,alignItems:"center",justifyContent:"center",children:(0,i.BX)(c.gq,{radius:"lg",border:"detail",className:o()(m.Z.signInAppUpsell,{[m.Z.isDesktop]:"desktop"===n}),paddingX:20,paddingTop:20,gap:20,shadow:"lg",cursor:"pointer",onClick:e=>{(0,l.j)(l.FP.SIGN_IN_APP_UPSELL_CLICKED,{position:"sign-in-page"}),(0,d.Q)(e,(0,u.D4e)({utm_campaign:g,utm_content:f,utm_source:h.b3.upsell}),{native:!0,newTab:!0})},children:[(0,i.BX)(c.tu,{justifyContent:"space-between",flex:"grow",paddingBottom:20,gap:8,children:[(0,i.BX)(c.tu,{gap:8,children:[(0,i.tZ)(s.xv.H3,{weight:"heavy",children:"Stay signed in"}),(0,i.tZ)(s.xv.B4,{color:"secondary",children:"Download the Substack app for ".concat("ios"===n?"iOS":"android"===n?"Android":"Android or iOS")})]}),"desktop"===n?(0,i.tZ)(v,{abTestingId:t}):(0,i.tZ)(w,{type:n})]}),(0,i.tZ)(c.hs,{alignItems:"end",children:(0,i.tZ)("img",{style:{maxWidth:r},src:(0,u.zF4)("/img/app_page/highlight-6-ios-v2.png",2*r)})})]})})}function v(e){let{abTestingId:t}=e;return(0,i.BX)(c.tu,{gap:16,alignItems:"center",children:[(0,i.tZ)(y,{abTestingId:t}),(0,i.BX)(c.gq,{gap:8,children:[(0,i.tZ)(w,{type:"ios"}),(0,i.tZ)(w,{type:"android"})]})]})}function y(e){let{abTestingId:t}=e;return(0,i.tZ)(c.hs,{border:"detail",radius:"lg",className:m.Z.qrContainer,children:(0,i.tZ)(c.hs,{className:m.Z.qrCode,padding:8,children:(0,i.tZ)(a.AppStoreQrCode,{abTestingId:t,width:160,height:160,utm_campaign:g,utm_content:f,utm_source:h.b3.qr})})})}function w(e){let{type:t}=e;return(0,i.tZ)(c.hs,{style:{minWidth:135},radius:"sm",overflowX:"hidden",overflowY:"hidden",className:m.Z.appDownloadButton,as:"a",href:(0,u.D4e)({utm_campaign:g,utm_content:f,utm_source:h.b3.badge,force:"android"===t?"android":"ios"}),onClick:e=>e.stopPropagation(),children:(0,i.tZ)("img",{className:"app-upsell",src:(0,u.zF4)("android"===t?"/img/app_page/google-play.png":"/img/app_page/app-store.png",320),height:40})})}},52513:function(e,t,n){n.d(t,{E:()=>Z,R:()=>v});var i=n(7409),r=n(16584),o=n(30396),a=n(94184),l=n.n(a),d=n(70871),c=n(95441),s=n(48980),u=n(12900),p=n(71068),h=n(19081),m=n(1844),g=n(58175),f=n(68686);function Z(e){let{email:t,redirect:n,forPub:a,onIsAttemptingLoginChange:l}=e,[c,p]=(0,o.eJ)(""),[h,m]=(0,o.eJ)(!1),[g,f]=(0,o.eJ)(!1),[Z,v]=(0,o.eJ)(!1);(0,o.d4)(()=>{l&&l(h)},[h,l]);let b=async()=>{m(!0);try{let[e]=await Promise.all([(0,s.rd)("/api/v1/email-otp-login/complete",{method:"POST",json:{code:c,email:t,redirect:n,for_pub:a}}),new Promise(e=>setTimeout(e,250))]);window.location.href=e.redirect}catch(e){e instanceof s.kp&&"login_guard_challenge"===e.body.type&&v(!0),m(!1),f(!0),p("")}};return t?(0,r.BX)(C,{children:[(0,r.tZ)(d.uZ,{autoFocus:!0,maxLength:6,pattern:d.Ww,onChange:e=>{p(e),e.length&&f(!1)},onComplete:b,value:c,render:e=>{let{slots:t}=e;return(0,r.tZ)(_,{children:t.map((e,t)=>(0,r.tZ)(y,(0,i._)({disabled:h},e),t))})}}),(0,r.tZ)(u.H,{expanded:!!g,children:(0,r.tZ)(w,{suspiciousLogin:Z})})]}):null}function v(e){let{onComplete:t,error:n,isLoading:a}=e,[l,s]=(0,o.eJ)(""),{iString:u}=(0,c.M1)();return(0,r.BX)(C,{children:[(0,r.tZ)(d.uZ,{autoFocus:!0,maxLength:6,pattern:d.Ww,onChange:e=>{s(e)},onComplete:e=>{a||t(e)},value:l,disabled:a,render:e=>{let{slots:t}=e;return(0,r.tZ)(_,{children:t.map((e,t)=>(0,r.tZ)(y,(0,i._)({disabled:a},e),t))})}}),n&&(0,r.tZ)(m.y,{style:{textAlign:"center"},children:u("You entered an incorrect code. Please try again.")})]})}function y(e){let{char:t,isActive:n,disabled:i}=e;return(0,r.tZ)(h.X2,{justifyContent:"center",alignItems:"center",width:36,height:40,className:l()(f.Z.input,n&&f.Z.focus,i&&f.Z.disabled),children:(0,r.tZ)(g.xv.B2,{textAlign:"center",children:t||""})})}function w(e){let{suspiciousLogin:t}=e,{iString:n}=(0,c.M1)(),i=n(t?"Please check your email for instructions to complete signing in.":"You entered an incorrect code. Please try again.");return(0,r.tZ)(m.y,{style:{textAlign:"center"},children:i})}let C=(0,p.zo)({display:"flex",direction:"column",alignItems:"center",gap:8}),_=(0,p.zo)({display:"flex",direction:"row",justifyContent:"center",alignItems:"center",gap:8})},88326:function(e,t,n){n.d(t,{x:()=>l});var i=n(16584),r=n(61254),o=n(19081),a=n(58175);function l(e){let{title:t,children:n,isFirst:a=!1}=e;return(0,i.BX)(o.tu,{gap:2,children:[!a&&(0,i.tZ)(r.iz,{paddingY:4,pullX:4}),t&&(0,i.tZ)(d,{children:t}),n]})}function d(e){let{children:t}=e;return(0,i.tZ)(a.xv.B5,{color:"secondary",weight:"regular",paddingX:4,paddingTop:4,children:t})}},10704:function(e,t,n){n.d(t,{ex:()=>_,fe:()=>C,u_:()=>w});var i=n(7409),r=n(99282),o=n(16584),a=n(19425),l=n(12048),d=n(94184),c=n.n(d),s=n(50308),u=n.n(s),p=n(98661),h=n(71068),m=n(58076),g=n(19081),f=n(27190),Z=n(88e3),v=n(91400),y=n(40484);let w=e=>{var t;let{isOpen:n,onClose:d=()=>void 0,children:s,position:h="default",testId:g="modal",className:w,fullscreenMobile:C,maxFullscreenMobile:_,overflow:I,width:B=440,disableCloseOnBackdropClick:k=!1,initialFocus:x,renderOverReactLaagPortal:P=!1,style:D}=e,S=(0,v.XA)();return t=n&&S&&C,(0,p.useEffect)(()=>{if(t){if(b.current++,1===b.current){let e=document.getElementById("entry");e&&(e.style.visibility="hidden")}return()=>{if(1===b.current){b.current--;let e=document.getElementById("entry");e&&(e.style.visibility="")}}}},[t]),(0,o.tZ)(a.u,{show:n,as:p.Fragment,children:(0,o.tZ)(l.V,{onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),"data-testid":g,as:"div",className:c()(P&&y.Z.renderOverReactLaagPortal,y.Z.modal),onClose:k?u():d,onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),null==d||d())},initialFocus:x,style:(0,r._)((0,i._)({},D),{zIndex:m.Z7}),children:(0,o.BX)(f.Uv,{children:[(0,o.tZ)(f.sc,{children:(0,o.tZ)(f._n,{})}),(0,o.tZ)(Z.Q,{children:(0,o.tZ)(Z.l,{className:w,position:h,fullscreenMobile:C,maxFullscreenMobile:_,width:B,overflow:I,children:s})})]})})})};function C(e){let{children:t,className:n}=e;return(0,o.tZ)(g.sg,{overflow:"auto",className:c()(y.Z.modalBody,n),padding:20,children:t})}let _=()=>(0,o.tZ)(h.xu,{height:20}),b={current:0}},47295:function(e,t,n){n.d(t,{U:()=>r});var i=n(16584);n(98661);let r=e=>{let{children:t}=e;return(0,i.tZ)("div",{className:"hiddenInput-m9n617",children:t})}},50368:function(e,t,n){n.d(t,{X:()=>o,p:()=>r});var i=n(98661);let r=(0,i.createContext)({useMobileBottomSheet:!0,close:()=>void 0});function o(){return(0,i.useContext)(r)}},4354:function(e,t,n){n.d(t,{I:()=>d,t:()=>l});var i=n(16584),r=n(6400),o=n(30396);let a=(0,r.createContext)(null);function l(e){let{children:t}=e,[n,r]=(0,o.eJ)("email"),[l,d]=(0,o.eJ)(""),[c,s]=(0,o.eJ)(!1),[u,p]=(0,o.eJ)(null);return(0,i.tZ)(a.Provider,{value:{mode:n,email:l,verificationCodeEnabled:c,onboardingRedirect:u,setMode:e=>{"magic-link"!==e&&s(!1),r(e)},setEmail:d,setVerificationCodeEnabled:s,setOnboardingRedirect:p},children:t})}function d(){let e=(0,o.qp)(a);if(!e)throw Error("useSignIn must be used within an SignInProvider");return e}},65942:function(e,t,n){n.d(t,{v:()=>f});var i=n(58865),r=n(16584),o=n(67358),a=n(95441),l=n(8635),d=n(52513),c=n(80026),s=n(6490),u=n(65523),p=n(4354),h=n(41233);function m(){let e=(0,i._)(["We've sent an email to ",". Click the magic link or enter the code below:"]);return m=function(){return e},e}function g(){let e=(0,i._)(["We've sent an email to ",". Click the magic link inside to continue."]);return g=function(){return e},e}let f=e=>{let{noCloseButton:t,noExit:n,onCancel:i,onSuccess:o}=e;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(Z,{noCloseButton:!t||n,onCancel:i}),(0,r.tZ)(v,{onSuccess:o}),(0,r.tZ)(y,{})]})},Z=e=>{let{noCloseButton:t,onCancel:n}=e,{iString:i,iTemplate:l}=(0,a.M1)(),{verificationCodeEnabled:d,email:c}=(0,p.I)();return(0,r.tZ)(u.xB,{title:i("Check your email to continue"),showClose:!t,onClose:n,icon:(0,r.tZ)(u.AM,{icon:(0,r.tZ)(o.Z,{size:20})}),alignItems:"center",description:l(d?m():g(),null!=c?c:"your email address")})};function v(e){let{onSuccess:t}=e,{verificationCodeEnabled:n,email:i,onboardingRedirect:o}=(0,p.I)();return(0,l.Z)(()=>{fetch("/api/v1/am_i_logged_in").then(async e=>{(await e.json()).loggedIn&&t()})},5e3),n?(0,r.tZ)(s.fe,{children:(0,r.tZ)(d.E,{email:i,redirect:o||document.location.href})}):(0,r.tZ)(s.ex,{})}let y=()=>{let{iString:e}=(0,a.M1)(),{setMode:t}=(0,p.I)();return(0,r.tZ)(h.et,{children:(0,r.BX)(r.HY,{children:[e("Didn't get the email? "),(0,r.tZ)(c.hh,{color:"substack",decoration:"hover-underline",onClick:()=>t("email"),cursor:"pointer",children:e("Try again")})]})})}},23276:function(e,t,n){n.d(t,{j:()=>f});var i=n(16584),r=n(95441),o=n(33668),a=n(48980),l=n(7882),d=n(98914),c=n(80026),s=n(1844),u=n(6490),p=n(51776),h=n(4354),m=n(41233),g=n(14942);let f=e=>{let{overrideTitle:t,noCloseButton:n,onCancel:r,onSignup:o,onUserCreated:a,redirectOverride:l}=e;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(m.LZ,{overrideTitle:t,noCloseButton:n,onCancel:r,onSignup:o}),(0,i.tZ)(Z,{onUserCreated:a,redirectOverride:l})]})};function Z(e){let{onUserCreated:t,redirectOverride:n}=e,{iString:m}=(0,r.M1)(),{setMode:f,setEmail:Z,setVerificationCodeEnabled:v,setOnboardingRedirect:y,email:w}=(0,h.I)(),C=(0,o.e)(),_=(0,l.ib)({pathname:"/api/v1/email-login",method:"POST"});return(0,i.BX)("form",{onSubmit:e=>{if(e.preventDefault(),_.isLoading)return;let i=e.currentTarget.email.value;_.refetch({json:{email:i,redirect:n||location.pathname,can_create_user:!0}}).then(e=>{if(!(e instanceof a.kp)){if(!(e instanceof Error)&&"optional"===e.verification_code){v(!0),Z(i),y(e.onboarding_redirect||null),f("magic-link");return}if(!(e instanceof Error)&&e.user){if(t){t(e.user);return}window.location.reload()}Z(i),f("magic-link")}})},children:[(0,i.tZ)(u.fe,{className:g.Z.modalBody,children:(0,i.BX)(c.sg,{gap:16,children:[(0,i.tZ)(p.oi,{type:"email",name:"email",placeholder:m("Your email"),autoComplete:"email",ref:C,autoFocus:!0,defaultValue:w}),_.error&&(0,i.tZ)(s.y,{children:(0,d.zx)(_.error)})]})}),(0,i.tZ)(u.mz,{direction:"column",primaryButton:(0,i.tZ)(c.zx,{priority:"primary",type:"submit",loading:_.isLoading,children:m("Continue")}),secondaryButton:(0,i.tZ)(c.zx,{priority:"secondary-outline",onClick:()=>{var e;Z((null===(e=C.current)||void 0===e?void 0:e.value)||""),f("password")},children:m("Sign in with password")}),buttonDivider:(0,i.tZ)(c.ZC,{})})]})}},9003:function(e,t,n){n.d(t,{n:()=>m});var i=n(16584),r=n(13639),o=n(95441),a=n(48980),l=n(7882),d=n(52513),c=n(80026),s=n(6490),u=n(65523),p=n(4354),h=n(41233);let m=e=>{let{onSuccess:t}=e;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(g,{}),(0,i.tZ)(f,{onSuccess:t}),(0,i.tZ)(Z,{})]})},g=()=>{let{iString:e}=(0,o.M1)();return(0,i.tZ)(u.xB,{title:e("Enter the code from your authenticator app"),description:e("This helps us make sure it's really you."),showClose:!1,icon:(0,i.tZ)(u.AM,{icon:(0,i.tZ)(r.Z,{size:20})}),alignItems:"center"})};function f(e){let{onSuccess:t}=e,n=(0,l.ib)({pathname:"/api/v1/mfa-login",method:"Post"});return(0,i.tZ)(s.fe,{children:(0,i.tZ)(c.sg,{gap:16,children:(0,i.tZ)(d.R,{onComplete:e=>{!n.isLoading&&n.refetch({json:{code:e}}).then(e=>{e instanceof a.kp||t()})},error:n.error,isLoading:n.isLoading})})})}let Z=()=>{let{iString:e}=(0,o.M1)(),{setMode:t}=(0,p.I)();return(0,i.tZ)(h.et,{children:(0,i.BX)(i.HY,{children:[e("Made a mistake? "),(0,i.tZ)(c.hh,{color:"substack",decoration:"hover-underline",onClick:()=>t("email"),cursor:"pointer",children:e("Start over")})]})})}},24142:function(e,t,n){n.d(t,{L:()=>v});var i=n(16584),r=n(30396),o=n(29493),a=n(95441),l=n(33668),d=n(48980),c=n(7882),s=n(98914),u=n(80026),p=n(1844),h=n(6490),m=n(51776),g=n(4354),f=n(41233),Z=n(14942);let v=e=>{let{overrideTitle:t,noCloseButton:n,noExit:r,onCancel:o,onSignup:a,onSuccess:l}=e;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(f.LZ,{overrideTitle:t,noCloseButton:n||r,onCancel:o,onSignup:a}),(0,i.tZ)(y,{onSuccess:l})]})};function y(e){let{onSuccess:t}=e,{iString:n}=(0,a.M1)(),{email:f,setEmail:v,setMode:y}=(0,g.I)(),w=(0,c.ib)({pathname:"/api/v1/login",method:"post"}),C=(0,r.sO)(),_=(0,l.e)(),b=(0,l.e)(),I=async e=>{if(e.preventDefault(),w.isLoading)return;let n=Object.fromEntries(Array.from(e.currentTarget.elements).filter(e=>e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement).map(e=>[e.name,e.value]));C.current&&(n.captcha_response=C.current.getResponse());let i=await w.refetch({json:n});i instanceof Error||(i.mfa_required?y("mfa"):t())};return(0,i.BX)(i.HY,{children:[w.error instanceof d.kp&&401===w.error.response.status&&(0,i.tZ)(o.Z,{ref:C}),(0,i.BX)("form",{onSubmit:I,children:[(0,i.tZ)(h.fe,{className:Z.Z.modalBody,children:(0,i.BX)(u.sg,{gap:8,children:[(0,i.tZ)(m.oi,{type:"email",name:"email",placeholder:n("Your email"),autoComplete:"email",ref:b,defaultValue:f,autoFocus:!0}),(0,i.tZ)(m.oi,{type:"password",name:"password",placeholder:n("Your password"),ref:_}),w.error&&(0,i.tZ)(p.y,{children:(0,s.zx)(w.error)})]})}),(0,i.tZ)(h.mz,{direction:"column",primaryButton:(0,i.tZ)(u.zx,{priority:"primary",type:"submit",loading:w.isLoading,children:n("Continue")}),secondaryButton:(0,i.tZ)(u.zx,{priority:"secondary-outline",onClick:()=>{var e;v((null===(e=b.current)||void 0===e?void 0:e.value)||""),y("email")},children:n("Sign in with email")}),buttonDivider:(0,i.tZ)(u.ZC,{})})]})]})}},26042:function(e,t,n){n.d(t,{Z:()=>function* e(t){if(yield t,t.content)for(let n of t.content)yield*e(n)}})}}]);